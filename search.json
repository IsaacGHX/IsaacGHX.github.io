[{"title":"Temporary Linux Python Working Direction","url":"/2025/07/03/fast_startup/Temporary-Linux-Python-Execution-Direction/","content":"How to Quickly Set Current Directory as Pythonâ€™s Working Directory in LinuxTo enable Python in a Linux environment to directly import modules from the current directory, the most common and recommended approach is to modify the Python module search path. Below are several common methods, along with their pros and cons.\n\n1. Temporarily Modifying the [$PYTHONPATH] Environment Variable (Recommended)This is the most common and flexible method, as it only affects the current session or script execution.\nIn your terminal, navigate to the directory containing your Python modules, then run:\nexport PYTHONPATH=$(pwd)\nExplanation:\n\nexport PYTHONPATH: This Linux command is used to set or modify the PYTHONPATH environment variable. Python checks the paths defined in this variable when searching for modules.\n$(pwd): This is a command substitution; the pwd command outputs the absolute path of the current working directory. $(pwd) uses its output as an argument for the export command.\n\nExample:\nAssume your file structure is like this:\nmy_project/â”œâ”€â”€ main.pyâ””â”€â”€ my_module.py\nmy_module.py content:\ndef hello():    print(&quot;Hello from my_module!&quot;)\nmain.py content:\nimport my_modulemy_module.hello()\n\nEnter the my_project directory:cd my_project\nSet PYTHONPATH:export PYTHONPATH=$(pwd)\nRun main.py:python main.py\nYou should see the output â€œHello from my_module!â€œ\n\nPros:\n\nNon-invasive: Only effective for the current terminal session or script, does not permanently alter system configuration.\nFlexible: Suitable for any scenario requiring temporary path additions.\n\nCons:\n\nNeeds to be set again every time you open a new terminal session.\n\n\n2. Adding Path via [sys.path.append()] in Python ScriptYou can also directly add the current directory to the module search path at the beginning of your Python script.\nimport sysimport os# Add the directory containing the current script to Python&#x27;s search path# os.path.dirname(__file__) gets the directory of the current script# os.path.abspath() gets the absolute pathcurrent_dir = os.path.abspath(os.path.dirname(__file__))if current_dir not in sys.path:    sys.path.append(current_dir)# Now you can import modules from the current directoryimport your_module_name\nPros:\n\nSelf-contained: Handled automatically when the script runs, no external commands needed.\nPortable: The script can run in any environment without additional setup.\n\nCons:\n\nRequires adding this code to every script that needs this functionality.\nIf modules are in subdirectories of the current directory, it requires more complex path handling.\n\n\n3. Using the [-m] Option (for Executable Modules/Packages)If your Python structure is an executable package, you can use the -m option to run a module. This automatically handles module path issues.\nFor example, if your my_project structure looks like this:\nmy_project/â”œâ”€â”€ __init__.pyâ””â”€â”€ my_script.py\nAnd you want to run my_script.py:\npython -m my_project.my_script\nPros:\n\nSuitable for building executable packages.\nPython handles paths automatically.\n\nCons:\n\nRequires your code to be organized as a Python package (i.e., include an __init__.py file).\n\n\nSummaryFor most temporary development and testing scenarios, the first method (export PYTHONPATH=$(pwd)) is the most concise and recommended. It allows you to run Python scripts directly in the current directory and import sibling modules without modifying the script itself.\nIf you need a more robust solution, such as building a large project, itâ€™s typically recommended to use a Python package structure and manage module dependencies and paths via pip install -e . (editable install) or by building a setup.py file.\n","tags":["ENV"]},{"title":"V-PS VLESS-REALITY ä»£ç†éƒ¨ç½²ä¸å®¢æˆ·ç«¯é…ç½®æŒ‡å—","url":"/2025/07/07/fast_startup/V-PS-VLESS-REALITY-%E4%BB%A3%E7%90%86%E9%83%A8%E7%BD%B2%E4%B8%8E%E5%AE%A2%E6%88%B7%E7%AB%AF%E9%85%8D%E7%BD%AE%E6%8C%87%E5%8D%97/","content":"è¿œç¨‹æœåŠ¡å™¨ VLESS-REALITY ä»£ç†éƒ¨ç½²ä¸å®¢æˆ·ç«¯é…ç½®æŒ‡å—æœ¬æ–‡æ¡£å°†æŒ‡å¯¼æ‚¨å®Œæˆä»¥ä¸‹å…¨éƒ¨æµç¨‹ï¼š\n\nåœ¨ AWS Lightsail VPS ä¸Šè¿›è¡ŒåŸºç¡€è®¾ç½®å’Œå®‰å…¨åŠ å›ºã€‚\néƒ¨ç½² Xray-core å¹¶é…ç½® VLESS-REALITY æœåŠ¡ã€‚\nåœ¨æœ¬åœ°ç”Ÿæˆå®¢æˆ·ç«¯æ‰€éœ€çš„ YAML é…ç½®æ–‡ä»¶ã€‚\né€šè¿‡ GitHub Gist å‘å¸ƒé…ç½®æ–‡ä»¶ï¼Œç”Ÿæˆå¯ä¾›è®¢é˜…çš„ HTTP é“¾æ¥ã€‚\næä¾›ä¸€ä¸ªä¸€é”®ç”Ÿæˆæœ¬åœ° YAML æ–‡ä»¶çš„è„šæœ¬ã€‚\n\n\n1. ç®€ä»‹ä¸å‡†å¤‡å·¥ä½œ1.1 VPS æ¨èï¼šAWS Lightsailå¯¹äºéœ€è¦ç¨³å®šã€é«˜è´¨é‡å›½é™…ç½‘ç»œè¿æ¥çš„å­¦æœ¯å’Œç ”ç©¶ç”¨é€”ï¼ŒAWS Lightsail æ˜¯ä¸€ä¸ªä¼˜ç§€çš„é€‰æ‹©ã€‚\nå…³é”®æ­¥éª¤ï¼š\n\nå‰å¾€ AWS Lightsailå®˜ç½‘ åˆ›å»ºä¸€ä¸ªå®ä¾‹ã€‚æ¨èé€‰æ‹©ä½äºä¸œäº¬æˆ–æ–°åŠ å¡ç­‰ä½å»¶è¿Ÿåœ°åŒºçš„å®ä¾‹ã€‚\nåœ¨å®ä¾‹çš„ç®¡ç†é¢æ¿ä¸­ï¼Œè¿›å…¥â€œç½‘ç»œâ€é€‰é¡¹å¡ï¼ŒåŠ¡å¿…åˆ›å»ºä¸€ä¸ªé™æ€ IP åœ°å€å¹¶å°†å…¶é™„åŠ åˆ°æ‚¨çš„å®ä¾‹ã€‚è¿™æ˜¯ç¡®ä¿æ‚¨çš„æœåŠ¡åœ°å€ä¸ä¼šå› é‡å¯è€Œæ”¹å˜çš„å…³é”®ã€‚\n\n1.2 VLESS ä¸ REALITY åè®®ç®€è¿°VLESS æ˜¯ä¸€ä¸ªæ€§èƒ½å“è¶Šã€é…ç½®çµæ´»çš„è½»é‡çº§ä¼ è¾“åè®®ã€‚å®ƒæœ¬èº«ä¸åŒ…å«åŠ å¯†ï¼Œå°†åŠ å¯†çš„è´£ä»»äº¤ç»™äº†åº•å±‚ä¼ è¾“å±‚ï¼ˆå¦‚ TLSï¼‰ï¼Œå®ç°äº†â€œæƒè´£åˆ†ç¦»â€ï¼Œä»è€Œè·å¾—äº†æé«˜çš„æ€§èƒ½å’Œå¯æ‰©å±•æ€§ã€‚\nREALITY (REgular-expression based Application Layer proxy for Inbound TLSY) æ˜¯ä¸€ç§é©å‘½æ€§çš„ TLS ä»£ç†æŠ€æœ¯ã€‚å®ƒé€šè¿‡â€œå€Ÿç”¨â€ä¸€ä¸ªçœŸå®ã€æœ‰æ•ˆçš„ç›®æ ‡ç½‘ç«™çš„ TLS è¯ä¹¦æ¥ä¼ªè£…æµé‡ï¼Œè§£å†³äº†ä¼ ç»Ÿä»£ç†éœ€è¦è´­ä¹°åŸŸåå’Œç”³è¯·è¯ä¹¦çš„ç—›ç‚¹ã€‚å½“æµé‡è¢«å®¡æŸ¥æ—¶ï¼Œå®ƒçœ‹èµ·æ¥å°±åƒæ˜¯ç”¨æˆ·åœ¨ç›´æ¥è®¿é—®ä¸€ä¸ªæ™®é€šçš„ã€çŸ¥åçš„å¤§å‹ç½‘ç«™ï¼ˆä¾‹å¦‚ www.bing.comï¼‰ï¼Œä»è€Œä¸ºå­¦æœ¯æ•°æ®ä¼ è¾“å’Œç½‘ç»œç ”ç©¶æä¾›äº†æä½³çš„éšè”½æ€§å’Œç¨³å®šæ€§ã€‚\n1.3 ä¸ºä»€ä¹ˆä¸æ¨èä½¿ç”¨ Cloudflare ä»£ç†ï¼Ÿå¯¹äº VLESS-REALITY è¿™ç§æ—¨åœ¨æ¨¡ä»¿çœŸå®ç”¨æˆ·ç›´æ¥è®¿é—®ç›®æ ‡ç½‘ç«™çš„åè®®ï¼Œä¸åº”è¯¥å†å¥—ä¸€å±‚ Cloudflare ä»£ç†ã€‚åŸå› å¦‚ä¸‹ï¼š\n\nç‰¹å¾å†²çªï¼šCloudflare çš„ä»£ç†æ˜¯ä¸ºéšè—æœåŠ¡å™¨çœŸå® IPã€æŠ— DDoS ç­‰åœºæ™¯è®¾è®¡çš„ï¼Œå…¶æµé‡ç‰¹å¾ï¼ˆå¦‚ç‰¹å®šçš„ TLS æŒ‡çº¹ã€IPæ®µï¼‰éå¸¸æ˜æ˜¾ã€‚è¿™ä¸ REALITY è¯•å›¾æ¨¡ä»¿ç›´æ¥è¿æ¥çš„åˆè¡·ç›¸æ‚–ã€‚\næ˜¾è‘—å¢åŠ å»¶è¿Ÿï¼šæ‰€æœ‰æµé‡éƒ½éœ€è¦å…ˆç»è¿‡ Cloudflare çš„å…¨çƒç½‘ç»œå†åˆ°è¾¾æ‚¨çš„æœåŠ¡å™¨ï¼Œç›¸å½“äºè¿›è¡Œäº†ä¸€æ¬¡ä¸å¿…è¦çš„ä¸­è½¬ã€‚è¿™ä¼šæ˜¾è‘—å¢åŠ ç½‘ç»œå»¶è¿Ÿï¼ˆé€šå¸¸å¢åŠ  30%-50% æˆ–æ›´é«˜ï¼‰ï¼Œé™ä½è¿æ¥é€Ÿåº¦å’Œå“åº”æ€§ã€‚\nåŠŸèƒ½æ€§é—®é¢˜ï¼š\nè¿‡å¤šé‡å®šå‘ï¼šå¯èƒ½å¯¼è‡´æŸäº›æœåŠ¡ï¼ˆå¦‚ cn.bing.com çš„æœç´¢ï¼‰å¤±è´¥ã€‚\näººæœºéªŒè¯å¤±è´¥ï¼šè®¸å¤šç½‘ç«™ä½¿ç”¨ Cloudflare çš„æœåŠ¡æ¥é˜²å¾¡æœºå™¨äººï¼Œå½“æ‚¨çš„ä»£ç†æµé‡ä¹Ÿé€šè¿‡ Cloudflare æ—¶ï¼Œå¯èƒ½ä¼šè§¦å‘æ›´ä¸¥æ ¼çš„äººæœºéªŒè¯ï¼Œç”šè‡³æ— æ³•é€šè¿‡ã€‚\n\n\n\n\n2. æœåŠ¡å™¨å‡†å¤‡ä¸å®‰å…¨åŠ å›º2.1 æ›´æ–°ç³»ç»Ÿé€šè¿‡ SSH è¿æ¥åˆ°æ‚¨çš„æœåŠ¡å™¨ï¼Œå¹¶æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œç¡®ä¿æ‰€æœ‰è½¯ä»¶åŒ…éƒ½æ˜¯æœ€æ–°çš„ã€‚\nsudo apt update &amp;&amp; sudo apt upgrade -y\n2.2 é˜²ç«å¢™åŠ å›º (UFW)æˆ‘ä»¬å°†é‡‡ç”¨â€œé»˜è®¤æ‹’ç»â€ç­–ç•¥ï¼Œåªæ”¾è¡Œå¿…è¦çš„ç«¯å£ã€‚\n\nè®¾ç½®é»˜è®¤ç­–ç•¥ï¼š\nsudo ufw default deny incomingsudo ufw default allow outgoing\n\nå…è®¸ SSH å’Œ Xray ç«¯å£ï¼š\n\n22 æ˜¯é»˜è®¤ SSH ç«¯å£ï¼Œ443 æ˜¯æˆ‘ä»¬å°†è¦ä½¿ç”¨çš„ Xray æœåŠ¡ç«¯å£ã€‚\né‡è¦ï¼šå¦‚æœæ‚¨è®¡åˆ’ä¿®æ”¹ SSH ç«¯å£ï¼ˆå¼ºçƒˆæ¨èï¼‰ï¼Œè¯·åŠ¡å¿…å…ˆå…è®¸æ–°ç«¯å£ï¼Œå†ç¦ç”¨æ—§ç«¯å£ã€‚ä¾‹å¦‚ï¼Œå°† SSH ç«¯å£æ”¹ä¸º 7777ã€‚\n\n\n# å…è®¸ä½ è‡ªå®šä¹‰çš„SSHç«¯å£sudo ufw allow 7777/tcp# å…è®¸ Xray æœåŠ¡ç«¯å£sudo ufw allow 443/tcp# å¦‚æœæ‚¨ç¡®è®¤æ–°çš„SSHç«¯å£å¯ä»¥ç™»å½•ï¼Œå¯ä»¥ç¦ç”¨é»˜è®¤çš„22ç«¯å£# sudo ufw deny 22/tcp\n\næ³¨æ„ï¼šè¯·åŠ¡å¿…æ£€æŸ¥äº‘æœåŠ¡å•†ï¼ˆå¦‚ AWS Lightsailï¼‰è‡ªå¸¦çš„ç½‘ç»œé˜²ç«å¢™è§„åˆ™ï¼Œç¡®ä¿ä¸Šè¿°ç«¯å£ï¼ˆ7777 å’Œ 443ï¼‰ä¹Ÿå·²å¯¹å…¬ç½‘å¼€æ”¾ã€‚ä¸ºäº†çœå¿ƒï¼Œæ‚¨å¯ä»¥é€‰æ‹©å…è®¸æ‰€æœ‰ TCP/UDP ç«¯å£ï¼ˆ0-65535ï¼‰çš„æµé‡ï¼Œä½†è¿™ä¼šé™ä½å®‰å…¨æ€§ã€‚\n\n\nå¯ç”¨å¹¶æ£€æŸ¥çŠ¶æ€ï¼š\nsudo ufw enablesudo ufw status verbose\nå½“çœ‹åˆ° Status: active å’Œæ‚¨æ·»åŠ çš„è§„åˆ™åˆ—è¡¨æ—¶ï¼Œè¡¨ç¤ºé˜²ç«å¢™å·²æˆåŠŸå¯åŠ¨ã€‚\n\n\n2.3 (å¯é€‰ä½†å¼ºçƒˆæ¨è) SSH å®‰å…¨å¼ºåŒ–\nåˆ›å»ºæ–°ç”¨æˆ·å¹¶æˆäºˆ sudo æƒé™ï¼š\n# å°† your_username æ›¿æ¢ä¸ºæ‚¨æƒ³ç”¨çš„ç”¨æˆ·åadduser your_usernameusermod -aG sudo your_username\n\né…ç½® SSH å¯†é’¥è®¤è¯ï¼š\n\nåœ¨æ‚¨è‡ªå·±çš„ç”µè„‘ä¸Šç”Ÿæˆ SSH å¯†é’¥å¯¹ã€‚\nå°†å…¬é’¥ (~/.ssh/id_rsa.pub çš„å†…å®¹) å¤åˆ¶åˆ°æœåŠ¡å™¨ä¸Šæ–°ç”¨æˆ·çš„ ~/.ssh/authorized_keys æ–‡ä»¶ä¸­ã€‚\nç¡®ä¿æ‚¨èƒ½é€šè¿‡å¯†é’¥å…å¯†ç™»å½•æ–°ç”¨æˆ·åï¼Œå†è¿›è¡Œä¸‹ä¸€æ­¥ã€‚\n\n\nä¿®æ”¹ SSH é…ç½®æ–‡ä»¶ï¼š\nsudo nano /etc/ssh/sshd_config\næ‰¾åˆ°å¹¶ä¿®æ”¹ä»¥ä¸‹å‚æ•°ï¼š\n# å°†ç«¯å£ä» 22 æ”¹ä¸º 1024-65535 ä¹‹é—´çš„ä»»æ„ç«¯å£Port 7777# ç¦æ­¢ root ç”¨æˆ·è¿œç¨‹ç™»å½•PermitRootLogin no# ç¦ç”¨å¯†ç è®¤è¯ï¼Œå¼ºåˆ¶ä½¿ç”¨å¯†é’¥ç™»å½•PasswordAuthentication no\n\næ£€æŸ¥äº‘æœåŠ¡å•†çš„è¦†ç›–é…ç½®ï¼šæ£€æŸ¥ /etc/ssh/sshd_config.d/ ç›®å½•ä¸‹æ˜¯å¦æœ‰äº‘æœåŠ¡å•†çš„é…ç½®æ–‡ä»¶ï¼ˆå¦‚ 50-cloud-init.confï¼‰ã€‚å¦‚æœè¯¥æ–‡ä»¶å¼ºåˆ¶ PasswordAuthentication yesï¼Œè¯·å°†å…¶ä¿®æ”¹ä¸º no æˆ–åˆ é™¤è¯¥æ–‡ä»¶ã€‚\n\né‡å¯ SSH æœåŠ¡ï¼š\nsudo systemctl restart ssh\nç°åœ¨ï¼Œæ‚¨éœ€è¦ä½¿ç”¨æ–°çš„ç«¯å£å’Œå¯†é’¥æ‰èƒ½ç™»å½•æœåŠ¡å™¨ã€‚\n\n\n2.4 ç½‘ç»œæ€§èƒ½ä¼˜åŒ–ï¼šå¯ç”¨ TCP BBRBBR ç®—æ³•èƒ½æ˜¾è‘—æ”¹å–„é•¿è·ç¦»ã€é«˜å»¶è¿Ÿç½‘ç»œä¸‹çš„è¿æ¥é€Ÿåº¦å’Œååé‡ã€‚\n\nä¿®æ”¹ç³»ç»Ÿæ§åˆ¶å‚æ•°ï¼š\nsudo nano /etc/sysctl.conf\nåœ¨æ–‡ä»¶æœ«å°¾æ·»åŠ ä»¥ä¸‹ä¸¤è¡Œï¼š\nnet.core.default_qdisc=fqnet.ipv4.tcp_congestion_control=bbr\n\nåº”ç”¨å¹¶éªŒè¯é…ç½®ï¼š\n# ä½¿é…ç½®ç«‹å³ç”Ÿæ•ˆsudo sysctl -p# éªŒè¯ BBR æ˜¯å¦å·²å¯ç”¨sysctl net.ipv4.tcp_congestion_control\nå¦‚æœè¾“å‡ºç»“æœä¸º net.ipv4.tcp_congestion_control = bbrï¼Œåˆ™è¡¨ç¤ºé…ç½®æˆåŠŸã€‚\n\næ³¨æ„ï¼šä¸€äº›äº‘æœåŠ¡å•†ï¼ˆå¦‚ AWS Lightsailï¼‰é»˜è®¤å°±å…è®¸äº†ï¼Œä¹Ÿæ˜¯å¥½äº‹ã€‚\n\n\n\n\n3. æ ¸å¿ƒæœåŠ¡éƒ¨ç½²ï¼šXray-core3.1 å®‰è£… Xray-coreä½¿ç”¨å®˜æ–¹ä¸€é”®å®‰è£…è„šæœ¬æ¥å®‰è£…æœ€æ–°ç‰ˆæœ¬ã€‚\nbash -c &quot;$(curl -L [https://github.com/XTLS/Xray-install/raw/main/install-release.sh](https://github.com/XTLS/Xray-install/raw/main/install-release.sh))&quot; @ install\n3.2 ç”Ÿæˆå¿…è¦å‡­è¯åœ¨é…ç½®å‰ï¼Œæˆ‘ä»¬éœ€è¦ç”Ÿæˆä¸€ä¸ª UUID å’Œä¸€å¯¹ REALITY å¯†é’¥ã€‚\n\nç”Ÿæˆ UUIDï¼š\n/usr/local/bin/xray uuid\n\nè®°å½•ä¸‹è¿™ä¸²å”¯ä¸€çš„å­—ç¬¦ä¸²ï¼Œä¾‹å¦‚ xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxxã€‚\n\n\nç”Ÿæˆ REALITY å¯†é’¥å¯¹ï¼š\n/usr/local/bin/xray x25519\n\nè¿™ä¼šåŒæ—¶è¾“å‡º ç§é’¥ (PrivateKey) å’Œ å…¬é’¥ (PublicKey)ã€‚è¯·åŠ¡å¿…å¦¥å–„ä¿å­˜è¿™ä¸¤ä¸ªå¯†é’¥ã€‚ç§é’¥ç”¨äºæœåŠ¡å™¨é…ç½®ï¼Œå…¬é’¥ç”¨äºå®¢æˆ·ç«¯é…ç½®ã€‚\n\n\n\n3.3 ç¼–å†™ config.json é…ç½®æ–‡ä»¶ä½¿ç”¨ä»¥ä¸‹å†…å®¹å®Œå…¨æ›¿æ¢ /usr/local/etc/xray/config.json æ–‡ä»¶ã€‚\nsudo nano /usr/local/etc/xray/config.json\nå®Œæ•´é…ç½®ç¤ºä¾‹ (config.json)ï¼š\n&#123;    &quot;log&quot;: &#123;        &quot;loglevel&quot;: &quot;warning&quot;    &#125;,    &quot;routing&quot;: &#123;        &quot;domainStrategy&quot;: &quot;IPIfNonMatch&quot;,        &quot;rules&quot;: [            &#123;                &quot;type&quot;: &quot;field&quot;,                &quot;ip&quot;: [&quot;geoip:private&quot;],                &quot;outboundTag&quot;: &quot;block&quot;            &#125;,            &#123;                &quot;type&quot;: &quot;field&quot;,                &quot;protocol&quot;: [&quot;bittorrent&quot;],                &quot;outboundTag&quot;: &quot;block&quot;            &#125;        ]    &#125;,    &quot;inbounds&quot;: [        &#123;            &quot;port&quot;: 443,            &quot;protocol&quot;: &quot;vless&quot;,            &quot;settings&quot;: &#123;                &quot;clients&quot;: [                    &#123;                        &quot;id&quot;: &quot;your_uuid_here&quot;, // &lt;--- æ›¿æ¢ä¸ºæ‚¨ç”Ÿæˆçš„ UUID                        &quot;level&quot;: 0,                        &quot;flow&quot;: &quot;xtls-rprx-vision&quot;                    &#125;                ],                &quot;decryption&quot;: &quot;none&quot;            &#125;,            &quot;streamSettings&quot;: &#123;                &quot;network&quot;: &quot;tcp&quot;,                &quot;security&quot;: &quot;reality&quot;,                &quot;realitySettings&quot;: &#123;                    &quot;show&quot;: false,                    &quot;dest&quot;: &quot;[www.bing.com:443](https://www.bing.com:443)&quot;, // &lt;--- ä¼ªè£…çš„ç›®æ ‡ç½‘ç«™ï¼Œå¯è‡ªè¡Œæ›´æ¢                    &quot;xver&quot;: 0,                    &quot;serverNames&quot;: [                        &quot;[www.bing.com](https://www.bing.com)&quot;,         // &lt;--- å¿…é¡»ä¸ dest ç½‘ç«™è¯ä¹¦ä¸Šçš„åŸŸååŒ¹é…                        &quot;bing.com&quot;                    ],                    &quot;privateKey&quot;: &quot;your_private_key_here&quot;, // &lt;--- ç²˜è´´æ‚¨ç”Ÿæˆçš„ PrivateKey                    &quot;maxTimeDiff&quot;: 60000,                    &quot;shortIds&quot;: [                        &quot;&quot;,                        &quot;abcdef0123456789&quot; // &lt;--- å¯è‡ªå®šä¹‰çš„ shortIdï¼Œå®¢æˆ·ç«¯éœ€è¦ä½¿ç”¨                    ]                &#125;            &#125;,            &quot;sniffing&quot;: &#123;                &quot;enabled&quot;: true,                &quot;destOverride&quot;: [&quot;http&quot;, &quot;tls&quot;]            &#125;        &#125;    ],    &quot;outbounds&quot;: [        &#123;            &quot;protocol&quot;: &quot;freedom&quot;,            &quot;tag&quot;: &quot;direct&quot;        &#125;,        &#123;            &quot;protocol&quot;: &quot;blackhole&quot;,            &quot;tag&quot;: &quot;block&quot;        &#125;    ]&#125;\né…ç½®è¯´æ˜ï¼š\n\nid: æ›¿æ¢ä¸ºæ‚¨è‡ªå·±ç”Ÿæˆçš„ UUIDã€‚\nprivateKey: æ›¿æ¢ä¸ºæ‚¨è‡ªå·±ç”Ÿæˆçš„ç§é’¥ã€‚\nshortIds: è¿™æ˜¯ä¸€ä¸ª shortId åˆ—è¡¨ï¼Œå®¢æˆ·ç«¯å¯ä»¥ä»»é€‰å…¶ä¸€ä½¿ç”¨ã€‚ä½ å¯ä»¥è‡ªå®šä¹‰ä¸€ä¸ªï¼Œæ¯”å¦‚ abcdef0123456789ã€‚\ndest å’Œ serverNames: è¿™æ˜¯ REALITY çš„æ ¸å¿ƒã€‚dest å¿…é¡»æ˜¯ä¸€ä¸ªå¢™å¤–ã€æ”¯æŒ TLS 1.3 çš„ç¨³å®šå¤§ç½‘ç«™ã€‚serverNames å¿…é¡»åŒ…å« dest ç½‘ç«™è¯ä¹¦ä¸Šçš„åŸŸåã€‚www.bing.com æ˜¯ä¸€ä¸ªä¸é”™çš„é€‰æ‹©ã€‚\n\n3.4 æœåŠ¡ç®¡ç† (systemd)\næµ‹è¯•é…ç½®ï¼š\n/usr/local/bin/xray run -test -config /usr/local/etc/xray/config.json\n\nå¦‚æœæ˜¾ç¤º Configuration OKï¼Œåˆ™è¡¨ç¤ºé…ç½®æ— è¯¯ã€‚\n\n\nå¯åŠ¨å¹¶è®¾ç½®å¼€æœºè‡ªå¯ï¼š\nsudo systemctl restart xraysudo systemctl enable xray\n\næ£€æŸ¥æœåŠ¡çŠ¶æ€ï¼š\nsudo systemctl status xray\n\nç¡®ä¿æœåŠ¡çŠ¶æ€æ˜¯ active (running)ã€‚\n\n\nå®æ—¶æŸ¥çœ‹æ—¥å¿—ï¼ˆç”¨äºæ’é”™ï¼‰ï¼š\nsudo journalctl -u xray -f\n\n\n\n4. å®¢æˆ·ç«¯é…ç½®4.1 ç”Ÿæˆ YAML ä»£ç†ç‰‡æ®µæ‚¨éœ€è¦æ ¹æ®æœåŠ¡å™¨ä¸Šçš„é…ç½®ï¼Œå¡«å†™ä»¥ä¸‹å®¢æˆ·ç«¯ YAML ç‰‡æ®µã€‚\nproxies:- name: Catpaw-Tokyo-Reality # &lt;--- èŠ‚ç‚¹åç§°ï¼Œå¯è‡ªå®šä¹‰  type: vless  server: your_server_ip_here        # &lt;--- æ›¿æ¢ä¸ºæ‚¨çš„æœåŠ¡å™¨é™æ€IPåœ°å€  port: 443  uuid: your_uuid_here              # &lt;--- æ›¿æ¢ä¸ºæ‚¨çš„ UUID  network: tcp  tls: true  udp: true  flow: xtls-rprx-vision  servername: [www.bing.com](https://www.bing.com)          # &lt;--- å¿…é¡»ä¸æœåŠ¡å™¨ config.json ä¸­çš„ serverNames ä¹‹ä¸€å®Œå…¨åŒ¹é…  reality-opts:    public-key: your_public_key_here  # &lt;--- æ›¿æ¢ä¸ºæ‚¨ç”Ÿæˆçš„ PublicKey    short-id: abcdef0123456789        # &lt;--- æ›¿æ¢ä¸ºæ‚¨åœ¨æœåŠ¡å™¨ä¸Šè®¾ç½®çš„ shortId  client-fingerprint: chrome\n4.2 ä½¿ç”¨ GitHub Gist å‘å¸ƒè®¢é˜…æ–‡ä»¶\nç™»å½• GitHub å¹¶è®¿é—® gist.github.comã€‚\nåœ¨æ–‡ä»¶åå¤„è¾“å…¥ my_subscription.yamlã€‚\nå°†ä¸€ä»½å®Œæ•´çš„ Clash YAML é…ç½®ï¼ˆä¾‹å¦‚æ–‡æœ«è„šæœ¬ç”Ÿæˆçš„å†…å®¹ï¼‰ç²˜è´´åˆ°ä»£ç æ¡†ä¸­ã€‚\nç‚¹å‡»å³ä¸‹è§’çš„ Create secret gistã€‚è¿™ä¼šåˆ›å»ºä¸€ä¸ªæ— æ³•è¢«æœç´¢åˆ°çš„ç§å¯† Gistã€‚\nåˆ›å»ºæˆåŠŸåï¼Œç‚¹å‡»é¡µé¢å³ä¸Šè§’çš„ Raw æŒ‰é’®ã€‚æµè§ˆå™¨åœ°å€æ ä¸­çš„ URL å°±æ˜¯å¯ä»¥ç›´æ¥ç”¨äº Clash å®¢æˆ·ç«¯çš„è®¢é˜…é“¾æ¥ã€‚\n\n\n5. ä¸€é”®ç”Ÿæˆå®Œæ•´ YAML é…ç½®æ–‡ä»¶è„šæœ¬è¿™ä¸ª shell è„šæœ¬ä¼šæç¤ºæ‚¨è¾“å…¥å¿…è¦ä¿¡æ¯ï¼Œç„¶åè‡ªåŠ¨åœ¨å½“å‰ç›®å½•ä¸‹ç”Ÿæˆä¸€ä¸ªåä¸º config.yaml çš„å®Œæ•´ Clash é…ç½®æ–‡ä»¶ã€‚\næ‚¨å¯ä»¥å°†ä»¥ä¸‹ä»£ç ä¿å­˜ä¸ºä¸€ä¸ªåä¸º create_clash_config.sh çš„æ–‡ä»¶ã€‚\n#!/bin/bash# ANSI Color CodesRED=&#x27;\\033[0;31m&#x27;GREEN=&#x27;\\033[0;32m&#x27;YELLOW=&#x27;\\033[1;33m&#x27;NC=&#x27;\\033[0m&#x27; # No Colorecho -e &quot;$&#123;GREEN&#125;--- Clash VLESS-REALITY YAML åŠ¨æ€é…ç½®ç”Ÿæˆè„šæœ¬ ---$&#123;NC&#125;&quot;echo &quot;æœ¬è„šæœ¬å°†å¼•å¯¼æ‚¨ç”Ÿæˆä¸€ä»½å®Œæ•´çš„ Clash é…ç½®æ–‡ä»¶ã€‚&quot;echo &quot;&quot;# --- è·å–ç”¨æˆ·è¾“å…¥ ---read -p &quot;$(echo -e $&#123;YELLOW&#125;&#x27;[1/6] è¯·ä¸ºæ‚¨çš„ä»£ç†èŠ‚ç‚¹å‘½å (ä¾‹å¦‚: AWS-Tokyo-01): &#x27;$&#123;NC&#125;)&quot; PROXY_NAMEread -p &quot;$(echo -e $&#123;YELLOW&#125;&#x27;[2/6] è¯·è¾“å…¥æ‚¨çš„æœåŠ¡å™¨ IP åœ°å€: &#x27;$&#123;NC&#125;)&quot; SERVER_IPread -p &quot;$(echo -e $&#123;YELLOW&#125;&#x27;[3/6] è¯·è¾“å…¥æ‚¨åœ¨æœåŠ¡å™¨config.jsonä¸­è®¾ç½®çš„ servername (ä¾‹å¦‚: www.bing.com): &#x27;$&#123;NC&#125;)&quot; SERVER_NAMEread -p &quot;$(echo -e $&#123;YELLOW&#125;&#x27;[4/6] è¯·è¾“å…¥æ‚¨çš„ UUID: &#x27;$&#123;NC&#125;)&quot; UUIDread -p &quot;$(echo -e $&#123;YELLOW&#125;&#x27;[5/6] è¯·è¾“å…¥æ‚¨çš„ REALITY PublicKey: &#x27;$&#123;NC&#125;)&quot; PUBLIC_KEYread -p &quot;$(echo -e $&#123;YELLOW&#125;&#x27;[6/6] è¯·è¾“å…¥æ‚¨åœ¨æœåŠ¡å™¨ä¸Šè®¾ç½®çš„ short-id: &#x27;$&#123;NC&#125;)&quot; SHORT_ID# --- æ£€æŸ¥è¾“å…¥ ---if [[ -z &quot;$PROXY_NAME&quot; || -z &quot;$SERVER_IP&quot; || -z &quot;$SERVER_NAME&quot; || -z &quot;$UUID&quot; || -z &quot;$PUBLIC_KEY&quot; || -z &quot;$SHORT_ID&quot; ]]; then    echo -e &quot;\\n$&#123;RED&#125;é”™è¯¯ï¼šæ‰€æœ‰å­—æ®µå‡ä¸ºå¿…å¡«é¡¹ã€‚è„šæœ¬å·²ä¸­æ­¢ï¼Œè¯·é‡æ–°è¿è¡Œã€‚$&#123;NC&#125;&quot;    exit 1fi# --- å®šä¹‰é…ç½®æ–‡ä»¶å ---CONFIG_FILE=&quot;config.yaml&quot;# --- ä½¿ç”¨ cat å’Œ EOF åˆ›å»º YAML æ–‡ä»¶ ---# ä½¿ç”¨ç”¨æˆ·è¾“å…¥çš„å˜é‡æ¥å¡«å……æ¨¡æ¿cat &lt;&lt;EOF &gt; $&#123;CONFIG_FILE&#125;mixed-port: 7890mode: ruleipv6: falsegeodata-mode: truegeox-url:  geoip: https://fastly.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@release/geoip.dat  geosite: https://fastly.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@release/geosite.dat  mmdb: https://fastly.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@release/geoip.metadbgeo-auto-update: falsegeo-update-interval: 24log-level: infoglobal-client-fingerprint: chrometcp-concurrent: truefind-process-mode: strictunified-delay: trueprofile:  store-selected: true  store-fake-ip: truetun:  enable: false  stack: mixed  auto-route: true  auto-detect-interface: true  dns-hijack:  - any:53  - tcp://any:53sniffer:  enable: true  force-dns-mapping: true  parse-pure-ip: true  override-destination: true  sniff:    QUIC:      ports:      - 443      - 8443    TLS:      ports:      - 443      - 8443    HTTP:      ports:      - 80      - 8080-8880  force-domain:  - +.v2ex.com  skip-domain:  - Mijia Clouddns:  enable: true  respect-rules: false  listen: 0.0.0.0:1053  ipv6: false  default-nameserver:  - 223.5.5.5  - 119.29.29.29  enhanced-mode: fake-ip  fake-ip-range: 198.18.0.1/16  fake-ip-filter-mode: blacklist  fake-ip-filter:  - &#x27;*&#x27;  - +.lan  - +.local  - +.stun.*.*  - +.stun.*.*.*  - +.stun.*.*.*.*  - +.stun.*.*.*.*.*  nameserver:  - 223.5.5.5  - 119.29.29.29  fallback:  - tls://8.8.4.4  - tls://1.1.1.1  proxy-server-nameserver:  - https://223.5.5.5/dns-query  - https://1.12.12.12/dns-query  direct-nameserver:  - system  direct-nameserver-follow-policy: false  fallback-filter:    geoip: true    geoip-code: CN    nameserver-policy:      gfw    ipcidr:    - 240.0.0.0/4    domain:    - +.google.com    - +.facebook.com    - +.youtube.comproxies:- name: $&#123;PROXY_NAME&#125;  type: vless  server: $&#123;SERVER_IP&#125;  port: 443  uuid: $&#123;UUID&#125;  network: tcp  tls: true  udp: true  flow: xtls-rprx-vision  servername: $&#123;SERVER_NAME&#125;  reality-opts:    public-key: $&#123;PUBLIC_KEY&#125;    short-id: $&#123;SHORT_ID&#125;  client-fingerprint: chromeproxy-groups:- name: Proxy  type: select  proxies:  - $&#123;PROXY_NAME&#125;- name: AdBlock  type: select  proxies:  - REJECT  - DIRECTrule-providers:  reject:    type: http    behavior: domain    url: https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/reject.txt    path: ./ruleset/reject.yaml    interval: 86400  proxy:    type: http    behavior: domain    url: https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/proxy.txt    path: ./ruleset/proxy.yaml    interval: 86400  gfw:    type: http    behavior: domain    url: https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/gfw.txt    path: ./ruleset/gfw.yaml    interval: 86400  steamCN:    type: http    behavior: classical    url: https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/SteamCN/SteamCN.yaml    path: ./ruleset/steamCN.yaml    interval: 86400  GameDownload:    type: http    behavior: classical    url: https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Game/GameDownload/GameDownload.yaml    path: ./ruleset/GameDownload.yaml    interval: 86400  Bing:    type: http    behavior: classical    url: https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Bing/Bing.yaml    path: ./ruleset/Bing.yaml    interval: 86400rules:- IP-CIDR,10.10.9.9/32,DIRECT- DOMAIN-SUFFIX,playerinfinite.com,Proxy- DOMAIN-SUFFIX,levelinfinite.com,Proxy- DOMAIN-SUFFIX,nodeseek.com,Proxy- RULE-SET,GameDownload,DIRECT- RULE-SET,steamCN,DIRECT- RULE-SET,reject,AdBlock- GEOSITE,category-ads,AdBlock- RULE-SET,gfw,Proxy- GEOSITE,cn,DIRECT- GEOIP,cn,DIRECT- MATCH,ProxyEOFecho &quot;&quot;echo -e &quot;$&#123;GREEN&#125;æˆåŠŸï¼é…ç½®æ–‡ä»¶ &#x27;$&#123;CONFIG_FILE&#125;&#x27; å·²åœ¨å½“å‰ç›®å½•ç”Ÿæˆã€‚$&#123;NC&#125;&quot;echo &quot;å®ƒç°åœ¨åŒ…å«æ‚¨è‡ªå®šä¹‰çš„èŠ‚ç‚¹åç§°å’ŒæœåŠ¡å™¨ä¿¡æ¯ã€‚&quot;echo &quot;æ‚¨å¯ä»¥ç›´æ¥åœ¨ Clash å®¢æˆ·ç«¯ä¸­å¯¼å…¥æ­¤æ–‡ä»¶ã€‚&quot;\nå¦‚ä½•ä½¿ç”¨æ­¤è„šæœ¬ï¼š\n\nå°†ä¸Šé¢çš„ä»£ç å¤åˆ¶å¹¶ç²˜è´´åˆ°ä¸€ä¸ªæ–°æ–‡ä»¶ä¸­ï¼Œä¾‹å¦‚ create_clash_config.shã€‚\nåœ¨æ‚¨çš„ç»ˆç«¯ä¸­ï¼Œç»™è¿™ä¸ªæ–‡ä»¶æ·»åŠ å¯æ‰§è¡Œæƒé™ï¼šchmod +x create_clash_config.shã€‚\nè¿è¡Œè„šæœ¬ï¼š./create_clash_config.shã€‚\næŒ‰ç…§æç¤ºè¾“å…¥æ‚¨çš„æœåŠ¡å™¨IPã€UUIDã€PublicKey å’Œ short-idã€‚\nè„šæœ¬æ‰§è¡Œå®Œæ¯•åï¼Œä¸€ä¸ªåä¸º config.yaml çš„æ–‡ä»¶å°±ä¼šå‡ºç°åœ¨å½“å‰ç›®å½•ä¸‹ï¼Œæ‚¨å¯ä»¥ç›´æ¥ä½¿ç”¨äº†ã€‚\n\n\næ‡’äººåŒ…ä»ä¸€ä¸ªæ–°åˆ›å»ºçš„ã€æ‹¥æœ‰ sudo æƒé™çš„ç”¨æˆ·å¼€å§‹ï¼Œä¸€é”®å®ŒæˆæœåŠ¡å™¨ç¯å¢ƒé…ç½®ã€Xray å®‰è£…ä¸é…ç½®ï¼Œç›´åˆ°æœ€åå¯åŠ¨å¹¶éªŒè¯æœåŠ¡ã€‚\nä½¿ç”¨æ–¹æ³•\nä»¥æ‚¨æ–°åˆ›å»ºçš„ã€æ‹¥æœ‰ sudo æƒé™çš„ç”¨æˆ·èº«ä»½ç™»å½•åˆ°æ‚¨çš„æœåŠ¡å™¨ã€‚\nå°†ä¸‹é¢çš„ä»£ç å®Œæ•´å¤åˆ¶ï¼Œå¹¶ç²˜è´´åˆ°ä¸€ä¸ªæ–°æ–‡ä»¶ä¸­ã€‚ä¾‹å¦‚ï¼Œå‘½åä¸º setup_xray.shã€‚nano setup_xray.sh# ç²˜è´´ä»£ç ï¼Œç„¶åæŒ‰ Ctrl+X, Y, Enter ä¿å­˜é€€å‡º\nç»™è¯¥è„šæœ¬æ–‡ä»¶æ·»åŠ å¯æ‰§è¡Œæƒé™ï¼šchmod +x setup_xray.sh\nè¿è¡Œè„šæœ¬ï¼š./setup_xray.sh\næ ¹æ®è„šæœ¬çš„æç¤ºï¼Œè¾“å…¥æ‰€éœ€ä¿¡æ¯å¹¶æŒ‰å›è½¦é”®ç»§ç»­ã€‚\n\n\nä¸€é”®éƒ¨ç½²è„šæœ¬ (setup_xray.sh)#!/bin/bash# ==============================================================================#  Xray VLESS-REALITY ä¸€é”®éƒ¨ç½²è„šæœ¬ (é€‚ç”¨äº Debian/Ubuntu)##  æœ¬è„šæœ¬å°†æ‰§è¡Œä»¥ä¸‹æ“ä½œ:#  1. æ›´æ–°ç³»ç»Ÿè½¯ä»¶åŒ…#  2. é…ç½® UFW é˜²ç«å¢™#  3. å¯ç”¨ TCP BBR ç½‘ç»œä¼˜åŒ–#  4. å®‰è£…æœ€æ–°çš„ Xray-core#  5. è‡ªåŠ¨ç”Ÿæˆ REALITY å‡­è¯å¹¶åˆ›å»ºé…ç½®æ–‡ä»¶#  6. å¯åŠ¨å¹¶è®¾ç½® Xray å¼€æœºè‡ªå¯# ==============================================================================# --- å…¨å±€å˜é‡å’Œå‡½æ•° ---# é¢œè‰²å®šä¹‰RED=&#x27;\\033[0;31m&#x27;GREEN=&#x27;\\033[0;32m&#x27;YELLOW=&#x27;\\033[1;33m&#x27;NC=&#x27;\\033[0m&#x27; # No Color# ä½¿è„šæœ¬åœ¨é‡åˆ°é”™è¯¯æ—¶é€€å‡ºset -eset -o pipefail# æ‰“å°å½©è‰²æ¶ˆæ¯print_color() &#123;    COLOR=$1    MESSAGE=$2    echo -e &quot;$&#123;COLOR&#125;$&#123;MESSAGE&#125;$&#123;NC&#125;&quot;&#125;# æš‚åœå¹¶ç­‰å¾…ç”¨æˆ·æŒ‰é”®press_any_key() &#123;    echo &quot;&quot;    print_color &quot;$YELLOW&quot; &quot;è¯·æŒ‰ä»»æ„é”®ç»§ç»­...&quot;    read -n 1 -s -r    echo &quot;&quot;&#125;# æ£€æŸ¥æ˜¯å¦ä»¥ root èº«ä»½è¿è¡Œif [[ $(id -u) -eq 0 ]]; then    print_color &quot;$RED&quot; &quot;é”™è¯¯ï¼šè¯·ä¸è¦ä»¥ root ç”¨æˆ·èº«ä»½è¿è¡Œæ­¤è„šæœ¬ã€‚è¯·ä½¿ç”¨å…·æœ‰ sudo æƒé™çš„æ™®é€šç”¨æˆ·æ‰§è¡Œã€‚&quot;    exit 1fi# --- è„šæœ¬ä¸»æµç¨‹ ---clearprint_color &quot;$GREEN&quot; &quot;=======================================================&quot;print_color &quot;$GREEN&quot; &quot;      Xray VLESS-REALITY æœåŠ¡å™¨ç«¯ä¸€é”®éƒ¨ç½²è„šæœ¬&quot;print_color &quot;$GREEN&quot; &quot;=======================================================&quot;echo &quot;&quot;print_color &quot;$YELLOW&quot; &quot;æœ¬è„šæœ¬å°†å¼•å¯¼æ‚¨å®Œæˆæ‰€æœ‰å¿…è¦çš„æœåŠ¡å™¨é…ç½®ã€‚&quot;press_any_key# --- æ­¥éª¤ 1: ç³»ç»Ÿæ›´æ–° ---print_color &quot;$GREEN&quot; &quot;[1/5] æ­£åœ¨æ›´æ–°ç³»ç»Ÿè½¯ä»¶åŒ…...&quot;sudo apt update &amp;&amp; sudo apt upgrade -yprint_color &quot;$GREEN&quot; &quot;âœ… ç³»ç»Ÿæ›´æ–°å®Œæˆã€‚&quot;press_any_key# --- æ­¥éª¤ 2: é…ç½®é˜²ç«å¢™ (UFW) ---print_color &quot;$GREEN&quot; &quot;[2/5] æ­£åœ¨é…ç½® UFW é˜²ç«å¢™...&quot;read -p &quot;$(echo -e $&#123;YELLOW&#125;&#x27;è¯·è¾“å…¥æ‚¨å½“å‰ä½¿ç”¨çš„ SSH ç«¯å£ (é»˜è®¤ä¸º 22): &#x27;$&#123;NC&#125;)&quot; SSH_PORTSSH_PORT=$&#123;SSH_PORT:-22&#125;sudo ufw default deny incoming &gt;/dev/nullsudo ufw default allow outgoing &gt;/dev/nullsudo ufw allow $&#123;SSH_PORT&#125;/tcpsudo ufw allow 443/tcpsudo ufw --force enableprint_color &quot;$GREEN&quot; &quot;âœ… é˜²ç«å¢™å·²å¯ç”¨å¹¶é…ç½®å®Œæˆã€‚å½“å‰è§„åˆ™:&quot;sudo ufw status verbosepress_any_key# --- æ­¥éª¤ 3: å¯ç”¨ TCP BBR ---print_color &quot;$GREEN&quot; &quot;[3/5] æ­£åœ¨å¯ç”¨ TCP BBR ç½‘ç»œä¼˜åŒ–...&quot;&#123;    echo &quot;net.core.default_qdisc=fq&quot;    echo &quot;net.ipv4.tcp_congestion_control=bbr&quot;&#125; | sudo tee /etc/sysctl.d/99-bbr.conf &gt;/dev/nullsudo sysctl -p /etc/sysctl.d/99-bbr.conf &gt;/dev/nullif sysctl net.ipv4.tcp_congestion_control | grep -q &quot;bbr&quot;; then    print_color &quot;$GREEN&quot; &quot;âœ… TCP BBR å·²æˆåŠŸå¯ç”¨ã€‚&quot;else    print_color &quot;$RED&quot; &quot;âŒ TCP BBR å¯ç”¨å¤±è´¥ï¼Œè¯·æ£€æŸ¥å†…æ ¸ç‰ˆæœ¬ï¼ˆéœ€ &gt;= 4.9ï¼‰ã€‚&quot;fipress_any_key# --- æ­¥éª¤ 4: å®‰è£… Xray-core ---print_color &quot;$GREEN&quot; &quot;[4/5] æ­£åœ¨å®‰è£…æœ€æ–°çš„ Xray-core...&quot;sudo bash -c &quot;$(curl -L https://github.com/XTLS/Xray-install/raw/main/install-release.sh)&quot; @ install &gt;/dev/null 2&gt;&amp;1if [ -f &quot;/usr/local/bin/xray&quot; ]; then    print_color &quot;$GREEN&quot; &quot;âœ… Xray-core å®‰è£…æˆåŠŸã€‚&quot;else    print_color &quot;$RED&quot; &quot;âŒ Xray-core å®‰è£…å¤±è´¥ã€‚&quot;    exit 1fipress_any_key# --- æ­¥éª¤ 5: ç”Ÿæˆé…ç½®å¹¶å¯åŠ¨æœåŠ¡ ---print_color &quot;$GREEN&quot; &quot;[5/5] æ­£åœ¨ç”Ÿæˆ Xray é…ç½®æ–‡ä»¶å¹¶å¯åŠ¨æœåŠ¡...&quot;# äº¤äº’å¼è·å–ä¼ªè£…åŸŸåprint_color &quot;$YELLOW&quot; &quot;REALITY éœ€è¦ä¸€ä¸ªçœŸå®å­˜åœ¨çš„ã€æ”¯æŒ TLS 1.3 çš„ç›®æ ‡ç½‘ç«™è¿›è¡Œä¼ªè£…ã€‚&quot;read -p &quot;$(echo -e $&#123;YELLOW&#125;&#x27;è¯·è¾“å…¥ä¼ªè£…åŸŸå (é»˜è®¤ä¸º www.bing.com): &#x27;$&#123;NC&#125;)&quot; FAKE_DEST_DOMAINFAKE_DEST_DOMAIN=$&#123;FAKE_DEST_DOMAIN:-&quot;www.bing.com&quot;&#125;# è‡ªåŠ¨å¤„ç† www å‰ç¼€ï¼Œç”Ÿæˆ serverNames åˆ—è¡¨if [[ $FAKE_DEST_DOMAIN == www.* ]]; then    SERVER_NAMES=&quot;\\&quot;$&#123;FAKE_DEST_DOMAIN&#125;\\&quot;, \\&quot;$(echo $&#123;FAKE_DEST_DOMAIN&#125; | sed &#x27;s/www.//&#x27;)\\&quot;&quot;else    SERVER_NAMES=&quot;\\&quot;$&#123;FAKE_DEST_DOMAIN&#125;\\&quot;&quot;fi# ç”Ÿæˆå‡­è¯print_color &quot;$YELLOW&quot; &quot;æ­£åœ¨ç”Ÿæˆ UUID å’Œ REALITY å¯†é’¥å¯¹...&quot;USER_UUID=$(/usr/local/bin/xray uuid)KEY_PAIR_OUTPUT=$(/usr/local/bin/xray x25519)PRIVATE_KEY=$(echo &quot;$KEY_PAIR_OUTPUT&quot; | grep &quot;Private key&quot; | awk &#x27;&#123;print $3&#125;&#x27;)PUBLIC_KEY=$(echo &quot;$KEY_PAIR_OUTPUT&quot; | grep &quot;Public key&quot; | awk &#x27;&#123;print $3&#125;&#x27;)SHORT_ID=$(head /dev/urandom | tr -dc &#x27;a-f0-9&#x27; | head -c 16)# åˆ›å»º config.json æ–‡ä»¶CONFIG_JSON_CONTENT=$(cat &lt;&lt;EOF&#123;    &quot;log&quot;: &#123;        &quot;loglevel&quot;: &quot;warning&quot;    &#125;,    &quot;routing&quot;: &#123;        &quot;domainStrategy&quot;: &quot;IPIfNonMatch&quot;,        &quot;rules&quot;: [            &#123; &quot;type&quot;: &quot;field&quot;, &quot;ip&quot;: [&quot;geoip:private&quot;], &quot;outboundTag&quot;: &quot;block&quot; &#125;,            &#123; &quot;type&quot;: &quot;field&quot;, &quot;protocol&quot;: [&quot;bittorrent&quot;], &quot;outboundTag&quot;: &quot;block&quot; &#125;        ]    &#125;,    &quot;inbounds&quot;: [        &#123;            &quot;port&quot;: 443,            &quot;protocol&quot;: &quot;vless&quot;,            &quot;settings&quot;: &#123;                &quot;clients&quot;: [                    &#123;                        &quot;id&quot;: &quot;$&#123;USER_UUID&#125;&quot;,                        &quot;level&quot;: 0,                        &quot;flow&quot;: &quot;xtls-rprx-vision&quot;                    &#125;                ],                &quot;decryption&quot;: &quot;none&quot;            &#125;,            &quot;streamSettings&quot;: &#123;                &quot;network&quot;: &quot;tcp&quot;,                &quot;security&quot;: &quot;reality&quot;,                &quot;realitySettings&quot;: &#123;                    &quot;show&quot;: false,                    &quot;dest&quot;: &quot;$&#123;FAKE_DEST_DOMAIN&#125;:443&quot;,                    &quot;xver&quot;: 0,                    &quot;serverNames&quot;: [$&#123;SERVER_NAMES&#125;],                    &quot;privateKey&quot;: &quot;$&#123;PRIVATE_KEY&#125;&quot;,                    &quot;shortIds&quot;: [&quot;$&#123;SHORT_ID&#125;&quot;]                &#125;            &#125;,            &quot;sniffing&quot;: &#123; &quot;enabled&quot;: true, &quot;destOverride&quot;: [&quot;http&quot;, &quot;tls&quot;] &#125;        &#125;    ],    &quot;outbounds&quot;: [        &#123; &quot;protocol&quot;: &quot;freedom&quot;, &quot;tag&quot;: &quot;direct&quot; &#125;,        &#123; &quot;protocol&quot;: &quot;blackhole&quot;, &quot;tag&quot;: &quot;block&quot; &#125;    ]&#125;EOF)echo &quot;$&#123;CONFIG_JSON_CONTENT&#125;&quot; | sudo tee /usr/local/etc/xray/config.json &gt;/dev/null# æµ‹è¯•ã€é‡å¯å¹¶è®¾ç½®å¼€æœºè‡ªå¯print_color &quot;$YELLOW&quot; &quot;æ­£åœ¨éªŒè¯é…ç½®å¹¶å¯åŠ¨ Xray...&quot;if sudo /usr/local/bin/xray run -test -config /usr/local/etc/xray/config.json; then    sudo systemctl restart xray    sudo systemctl enable xray    print_color &quot;$GREEN&quot; &quot;âœ… Xray å¯åŠ¨æˆåŠŸï¼&quot;    sleep 2    sudo systemctl status xray --no-pager -lelse    print_color &quot;$RED&quot; &quot;âŒ Xray é…ç½®æ–‡ä»¶æ— æ•ˆï¼è¯·æ£€æŸ¥ /usr/local/etc/xray/config.json&quot;    exit 1fi# --- æœ€ç»ˆä¿¡æ¯æ±‡æ€» ---echo &quot;&quot;print_color &quot;$GREEN&quot; &quot;=======================================================================&quot;print_color &quot;$GREEN&quot; &quot;            ğŸ‰ æ­å–œï¼æœåŠ¡å™¨ç«¯éƒ¨ç½²å·²å…¨éƒ¨å®Œæˆï¼ ğŸ‰&quot;print_color &quot;$GREEN&quot; &quot;=======================================================================&quot;echo &quot;&quot;print_color &quot;$YELLOW&quot; &quot;è¯·å¦¥å–„ä¿ç®¡ä»¥ä¸‹å®¢æˆ·ç«¯è¿æ¥å‚æ•°:&quot;echo &quot;-----------------------------------------------------------------------&quot;echo -e &quot;  æœåŠ¡å™¨åœ°å€ (IP):  $(curl -s ip.sb)&quot;echo -e &quot;  ç«¯å£ (Port):      443&quot;echo -e &quot;  UUID:             $&#123;GREEN&#125;$&#123;USER_UUID&#125;$&#123;NC&#125;&quot;echo -e &quot;  æµæ§ (Flow):      xtls-rprx-vision&quot;echo -e &quot;  åŠ å¯† (Security):  reality&quot;echo -e &quot;  åŸŸå (ServerName):  $&#123;GREEN&#125;$&#123;FAKE_DEST_DOMAIN&#125;$&#123;NC&#125;&quot;echo -e &quot;  å…¬é’¥ (PublicKey):   $&#123;GREEN&#125;$&#123;PUBLIC_KEY&#125;$&#123;NC&#125;&quot;echo -e &quot;  çŸ­ID (ShortId):     $&#123;GREEN&#125;$&#123;SHORT_ID&#125;$&#123;NC&#125;&quot;echo -e &quot;  æŒ‡çº¹ (Fingerprint): chrome&quot;echo &quot;-----------------------------------------------------------------------&quot;echo &quot;&quot;print_color &quot;$YELLOW&quot; &quot;æ‚¨ç°åœ¨å¯ä»¥ä½¿ç”¨ä»¥ä¸Šå‚æ•°é…ç½®æ‚¨çš„å®¢æˆ·ç«¯äº†ã€‚&quot;echo &quot;&quot;\n","tags":["Network","VPS"]},{"title":"åæ§½ä¸€ä¸‹æ¦‚ç‡è®ºçš„å®šä¹‰ç¬¦å·","url":"/2025/01/31/insight/prob_base/","content":"å†™åœ¨å‰é¢æ•æˆ‘æ„šç¬¨ï¼Œåœ¨ç¬¬ä¸€æ¬¡å­¦æ¦‚ç‡è®ºçš„æ—¶å€™ä¸€ç›´æä¸æ¸…æ¥šåŸºç¡€çš„å®šä¹‰ï¼Œä¼¼ä¹åæ¥æ‰€æœ‰çš„å…¬å¼éƒ½æ˜¯æˆ–å¤šæˆ–å°‘é èƒŒè¯µçš„ï¼›é‡æ–°å›æ¥å¤ä¹ çš„æ—¶å€™çœ‹åˆ°äº†åŸºç¡€çš„æ¡ä»¶æ¦‚ç‡çš„å®šä¹‰ï¼Œå®åœ¨æ˜¯è§‰å¾—åç›´è§‰ï¼Œå› æ­¤ç”¨æˆ‘è‡ªå·±å–œæ¬¢çš„æ–¹å¼é‡å†™ä¸€ä¸‹ï¼Œæ–¹ä¾¿æ—¥åé€ŸæŸ¥ã€‚\næ¡ä»¶æ¦‚ç‡å°±æ˜¯ä¸ºäº†ç†è§£ä»€ä¹ˆæ˜¯æ¡ä»¶æ¦‚ç‡ï¼Œå¸¸è§çš„æ¡ä»¶æ¦‚ç‡çš„å®šä¹‰æ˜¯è¿™æ ·çš„ï¼š\nP(B|A) = \\frac{P(A,B)}{P(A)}\\tag{1}æ„å‘³ç€ï¼Œåœ¨å‘ç”Ÿäº‹ä»¶Açš„æ¡ä»¶ä¸‹ï¼Œäº‹ä»¶Bå‘ç”Ÿçš„æ¦‚ç‡ã€‚\nä»¤äººè¿·æƒ‘çš„æ˜¯ä»€ä¹ˆæ˜¯â€œåœ¨å‘ç”Ÿäº‹ä»¶Açš„æ¡ä»¶ä¸‹â€ï¼Œè€Œä¸”åé¢ä¼šè®¨è®ºåˆ°ä»€ä¹ˆæ˜¯ä¸å‘ç”Ÿè¿™ä»¶äº‹æƒ…çš„æ¦‚ç‡ï¼Œå› æ­¤æ‰€ä»¥æˆ‘å–œæ¬¢å…ˆä¿®æ”¹äº‹ä»¶çš„å®šä¹‰ä¸º A_i \\in {A}, i=0,1,...,|A| ï¼ŒB_j \\in {B}, j=0,1,...,|B|ï¼Œè¿™æ ·ä¾¿äºè§‚å¯Ÿä¸¤ä¸ªä¸åŒçš„äº‹ä»¶ç»„ä¸­çš„æ‰€æœ‰çš„äº‹ä»¶çš„äº¤å‰å¯èƒ½æ€§ï¼Œè€Œä¸å†æ˜¯ä¸€ä¸ªäº‹ä»¶å‘ç”Ÿxxæƒ…å†µçš„å¯èƒ½æ€§ã€‚\nè¿™æ ·å®šä¹‰ä¸¤ä¸ªäº‹ä»¶çš„æ¡ä»¶æ¦‚ç‡ï¼Œæ˜¯æœ€å¥½ç†è§£çš„(å› ä¸ºå­˜åœ¨Bçš„æ—¶å€™Aä¸èƒ½å•ç‹¬å­˜åœ¨)ï¼š\nP(B_j|A_i) = \\frac{P(A_i,B_j)}{P(A_i, B)} \\tag{2}ç®€å•è§£é‡Šå°±æ˜¯ï¼Œâ€œåœ¨A_iäº‹ä»¶å‘ç”Ÿçš„æ¡ä»¶ä¸‹ï¼Œåœ¨Bäº‹ä»¶æ—ä¸­å‘ç”ŸB_jäº‹ä»¶çš„å¯èƒ½æ€§â€ã€‚\nè´å¶æ–¯å…¬å¼è´å¶æ–¯å…¬å¼å·§å¦™åœ°è”ç»“äº†é€†åºçš„å› æœï¼Œå¦‚æœè¯´æ¡ä»¶æ¦‚ç‡ï¼šP(B_j|A_i) æ˜¯ P(æœ|å› ) çš„è¯ï¼Œé‚£ä¹ˆè´å¶æ–¯å°±æ˜¯æ‰¾åˆ°äº† P(æœ|å› ) = Bayes(P(å› |æœ))ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæ¡ä»¶å’Œç»“æœæ˜¯å¯äº’æ¢çš„ã€‚\nå¸¸è§çš„å†™æ³•æ˜¯ï¼š\nP(B|A) = \\frac{P(B)P(A|B)}{P(A)} = \\frac{P(B)P(A|B)}{P(B)P(A|B) + P(Â¬ {B})P(A|Â¬ B)} \\tag{3}ä½†æ˜¯è¿™æ— è®ºæ˜¯é¡ºåºè¿˜æ˜¯å…¶ä¸­çš„å®šä¹‰ç¬¦å·ï¼Œéƒ½å¤ªååŒ–ç®€çº¦æ‰å’Œå¯¹äºäº‹ä»¶çš„å®šä¹‰çš„ç›´è§‰äº†ï¼Œè€Œä¸”è®©æˆ‘æ„Ÿè§‰å›°æƒ‘ï¼Œå› æ­¤æŒ‰ç…§å…¬å¼(2)ï¼Œå¯ä»¥æ”¹å†™æˆï¼š\nP(B_j|A_i) = \\frac{P(A_i,B_j)}{P(A_i, B)} = \\frac{P(A_i|B_j)P(B_j)}{P(A_i|B_j)P(B_j) + P(A_i|B \\backslash B_j)P(B \\backslash B_j)} \\tag{4}è¿™æ ·ä¸€åˆ‡éƒ½å¾ˆé¡ºçœ¼äº†ï¼Œåˆ†å­å°±æ˜¯å…¬å¼(2)å¾—åˆ°ï¼Œåˆ†æ¯å°±æ˜¯ï¼š\nP(A_i, B) = P(A_i, B_j) + P(A_i, B \\backslash B_j)è¿™æ ·çš„å½¢å¼å…¶å®ä¹Ÿæ›´å¥½åœ°èƒ½å¤Ÿå¼•å‡ºä¸ºä»€ä¹ˆé¦™å†œ(Claude Elwood Shannon)ä¼šç”¨logæ¥å®šä¹‰ä¿¡æ¯ç†µï¼Œå› ä¸ºå¯¹æ•°å‡½æ•°å°±æ˜¯å…·æœ‰è¿™æ ·çš„æ€§è´¨ï¼š\nlogB + log(B/B_j) = log(B/B_j\\times B_j) = logBä¾‹å­è¯´æœæˆ‘è‡ªå·±ï¼Œä¹Ÿè¯´æœä½ ï¼Œè¯•è¯•çœ‹å‘¢è¯´ä¸å®šå°±æ›´æœ‰é“ç†ï¼Œå“ˆå“ˆå“ˆå“ˆã€‚\næ —å­1\näº‹ä»¶æ— \\{A_i\\} ï¼šæ˜å¤©ä¸‹é›¨çš„æƒ…å†µ\n\nA_0ï¼šä¸ä¸‹é›¨\nA_1ï¼šä¸‹é›¨\n\n\näº‹ä»¶æ— \\{B_j\\} ï¼šæŸå­¦ç”Ÿæ˜å¤©å»ä¸Šå­¦çš„æƒ…å†µ\n\nB_0ï¼šä¸ä¸Šå­¦\nB_1ï¼šä¸Šå­¦\n\n\n\næˆ‘ä»¬å¯ä»¥ç”¨è”åˆæ¦‚ç‡ P(A_i, B_j) æ¥è¡¨ç¤ºä¸¤ä¸ªäº‹ä»¶åŒæ—¶å‘ç”Ÿçš„æ¦‚ç‡ã€‚æ ¹æ®ä½ æä¾›çš„è¡¨æ ¼ï¼Œæˆ‘ä»¬æœ‰ï¼š\n\n\n\n\nP(A_i, B_j)\nB_0(ä¸ä¸Šå­¦)\nB_1(ä¸Šå­¦)\n\n\n\n\nA_0(ä¸ä¸‹é›¨)\n1/3\n1/3\n\n\nA_1(ä¸‹é›¨)\n1/12\n1/4\n\n\n\n\né‡æ–°è¡¨è¿°é—®é¢˜å‡è®¾æˆ‘ä»¬æƒ³è¦è®¡ç®—åœ¨æŸä¸ªç‰¹å®šæ¡ä»¶ä¸‹ï¼ˆä¾‹å¦‚ï¼Œç»™å®š A_i ï¼‰äº‹ä»¶ B_j å‘ç”Ÿçš„æ¦‚ç‡ï¼Œå³æ¡ä»¶æ¦‚ç‡ P(B_j | A_i)ã€‚æ ¹æ®è´å¶æ–¯å…¬å¼ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·è®¡ç®—ï¼š\nP(B_j | A_i) = \\frac{P(A_i, B_j)}{P(A_i,B)}å…¶ä¸­ï¼š\n\nP(A_i, B_j) æ˜¯è”åˆæ¦‚ç‡ï¼Œå³äº‹ä»¶ A_i å’Œäº‹ä»¶ B_j åŒæ—¶å‘ç”Ÿçš„æ¦‚ç‡ï¼Œ\\sum P(A_i, B_j) =1ã€‚\nP(A_i, B) æ˜¯äº‹ä»¶ A_i å‘ç”Ÿçš„è¾¹ç¼˜æ¦‚ç‡ã€‚\n\n\n\n\n\nA\nA_0(ä¸ä¸‹é›¨)\nA_1(ä¸‹é›¨)\n\n\n\n\nP(A_i)\n2/3\n1/3\n\n\n\n\n\nP(B_j, A) æ˜¯äº‹ä»¶ B_j å‘ç”Ÿçš„è¾¹ç¼˜æ¦‚ç‡ã€‚\n\n\n\n\n\nB\nB_0(ä¸ä¸Šå­¦)\nB_1(ä¸Šå­¦)\n\n\n\n\nP(B_j)\n5/12\n7/12\n\n\n\n\nå…ˆæœ‰è”åˆæ¦‚ç‡æ‰æœ‰è¾¹ç¼˜æ¦‚ç‡åˆ†å¸ƒï¼ï¼ï¼é™¤éä¸¤ä¸ªäº‹ä»¶æ—ç‹¬ç«‹\n\nç¤ºä¾‹è®¡ç®—\nè®¡ç®— P(B_1 | A_1)ï¼ˆå³åœ¨ä¸‹é›¨çš„æƒ…å†µä¸‹å­¦ç”Ÿä¸Šå­¦çš„æ¦‚ç‡ï¼‰ï¼š\nP(B_1 | A_1) = \\frac{P(A_1, B_1)}{P(A_1, B)}ä»è¡¨æ ¼ä¸­å¯ä»¥çœ‹åˆ°ï¼š\nP(A_1, B_1) = \\frac{1}{4}P(A_1, B) = P(A_1, B_0) + P(A_1, B_1) = \\frac{1}{12} + \\frac{1}{4} = \\frac{1}{3}å› æ­¤ï¼š\nP(B_1 | A_1) = \\frac{\\frac{1}{4}}{\\frac{1}{3}} = \\frac{3}{4}\n\n\næ —å­2ç™Œç—‡æ£€æµ‹ â€”â€” æ£€æµ‹ç»“æœæ˜¯é˜³æ€§ä¸ºäº‹ä»¶Aï¼Œå®é™…æ‚£æœ‰ç™Œç—‡ä¸ºäº‹ä»¶Cï¼Œ è¯¥åŒ»é™¢æ£€æµ‹çš„å¯é åº¦ä¸º95%ï¼ˆå³æ‚£æœ‰ç™Œç—‡æ£€æµ‹ä¸ºé˜³æ€§çš„æ¦‚ç‡ä¸º95%ï¼Œæ²¡æœ‰ç™Œç—‡æ£€æµ‹ç»“æœä¸ºé˜´æ€§çš„æ¦‚ç‡ä¸º 95%ï¼‰ï¼Œäººç¾¤ä¸­æ‚£æœ‰ç™Œç—‡çš„æ¦‚ç‡ä¸º1%ã€‚æ±‚è‹¥æ£€æµ‹ç»“æœä¸ºé˜³æ€§ï¼Œå®é™…æ‚£æœ‰ç™Œç—‡çš„æ¦‚ç‡æ˜¯å¤šå°‘ã€‚\né‡æ–°è¡¨è¿°é—®é¢˜å¥½çš„ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è´å¶æ–¯å…¬å¼æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚å‡è®¾ï¼š\n\näº‹ä»¶æ— \\{A_i\\}ï¼šæ£€æµ‹ç»“æœ\n\nA_0ï¼šé˜´æ€§\nA_1ï¼šé˜³æ€§\n\n\näº‹ä»¶æ— \\{C_j\\}ï¼šå®é™…æ‚£æœ‰ç™Œç—‡æƒ…å†µ\n\nC_0ï¼šæ²¡æœ‰æ‚£ç™Œ\nC_1ï¼šç¡®å®æ‚£ç™Œ\n\n\n\nå·²çŸ¥æ¡ä»¶å¦‚ä¸‹ï¼š\n\næ£€æµ‹çš„å¯é åº¦ä¸º95%ï¼Œå³ P(A_1|C_1) = 0.95ï¼ˆæ‚£æœ‰ç™Œç—‡çš„æƒ…å†µä¸‹è¢«æ£€æµ‹ä¸ºé˜³æ€§ï¼‰ã€‚\nåŒæ—¶ï¼Œæ²¡æ‚£æœ‰ç™Œç—‡çš„æƒ…å†µä¸‹è¢«æ£€æµ‹ä¸ºé˜´æ€§çš„æ¦‚ç‡ä¹Ÿä¸º95%ï¼Œå› æ­¤P(A_0|C_0) = 0.95ã€‚\nä¸Šè¿°äºŒå¼å¯ä»¥å¾—åˆ°è¯¯æ£€ç‡æ˜¯5%ï¼šP(A_1âˆ£Â¬C_1) = P(A_0âˆ£Â¬C_0) = P(A_1âˆ£C_0) = P(A_0âˆ£C_1) =1âˆ’0.95=0.05\näººç¾¤ä¸­æ‚£æœ‰ç™Œç—‡çš„æ¦‚ç‡ä¸º1%ï¼Œå³ P(C_1) = 0.01ã€‚\nå› æ­¤ï¼Œæ²¡æœ‰ç™Œç—‡çš„æ¦‚ç‡ä¸º P(C_0) = 1 - P(C) = 0.99ã€‚\n\nç¤ºä¾‹è®¡ç®—æˆ‘ä»¬éœ€è¦è®¡ç®—çš„æ˜¯åœ¨æ£€æµ‹ç»“æœä¸ºé˜³æ€§çš„æƒ…å†µä¸‹ï¼Œå®é™…æ‚£æœ‰ç™Œç—‡çš„æ¦‚ç‡ P(C_1|A_1) ï¼Œå³å€’ç½®å› æœï¼Œè´å¶æ–¯ã€‚\nP(C_1|A_1) = \\frac{P(C_1, A_1)}{P(C_1,A)} = \\frac{P(A_1 | C_1)P(C_1)}{P(A_1 | C_1)P(C_1) + P(A_1 | C_0)P(C_0)} \\approx 0.161\næˆ–è€…ï¼Œæˆ‘ä»¬è¿˜æœ‰å…¶ä»–çš„è§£é‡Šè¯ï¼š\nå°†ç™Œç—‡æ£€æµ‹é—®é¢˜è½¬åŒ–ä¸ºæœºå™¨å­¦ä¹ ä¸­çš„æ··æ·†çŸ©é˜µï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬æ›´ç›´è§‚åœ°ç†è§£æ¨¡å‹çš„é¢„æµ‹ç»“æœä¸å®é™…æƒ…å†µä¹‹é—´çš„å…³ç³»ã€‚æ··æ·†çŸ©é˜µæ˜¯ä¸€ä¸ªç‰¹å®šæ ¼å¼çš„è¡¨æ ¼ï¼Œç”¨äºæè¿°åˆ†ç±»æ¨¡å‹ï¼ˆæˆ–â€œåˆ†ç±»å™¨â€ï¼‰çš„è¡¨ç°ï¼Œæ˜¾ç¤ºäº†æ¯ä¸ªç±»åˆ«è¢«æ­£ç¡®å’Œé”™è¯¯åˆ†ç±»çš„æƒ…å†µã€‚\nåœ¨ä½ æä¾›çš„ç™Œç—‡æ£€æµ‹é—®é¢˜ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶è§†ä¸ºä¸€ä¸ªäºŒåˆ†ç±»é—®é¢˜ï¼Œå…¶ä¸­ï¼š\n\næ­£ç±»ï¼ˆPositive, Pï¼‰ï¼šå®é™…æ‚£æœ‰ç™Œç—‡ã€‚\nè´Ÿç±»ï¼ˆNegative, Nï¼‰ï¼šå®é™…ä¸Šæ²¡æœ‰ç™Œç—‡ã€‚\n\nåŸºäºè¿™äº›å®šä¹‰ï¼Œæˆ‘ä»¬å¯ä»¥æ„å»ºå¦‚ä¸‹çš„æ··æ·†çŸ©é˜µï¼ˆConfusion Matrixï¼‰ï¼š\n\n\n\n\n\né¢„æµ‹: æ‚£æœ‰ç™Œç—‡ (é˜³æ€§)\né¢„æµ‹: æœªæ‚£ç™Œç—‡ (é˜´æ€§)\n\n\n\n\nå®é™…: æ‚£æœ‰ç™Œç—‡\nçœŸé˜³æ€§ (TP)\nå‡é˜´æ€§ (FN)\n\n\nå®é™…: æœªæ‚£ç™Œç—‡\nå‡é˜³æ€§ (FP)\nçœŸé˜´æ€§ (TN)\n\n\n\n\n\nçœŸé˜³æ€§ (TP)ï¼šå®é™…ä¸Šæ‚£æœ‰ç™Œç—‡ä¸”è¢«æ­£ç¡®è¯Šæ–­ä¸ºé˜³æ€§çš„æ¦‚ç‡æ˜¯ P(A_1 | C_1)P(C_1) = 0.95 \\times 0.01 = 0.0095 ã€‚\nå‡é˜´æ€§ (FN)ï¼šå®é™…ä¸Šæ‚£æœ‰ç™Œç—‡ä½†è¢«é”™è¯¯åœ°è¯Šæ–­ä¸ºé˜´æ€§çš„æ¦‚ç‡æ˜¯ 1 - TP = 0.05 \\times 0.01 = 0.0005 ã€‚\nå‡é˜³æ€§ (FP)ï¼šå®é™…ä¸Šæœªæ‚£ç™Œç—‡ä½†è¢«é”™è¯¯åœ°è¯Šæ–­ä¸ºé˜³æ€§çš„æ¦‚ç‡æ˜¯ P(A_1 | C_0)P(C_0) = 0.05 \\times 0.99 = 0.0495 ã€‚\nçœŸé˜´æ€§ (TN)ï¼šå®é™…ä¸Šæœªæ‚£ç™Œç—‡ä¸”è¢«æ­£ç¡®è¯Šæ–­ä¸ºé˜´æ€§çš„æ¦‚ç‡æ˜¯ 1 - FP = 0.95 \\times 0.99 = 0.9405 ã€‚\n\nå› æ­¤ï¼Œæ·†çŸ©é˜µå¦‚ä¸‹æ‰€ç¤ºï¼š\n\n\n\n\n\né¢„æµ‹: æ‚£æœ‰ç™Œç—‡ (é˜³æ€§)\né¢„æµ‹: æœªæ‚£ç™Œç—‡ (é˜´æ€§)\n\n\n\n\nå®é™…: æ‚£æœ‰ç™Œç—‡\n0.95%\n0.05%\n\n\nå®é™…: æœªæ‚£ç™Œç—‡\n4.95%\n94.05%\n\n\n\n\né€šè¿‡æ··æ·†çŸ©é˜µï¼Œæˆ‘ä»¬å¯ä»¥è®¡ç®—å„ç§æ€§èƒ½æŒ‡æ ‡æ¥è¯„ä¼°åˆ†ç±»å™¨çš„æ•ˆæœï¼Œæ¯”å¦‚å‡†ç¡®ç‡ï¼ˆAccuracyï¼‰ã€ç²¾ç¡®ç‡ï¼ˆPrecisionï¼‰ã€å¬å›ç‡ï¼ˆRecallï¼‰ï¼Œä»¥åŠF1åˆ†æ•°ï¼ˆF1 Scoreï¼‰ã€‚è¿™äº›æŒ‡æ ‡å¸®åŠ©æˆ‘ä»¬å…¨é¢äº†è§£åˆ†ç±»æ¨¡å‹çš„è¡¨ç°ã€‚\nå…¶å®åŸé¢˜å°±æ˜¯æ±‚ç²¾ç¡®ç‡\nè®¡ç®—å…¬å¼1. å‡†ç¡®ç‡ï¼ˆAccuracyï¼‰å‡†ç¡®ç‡æ˜¯æŒ‡æ‰€æœ‰é¢„æµ‹æ­£ç¡®çš„æ ·æœ¬å æ€»æ ·æœ¬æ•°çš„æ¯”ä¾‹ã€‚\n\\text{Accuracy} = \\frac{TP + TN}{TP + TN + FP + FN}ä»£å…¥å…·ä½“æ•°å€¼ï¼š\n\\text{Accuracy} = \\frac{0.0095 + 0.9405}{0.0095 + 0.9405 + 0.0495 + 0.0005} = \\frac{0.95}{1} = 0.952. ç²¾ç¡®ç‡ï¼ˆPrecisionï¼‰ç²¾ç¡®ç‡æ˜¯æŒ‡è¢«é¢„æµ‹ä¸ºæ­£ç±»çš„æ ·æœ¬ä¸­å®é™…ä¸ºæ­£ç±»çš„æ¯”ä¾‹ã€‚\n\\text{Precision} = \\frac{TP}{TP + FP}ä»£å…¥å…·ä½“æ•°å€¼ï¼š\n\\text{Precision} = \\frac{0.0095}{0.0095 + 0.0495} = \\frac{0.0095}{0.059} \\approx 0.1613. å¬å›ç‡ï¼ˆRecallï¼‰å¬å›ç‡æ˜¯æŒ‡å®é™…ä¸ºæ­£ç±»çš„æ ·æœ¬ä¸­è¢«æ­£ç¡®é¢„æµ‹ä¸ºæ­£ç±»çš„æ¯”ä¾‹ã€‚\n\\text{Recall} = \\frac{TP}{TP + FN}ä»£å…¥å…·ä½“æ•°å€¼ï¼š\n\\text{Recall} = \\frac{0.0095}{0.0095 + 0.0005} = \\frac{0.0095}{0.01} = 0.954. F1 åˆ†æ•°ï¼ˆF1 Scoreï¼‰F1åˆ†æ•°æ˜¯ç²¾ç¡®ç‡å’Œå¬å›ç‡çš„è°ƒå’Œå¹³å‡å€¼ï¼Œæä¾›äº†å•ä¸€æŒ‡æ ‡æ¥è¯„ä¼°æ¨¡å‹çš„æ•´ä½“è¡¨ç°ã€‚\n\\text{F1 Score} = 2 \\cdot \\frac{\\text{Precision} \\cdot \\text{Recall}}{\\text{Precision} + \\text{Recall}}ä»£å…¥ç²¾ç¡®ç‡å’Œå¬å›ç‡çš„å…·ä½“æ•°å€¼ï¼š\n\\text{F1 Score} = 2 \\cdot \\frac{0.161 \\cdot 0.95}{0.161 + 0.95} \\approx 2 \\cdot \\frac{0.15295}{1.111} \\approx 0.275æ€»ç»“\nå‡†ç¡®ç‡ (Accuracy): 0.95 æˆ–è€… 95%\nç²¾ç¡®ç‡ (Precision): 0.161 æˆ–è€… 16.1%\nå¬å›ç‡ (Recall): 0.95 æˆ–è€… 95%\nF1 åˆ†æ•° (F1 Score): 0.275 æˆ–è€… 27.5%\n\nè¿™äº›æŒ‡æ ‡å±•ç¤ºäº†æ¨¡å‹åœ¨ä¸åŒæ–¹é¢çš„è¡¨ç°ï¼š\n\nè™½ç„¶æ•´ä½“å‡†ç¡®ç‡å¾ˆé«˜ï¼ˆ95%ï¼‰ï¼Œä½†è¿™æ˜¯å› ä¸ºå¤§å¤šæ•°æ ·æœ¬éƒ½æ˜¯è´Ÿç±»ï¼ˆæœªæ‚£ç™Œç—‡ï¼‰ã€‚\nç²¾ç¡®ç‡è¾ƒä½ï¼ˆ16.1%ï¼‰ï¼Œæ„å‘³ç€åœ¨æ‰€æœ‰è¢«è¯Šæ–­ä¸ºé˜³æ€§çš„ç—…ä¾‹ä¸­ï¼Œåªæœ‰å¤§çº¦16.1%ç¡®å®æ˜¯æ‚£æœ‰ç™Œç—‡çš„ã€‚\nå¬å›ç‡è¾ƒé«˜ï¼ˆ95%ï¼‰ï¼Œè¯´æ˜å¤§éƒ¨åˆ†å®é™…æ‚£æœ‰ç™Œç—‡çš„äººéƒ½èƒ½è¢«æ­£ç¡®è¯Šæ–­å‡ºæ¥ã€‚\nF1åˆ†æ•°ç»¼åˆè€ƒè™‘äº†ç²¾ç¡®ç‡å’Œå¬å›ç‡ï¼Œåæ˜ äº†æ¨¡å‹åœ¨è¿™ä¸¤ä¸ªæ–¹é¢çš„å¹³è¡¡æƒ…å†µã€‚\n\n"},{"title":"Configure Clash Nyanpasu on Linux","url":"/2025/07/27/fast_startup/Configure-Clash-Nyanpasu-on-Linux/","content":"Choosing and Setting up Clash.Nyanpasu Client on Linux\n\nThis guide will walk you through setting up Clash.Nyanpasu on a Linux server without a graphical user interface. Weâ€™ll use the Mihomo core, and youâ€™ll learn how to manage your proxy settings via the command line.\nWe recommend using Clash.Nyanpasu for its robust features and active development.\n1. Determine Your System ArchitectureFirst, identify your Linux serverâ€™s architecture to download the correct AppImage. For example, if you have an x86_64 Ubuntu server, youâ€™ll download the amd64.AppImage.\nTo find your architecture, use the command:\nuname -m\nThis will output something like x86_64, aarch64, etc.\n2. Download Clash.NyanpasuNavigate to the Clash.Nyanpasu releases page. Find the latest pre-release or stable release and locate the .AppImage file corresponding to your architecture.\nFor example, for x86_64 (also known as amd64), you might download:\nwget https://github.com/libnyanpasu/clash-nyanpasu/releases/download/pre-release/Clash.Nyanpasu_2.0.0-alpha+2c587d0_amd64.AppImage\nRemember to replace the URL with the specific version you are downloading.\n3. Extract the AppImageAppImages are self-contained executables. While they can often be run directly on systems with FUSE set up, on servers without a graphical environment, you might encounter issues like:\n$ ./Clash.Nyanpasu_2.0.0-alpha+2c587d0_amd64.AppImagefuse: device not found, try &#x27;modprobe fuse&#x27; firstCannot mount AppImage, please check your FUSE setup.You might still be able to extract the contents of this AppImageif you run it with the --appimage-extract option.See https://github.com/AppImage/AppImageKit/wiki/FUSEfor more informationopen dir error: No such file or directory\nAnd sudo modprobe fuse might not work if modprobe is not in your PATH or if you donâ€™t have the necessary kernel modules.\nTo proceed without FUSE, extract the AppImageâ€™s contents:\nchmod +x Clash.Nyanpasu_2.0.0-alpha+2c587d0_amd64.AppImage./Clash.Nyanpasu_2.0.0-alpha+2c587d0_amd64.AppImage --appimage-extract\nThis will create a squashfs-root directory in your current location.\n4. Prepare Configuration Files4.1 Locate the Mihomo ExecutableAfter extraction, the Mihomo core executable (which Clash.Nyanpasu uses) will be located within the squashfs-root directory. Based on the example, itâ€™s typically found at:\n/workspace/squashfs-root/usr/bin/mihomo\n(Note: The path in your system might vary if you extracted it elsewhere. Adjust /workspace/ accordingly.)\n4.2 Create Configuration DirectoryCreate a directory for your Clash configuration files. Weâ€™ll use /etc/clash/ as the default in this guide:\nsudo mkdir -p /etc/clash\n4.3 Copy Configuration FilesCopy your config.yaml file (which you should have prepared beforehand, containing your proxy settings) into the /etc/clash/ directory.\nsudo cp /path/to/your/config.yaml /etc/clash/config.yaml\nReplace /path/to/your/config.yaml with the actual path to your configuration file.\n4.4 GeoIP Database (MMDB)Clash uses a GeoIP database (Country.mmdb) for IP-based routing. If you donâ€™t have one, youâ€™ll need to download it. Mihomo typically expects it in the same directory as your config.yaml.\nYou can download Country.mmdb from sources like:\n\nOfficial MaxMind GeoLite2: You need to register for a free account to download GeoLite2-Country.mmdb, then rename it to Country.mmdb.\nThird-party Mirrors (use with caution and verify integrity): Some Clash-related projects provide direct downloads. Search for â€œCountry.mmdb download clashâ€ to find reputable sources.\n\nOnce downloaded, copy it to your configuration directory:\nsudo cp /path/to/your/Country.mmdb /etc/clash/Country.mmdb\n5. Configure Shell EnvironmentTo easily manage Clash and proxy settings, add the following functions to your ~/.bashrc file. This allows you to start Clash, and enable/disable proxy settings with simple commands.\nOpen ~/.bashrc with your preferred editor (e.g., nano or vim):\nnano ~/.bashrc\nAdd the following lines to the end of the file:\n# --- Clash Functions ---clash() &#123;    local MIHOMO_BIN=&quot;/workspace/squashfs-root/usr/bin/mihomo&quot; # Adjust this path if necessary    local DEFAULT_CONFIG_DIR=&quot;/etc/clash/&quot;    local CUSTOM_CONFIG_DIR=&quot;$1&quot; # First argument can be a custom config directory    # Check if mihomo executable exists    if [ ! -f &quot;$MIHOMO_BIN&quot; ]; then        echo &quot;Error: Mihomo executable not found at $MIHOMO_BIN&quot; &gt;&amp;2 # Output to standard error        return 1 # Return non-zero status code for failure    fi    # Determine which config directory to use    local CONFIG_TO_USE=&quot;$DEFAULT_CONFIG_DIR&quot;    if [ -n &quot;$CUSTOM_CONFIG_DIR&quot; ]; then # If a custom config directory is provided        CONFIG_TO_USE=&quot;$CUSTOM_CONFIG_DIR&quot;        echo &quot;Using custom configuration directory: $CONFIG_TO_USE&quot;    else        echo &quot;Using default configuration directory: $DEFAULT_CONFIG_DIR&quot;    fi    # Check if the config directory exists    if [ ! -d &quot;$CONFIG_TO_USE&quot; ]; then        echo &quot;Error: Clash configuration directory not found at $CONFIG_TO_USE&quot; &gt;&amp;2        echo &quot;Please ensure this directory exists and contains a config.yaml file.&quot; &gt;&amp;2        return 1    fi    echo &quot;Starting Mihomo...&quot;    # Using exec ensures mihomo replaces the current shell process, so when mihomo exits, the function also ends.    # If you want mihomo to run in the background, remove &#x27;exec&#x27; and add &#x27;&amp;&#x27; at the end.    &quot;$MIHOMO_BIN&quot; -d &quot;$CONFIG_TO_USE&quot; &quot;$@&quot;    # &quot;$@&quot; passes all arguments of the function to mihomo, allowing you to run: clash /path/to/my/config --port 7890    echo &quot;Mihomo started or exited.&quot;&#125;# --- Proxy Control Functions ---# Define a function to set system proxy to Clashproxy_on() &#123;    # Check if Clash&#x27;s listening port is provided, otherwise use default    local CLASH_PORT=$&#123;1:-7890&#125; # Default port is 7890    echo &quot;Setting HTTP/HTTPS proxy to Clash (Port: $CLASH_PORT)...&quot;    # Set HTTP and HTTPS proxy environment variables    # Ensure you use your actual Clash listening address, usually 127.0.0.1 (localhost)    export http_proxy=&quot;http://127.0.0.1:$CLASH_PORT&quot;    export https_proxy=&quot;http://127.0.0.1:$CLASH_PORT&quot;    # It&#x27;s also often recommended to set all_proxy to cover more applications (e.g., curl)    export all_proxy=&quot;socks5://127.0.0.1:$CLASH_PORT&quot; # Clash also listens on SOCKS5 proxy    # Set addresses that should not use the proxy, typically including localhost and private network addresses    # Traffic to these addresses usually doesn&#x27;t need to be proxied and could cause issues otherwise    export no_proxy=&quot;localhost,127.0.0.1,::1,*.local,10.0.0.0/8,172.16.0.0/12,192.168.0.0/16&quot;    echo &quot;Proxy set successfully!&quot;    echo &quot;   http_proxy: $http_proxy&quot;    echo &quot;   https_proxy: $https_proxy&quot;    echo &quot;   all_proxy: $all_proxy&quot;    echo &quot;   no_proxy: $no_proxy&quot;&#125;# Define a function to turn off the proxyproxy_off() &#123;    echo &quot;Turning off HTTP/HTTPS proxy...&quot;    # Unset proxy environment variables    unset http_proxy    unset https_proxy    unset all_proxy    unset no_proxy    echo &quot;Proxy turned off.&quot;&#125;\nSave the file and exit the editor.\nApply the changes to your current session:\nsource ~/.bashrc\n6. Running Clash with TMUXSince youâ€™re on a server without a GUI, youâ€™ll want to run Clash in a detached session so it continues running even after you close your terminal. tmux is an excellent tool for this.\n\nStart a new tmux session:\ntmux new -s clash\nYou are now inside a new tmux session named clash.\n\nStart Clash:\nInside the tmux session, run the clash function you defined:\nclash\nYou should see output indicating Mihomo is starting.\n\nDetach from the tmux session:\nPress Ctrl+b then d. You will be returned to your main shell, and Clash will continue running in the background within the tmux session.\n\n\n7. Controlling the ProxyFrom any other terminal window on your server (or your main shell after detaching from tmux):\n\nTo enable the proxy:\nproxy_on\nYou can optionally specify a port if your Clash instance is listening on something other than 7890: proxy_on 8888.\n\nTo disable the proxy:\nproxy_off\n\n\n8. Managing the Clash Session\nTo reattach to the Clash tmux session:\ntmux attach -t clash\n\nTo stop Clash:\nIf you are attached to the clash, you can stop Clash by pressing Ctrl+c in the terminal where Clash is running. This will terminate the Mihomo process and close the tmux pane.\n\nTo kill the tmux session (and Clash running within it):\ntmux kill-session -t clash\n\n\nThis comprehensive setup allows you to efficiently manage Clash.Nyanpasu and your proxy settings on a headless Linux server.\n","tags":["Network","VPS"]},{"title":"Hello World","url":"/2025/01/18/hello-world/","content":"Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub.\nQuick Starthexo clean &amp;&amp; hexo generate &amp;&amp; hexo server\nor\nhexo clean &amp;&amp; hexo generate &amp;&amp; hexo deploy\nCreate a new posthexo new &quot;My New Post&quot;\nMore info: Writing\nRun serverhexo server\nMore info: Server\nGenerate static fileshexo generate\nMore info: Generating\nDeploy to remote siteshexo deploy\nMore info: Deployment\n"},{"title":"è§£å†³CUDA10ä»¥åçš„GPUå¯¹äºTensorflow-1.x-gpuçš„ä¾èµ–å¤±è´¥","url":"/2025/01/21/fast_startup/tf1_15_gpu_docker/","content":"å†™åœ¨å‰é¢å·¥ä¸šç•Œå¯¹äºTensorflowçš„å–œçˆ±æ˜¯è¶…ä¹æˆ‘çš„æ„æ–™çš„ï¼Œå¯ä»¥è¯´æ˜¯å› ä¸ºTF1.xçš„è¿è¡Œå‰çš„é™æ€ç¼–è¯‘ä½¿å¾—å¯¹äºä»£ç å’Œè®¾å¤‡çš„ä¼˜åŒ–èƒ½å¤Ÿæ›´åŠ ç»†è‡´ï¼Œä¹Ÿå¯ä»¥è¯´æ˜¯å¤§éƒ¨åˆ†åœ¨21ä¸–çºª10å¹´ä»£è“¬å‹ƒå‘å±•çš„å…¬å¸â€”â€”å°¤å…¶æ˜¯ä¸­å›½çš„â€”â€”éƒ½ä½¿ç”¨çš„æ˜¯Nvidiaçš„Voltaæ¶æ„ï¼Œæ¯”å¦‚è¯´V100/T4ï¼Œè¿™ä¹Ÿå¯ä»¥è¯´æ˜¯åœ¨ç¬¬ä¸€æ‰¹è´¸æ˜“æˆ˜ç¦ä»¤äº§ç‰©ã€‚\nå…¶æ¬¡æ˜¯å½“å¹´Meta(from 2021.10.28)è¿˜æ˜¯Facebookï¼ŒGoogleçš„TFæœ‰å¹¿å¤§çš„å¸‚åœºï¼Œä¸”å¯è’™æˆ‘çš„ã€ŠDeep Learning with Pythonã€‹ä½œè€…FranÃ§ois Cholleté¢†è¡”äº†Kerasçš„é›†æˆè¿›å…¥TF. ä»¥åŠè½°è½°çƒˆçƒˆçš„TFçš„2.xç‰ˆæœ¬ã€‚\nå½¼æ—¶å°±è§‰å¾—éœ€è¦åŒæ—¶å…¼å®¹pyhton+GPUç¼–è¯‘+å¯¹åº”ç‰ˆæœ¬çš„TFåº“ååˆ†éº»çƒ¦ï¼Œå°¤å…¶æ˜¯å¯¹äºåˆå­¦è€…å’Œä¾¿æ·çš„Windowsç¬”è®°æœ¬ç”¨æˆ·éšæ—¶æ‹‰å–ä¸€ä¸‹githubçš„é¡¹ç›®æµ‹è¯•ä¸€ä¸‹ï¼ŒåŒæ—¶ç°åœ¨Dockerè¶Šæ¥è¶Šå—åˆ°æ¬¢è¿å› æ­¤ï¼Œå§‘ä¸”æœ¬æ–‡å…ˆé€šè¿‡Dockeræ¥çœå»ä¸€åˆ‡çš„â€œä¸ºä»€ä¹ˆæˆ‘çš„è®¾å¤‡è¿è¡Œä¸äº†â€çš„é—®é¢˜æ¥åˆ—å‡ºè§£å†³æ­¥éª¤ã€‚\nåºŸè¯å°±è¿™ä¹ˆå¤šï¼Œä¸ƒæ­¥ä»¥å†…æå®šã€‚\nåœ¨Windowsä¸Šä½¿ç”¨Dockerè¿è¡ŒTensorFlow 1.15å¹¶å¯ç”¨GPUåŠ é€Ÿæœ¬æŒ‡å—ä»¥TF1.15ä¸ºä¾‹ï¼Œå°†å¸®åŠ©ä½ åœ¨Windowsä¸Šä½¿ç”¨Dockerè¿è¡ŒTensorFlow 1.15ï¼Œå¹¶å……åˆ†åˆ©ç”¨ä½ çš„NVIDIA GPUè¿›è¡ŒåŠ é€Ÿã€‚å°†ä»å®‰è£…Dockerå’ŒNVIDIAæ”¯æŒå¼€å§‹ï¼Œé€æ­¥å¼•å¯¼å®Œæˆæ•´ä¸ªè¿‡ç¨‹ã€‚\næç®€å™è¿°\nå®‰è£…Docker Desktop for Windowsã€‚\nå®‰è£…NVIDIA GPUé©±åŠ¨ç¨‹åºï¼Œç¡®ä¿ç³»ç»Ÿæ”¯æŒCUDAã€‚\næ‹‰å–Dockeré•œåƒ, &gt;&gt; docker pull tensorflow/tensorflow:1.15.0-gpu-py3\nå¯åŠ¨Dockerï¼Œ&gt;&gt; docker run --gpus all -it --rm tensorflow/tensorflow:1.15.0-gpu-py3 bash\nç¡®è®¤Dockerå†…CUDAå’ŒcuDNNï¼Œ&gt;&gt; nvcc -V\næ£€æŸ¥GPUå¯ç”¨ï¼Œ &gt;&gt; python -c â€œimport tensorflow as tf; devices = tf.config.experimental.list_physical_devices(â€˜GPUâ€™); print(devices)â€\nè¾“å‡ºä¸ºä½ çš„ç”µè„‘çš„GPUæ•°ç›®å³å¯ã€‚\n!!!è¯¥æ–¹æ³•å¹¶ä¸èƒ½å¤Ÿè§£å†³ç¼–è¯‘é™æ€graphæ—¶å€™å¡ä½çš„é—®é¢˜\n\n\n\nè¯¦ç»†å±•å¼€ä¸ç‰¹æ®Šæƒ…å†µæ­¥éª¤1ï¼šå®‰è£…Dockerå’ŒNVIDIA Dockeræ”¯æŒ\nå®‰è£…Docker Desktop for Windows\n\nä¸‹è½½å¹¶å®‰è£… Docker Desktop&lt;â€”ç‚¹å‡»è¿›å…¥ï¼Œé€‰æ‹©è‡ªå·±çš„æœºå™¨å¯¹åº”çš„å‹å·ï¼ˆé€šå¸¸Windowså¸¦äº†Nvidiaçš„GPUçš„ç¬”è®°æœ¬éƒ½æ˜¯AMD64ï¼‰ã€‚\nå¯åŠ¨Dockerå¹¶ç¡®ä¿å®ƒåœ¨åå°è¿è¡Œã€‚docker --version\nè¾“å‡ºç†åº”æ ¼å¼å¦‚ä¸‹ï¼šDocker version 20.10.17, build 100c701\n\n\n\nå®‰è£…NVIDIAé©±åŠ¨ç¨‹åºå’ŒCUDAæ”¯æŒ\n\nç¡®ä¿å®‰è£…äº†æœ€æ–°ç‰ˆæœ¬çš„ NVIDIA GPUé©±åŠ¨ç¨‹åº&lt;â€”ç‚¹å‡»è¿›å…¥ï¼Œé€‰æ‹©è‡ªå·±çš„æœºå™¨å¯¹åº”çš„å‹å·ã€‚\\staråªæ˜¯ä¸ºäº†èƒ½å¤Ÿè¿è¡ŒæŸ¥çœ‹å½“å‰çš„æœºå™¨æ˜¯ä¸æ˜¯æœ‰GPUï¼ï¼å¦‚æœæ²¡æœ‰è¯·æŒ‰ç…§æ­£å¸¸çš„tensorflow(é»˜è®¤cpuç‰ˆæœ¬)å®‰è£…å°±å¯ä»¥ã€‚åœ¨Windowsæœ¬æœºç¯å¢ƒä¸‹è¿è¡Œnvidia-smi\nè¾“å‡ºç†åº”æ ¼å¼å¦‚ä¸‹ï¼š+-----------------------------------------------------------------------------------------+| NVIDIA-SMI 566.14                 Driver Version: 566.14         CUDA Version: 12.7     ||-----------------------------------------+------------------------+----------------------+| GPU  Name                  Driver-Model | Bus-Id          Disp.A | Volatile Uncorr. ECC || Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. ||                                         |                        |               MIG M. ||=========================================+========================+======================||   0  NVIDIA GeForce RTX 4060 ...  WDDM  |   00000000:01:00.0  On |                  N/A || N/A   49C    P4              8W /  109W |    2301MiB /   8188MiB |      2%      Default ||                                         |                        |                  N/A |+-----------------------------------------+------------------------+----------------------++-----------------------------------------------------------------------------------------+| Processes:                                                                              ||  GPU   GI   CI        PID   Type   Process name                              GPU Memory ||        ID   ID                                                               Usage      ||=========================================================================================||    0   N/A  N/A      ...    C+G   D:\\Microsoft VS Code\\Code.exe                N/A      ||    ...   N/A  N/A      ...    ...   ...      ...                                         |+-----------------------------------------------------------------------------------------+\n\n\n\n\næ­¥éª¤2ï¼šæ‹‰å–Dockeré•œåƒ\næ‰“å¼€å‘½ä»¤è¡Œå·¥å…·å¹¶è¿è¡Œä»¥ä¸‹å‘½ä»¤æ¥è·å¾—dockeré•œåƒï¼š\n docker pull tensorflow/tensorflow:1.15.0-gpu-py3\n æ³¨æ„ï¼šå…¶ä¸­çš„æ ¼å¼ä¸ºdocker pull tensorflow/tensorflow:1.xx-suffix_1-suffix_2 å…¶ä¸­ï¼Œtensorflow:1.xx-suffix_1ï¼Œè¡¨ç¤ºéœ€è¦çš„ç‰ˆæœ¬ï¼Œsuffix_1ä¸€èˆ¬æ·»åŠ gpuï¼ˆä¸ç„¶ä½ æ¥çœ‹è¿™å¹²å•¥å‘¢æ˜¯å§ï¼‰ å…¶æ¬¡ï¼Œ-suffix_2å¯ä»¥çœç•¥ï¼Œç”±äºå…¶é»˜è®¤çš„ä¸‹è½½æ˜¯ç”±Python2ä¸­çš„tensorflowåŒ…ï¼Œæ˜¯ç”±Python2ï¼ˆe.g. 2.7.15+ï¼‰ç‰ˆæœ¬ç¼–è¯‘çš„å¯¹äºéœ€è¦é¢å¤–çš„Python3çš„è¯­æ³•é¡¹ç›®å­˜åœ¨éƒ¨åˆ†å†²çªï¼Œæ‰€ä»¥å»ºè®®æ·»åŠ æ­¤é¡¹ä¸º-py3ã€‚\n\nç­‰å¾…ä¸‹è½½å®Œæˆåï¼Œè¿è¡ŒDockerçš„é•œåƒï¼š\n docker run --gpus all -it --rm tensorflow/tensorflow:1.15.0-gpu-py3 bash\n\n\næ­¥éª¤3ï¼šæ‹‰å–TensorFlowé•œåƒæ‹‰å–é€‚ç”¨äºPython 3ç¯å¢ƒçš„TensorFlow 1.15 GPUé•œåƒï¼š\ndocker pull tensorflow/tensorflow:1.15.0-gpu-py3\nè¾“å‡ºå¤§è‡´ä¸ºï¼š________                               __________________  __/__________________________________  ____/__  /________      ____  /  _  _ \\_  __ \\_  ___/  __ \\_  ___/_  /_   __  /_  __ \\_ | /| / /_  /   /  __/  / / /(__  )/ /_/ /  /   _  __/   _  / / /_/ /_ |/ |/ //_/    \\___//_/ /_//____/ \\____//_/    /_/      /_/  \\____/____/|__/WARNING: You are running this container as root, which can cause new files inmounted volumes to be created as the root user on your host machine.To avoid this, run the container by specifying your user&#x27;s userid:$ docker run -u $(id -u):$(id -g) args...root@container_id:/# **åç»­çš„æ‰€æœ‰çš„ä»£ç è¿è¡Œä½ç½®ï¼Œè¾“å…¥Ctrl^Dæ¨å‡ºdockeré•œåƒè¿™æ—¶å€™å·²ç»åœ¨é•œåƒå†…äº†ï¼Œä¸€åˆ‡æ ¼å¼éƒ½ä¸Linuxä¿æŒä¸€è‡´è¿è¡Œpython -c &quot;import tensorflow as tf; devices = tf.config.experimental.list_physical_devices(&#x27;GPU&#x27;); print(devices)&quot;ç†åº”è¾“å‡ºæœ€åè¡Œæ ¼å¼å¦‚ä¸‹ï¼š...blablabla2025-01-21 13:57:35.258965: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0[PhysicalDevice(name=&#x27;/physical_device:GPU:0&#x27;, device_type=&#x27;GPU&#x27;)]gpuç¼–å·å’Œåˆ—è¡¨ç¼–å·ä¸€è‡´ä»0å¼€å§‹ï¼Œå³è¯´æ˜æˆåŠŸå•¦ï¼\n","tags":["ENV"]},{"title":"Brief Reinforcement Learning 01 - Proximal Policy Optimization (PPO) ç®€å•ç†è§£è¿‘ç«¯ç­–ç•¥ä¼˜åŒ–","url":"/2025/07/30/insight/RL/PPO/","content":"å†™åœ¨å‰é¢PPO åŸæ–‡: https://arxiv.org/abs/1707.06347TRPO åŸæ–‡: https://arxiv.org/abs/1502.05477\nç›®å½•\nå¼ºåŒ–å­¦ä¹ åŸºç¡€æ¦‚å¿µ\nç­–ç•¥ (Policy)\nåŠ¨ä½œ (Action)\nå¥–åŠ± (Reward)\nè½¨è¿¹ (Trajectory)\nä»·å€¼å‡½æ•° (Value Function) ä¸ Critic\næ¼”å‘˜ (Actor)\nä¼˜åŠ¿å‡½æ•° (Advantage Function)\n\n\nä» Q-Learning åˆ° Policy Gradient\nPPO æ˜¯ä»€ä¹ˆï¼Ÿ\nPPO æµç¨‹ç¤ºæ„å›¾\nPPO çš„æ ¸å¿ƒæ€æƒ³\nPPO çš„ç›®æ ‡å‡½æ•° (Objective Function)\n\n\nPPO ç®—æ³•è¯¦è§£\nClipped Surrogate Objective Function\nå¤šè½®æ¬¡æ›´æ–° (Multiple Epochs of Minibatch Updates)\nPPO ç®—æ³•æµç¨‹\n\n\nå®ä¾‹ï¼šç”¨ PPO ç©è½¬çŸ³å¤´å‰ªåˆ€å¸ƒ\nç¯å¢ƒè®¾å®š\næ¨¡å‹è®¾è®¡\nè®­ç»ƒè¿‡ç¨‹\nç»“æœ\n\n\né™„å½•ï¼šæ•°å­¦æ¨å¯¼\nç­–ç•¥æ¢¯åº¦å®šç†æ¨å¯¼\nä¿¡èµ–åŸŸæ–¹æ³•æ¨å¯¼\n\n\n\n\nå¼ºåŒ–å­¦ä¹ åŸºç¡€æ¦‚å¿µåœ¨æ·±å…¥ PPO ä¹‹å‰ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦ç†è§£ä¸€äº›å¼ºåŒ–å­¦ä¹ ï¼ˆReinforcement Learning, RLï¼‰çš„åŸºæœ¬æ„å»ºå—ã€‚æƒ³è±¡ä¸€ä¸ªæ™ºèƒ½ä½“ï¼ˆAgentï¼‰åœ¨ä¸€ä¸ªç¯å¢ƒï¼ˆEnvironmentï¼‰ä¸­å­¦ä¹ ï¼Œå®ƒé€šè¿‡ä¸æ–­åœ°è¯•é”™æ¥æœ€å¤§åŒ–è‡ªå·±è·å¾—çš„å¥–åŠ±ã€‚\n\nç­–ç•¥ (Policy): \\piç­–ç•¥æ˜¯æ™ºèƒ½ä½“çš„å¤§è„‘ï¼Œå®ƒå®šä¹‰äº†æ™ºèƒ½ä½“åœ¨ç‰¹å®šçŠ¶æ€ä¸‹ (s) ä¼šé‡‡å–ä»€ä¹ˆåŠ¨ä½œ (a)ã€‚ç­–ç•¥å¯ä»¥æœ‰ä¸¤ç§å½¢å¼ï¼š\n\nç¡®å®šæ€§ç­–ç•¥ (Deterministic Policy): a = Î¼(s)ï¼Œåœ¨æ¯ä¸ªçŠ¶æ€ä¸‹ï¼ŒåŠ¨ä½œæ˜¯ç¡®å®šçš„ã€‚\néšæœºæ€§ç­–ç•¥ (Stochastic Policy): Ï€(a|s) = P(A_t = a | S_t = s)ï¼Œåœ¨æ¯ä¸ªçŠ¶æ€ä¸‹ï¼Œç­–ç•¥ä¼šç»™å‡ºä¸€ä¸ªé‡‡å–å„ä¸ªåŠ¨ä½œçš„æ¦‚ç‡åˆ†å¸ƒã€‚PPO å¤„ç†çš„æ˜¯éšæœºæ€§ç­–ç•¥ã€‚\n\n\nåŠ¨ä½œ (Action): aæ™ºèƒ½ä½“æ ¹æ®å…¶ç­–ç•¥åœ¨ç¯å¢ƒä¸­æ‰§è¡Œçš„æ“ä½œã€‚ä¾‹å¦‚ï¼Œåœ¨æ¸¸æˆä¸­æ˜¯æŒ‰ä¸‹æŸä¸ªæŒ‰é’®ï¼Œåœ¨æœºå™¨äººæ§åˆ¶ä¸­æ˜¯ç§»åŠ¨æŸä¸ªå…³èŠ‚ã€‚\n\nå¥–åŠ± (Reward): rå½“æ™ºèƒ½ä½“æ‰§è¡Œä¸€ä¸ªåŠ¨ä½œåï¼Œç¯å¢ƒä¼šåé¦ˆä¸€ä¸ªæ ‡é‡ä¿¡å·â€”â€”å¥–åŠ±ã€‚è¿™ä¸ªä¿¡å·è¯„ä»·äº†è¿™ä¸ªåŠ¨ä½œçš„å¥½åã€‚æ™ºèƒ½ä½“çš„æœ€ç»ˆç›®æ ‡æ˜¯æœ€å¤§åŒ–ç´¯ç§¯å¥–åŠ±ï¼ˆCumulative Rewardï¼‰ã€‚\n\nè½¨è¿¹ (Trajectory): \\tauæ™ºèƒ½ä½“ä¸ç¯å¢ƒäº¤äº’äº§ç”Ÿçš„ä¸€ç³»åˆ—çŠ¶æ€ã€åŠ¨ä½œå’Œå¥–åŠ±çš„åºåˆ—ï¼Œå¯ä»¥è¡¨ç¤ºä¸º \\tau = (s_0, a_0, r_0, s_1, a_1, r_1, ...)ã€‚\n\nä»·å€¼å‡½æ•° (Value Function) ä¸ Criticä»·å€¼å‡½æ•°ç”¨æ¥è¯„ä¼°ä¸€ä¸ªçŠ¶æ€æˆ–ä¸€ä¸ªçŠ¶æ€-åŠ¨ä½œå¯¹çš„â€œå¥½åâ€ç¨‹åº¦ï¼Œå³ä»è¯¥ç‚¹å‡ºå‘ï¼Œé¢„æœŸæœªæ¥èƒ½è·å¾—å¤šå°‘æ€»å¥–åŠ±ã€‚\n\nçŠ¶æ€ä»·å€¼å‡½æ•° (State-Value Function) V^\\pi(s): ä»çŠ¶æ€ s å‡ºå‘ï¼Œéµå¾ªç­–ç•¥ \\piï¼Œæ‰€èƒ½è·å¾—çš„æœŸæœ›æ€»å›æŠ¥ã€‚\nåŠ¨ä½œä»·å€¼å‡½æ•° (Action-Value Function) Q^\\pi(s, a): åœ¨çŠ¶æ€ s ä¸‹ï¼Œæ‰§è¡ŒåŠ¨ä½œ aï¼Œç„¶åéµå¾ªç­–ç•¥ \\piï¼Œæ‰€èƒ½è·å¾—çš„æœŸæœ›æ€»å›æŠ¥ã€‚åœ¨ Actor-Critic æ¶æ„ä¸­ï¼ŒCriticï¼ˆè¯„è®ºå®¶ï¼‰ çš„è§’è‰²å°±æ˜¯å­¦ä¹ å¹¶è¾“å‡ºä»·å€¼å‡½æ•°ï¼Œå®ƒçš„ä½œç”¨æ˜¯â€œè¯„ä»·â€å½“å‰ Actor çš„è¡¨ç°å¥½åï¼Œä½†å®ƒè‡ªå·±ä¸å†³å®šåšä»€ä¹ˆåŠ¨ä½œã€‚\n\n\næ¼”å‘˜ (Actor)Actorï¼ˆæ¼”å‘˜ï¼‰ çš„è§’è‰²æ˜¯å­¦ä¹ å¹¶æ‰§è¡Œç­–ç•¥ \\piã€‚å®ƒæ ¹æ®å½“å‰çŠ¶æ€ sï¼Œå†³å®šè¦é‡‡å–å“ªä¸ªåŠ¨ä½œ aã€‚Actor çš„ç›®æ ‡æ˜¯è°ƒæ•´ç­–ç•¥ï¼Œä»¥è·å¾—æ›´é«˜çš„æ€»å›æŠ¥ã€‚\n\nä¼˜åŠ¿å‡½æ•° (Advantage Function): A^\\pi(s, a)ä¼˜åŠ¿å‡½æ•°æ˜¯è¡¡é‡åœ¨çŠ¶æ€ s ä¸‹ï¼Œé‡‡å–åŠ¨ä½œ a ç›¸å¯¹äºéµå¾ªå½“å‰ç­–ç•¥ \\pi çš„å¹³å‡è¡¨ç°æœ‰å¤šå¥½ã€‚å®ƒçš„è®¡ç®—å…¬å¼æ˜¯ï¼š\nA^\\pi(s, a) = Q^\\pi(s, a) - V^\\pi(s)\nå¦‚æœ A > 0, è¯´æ˜åŠ¨ä½œ a æ¯”å¹³å‡æ°´å¹³è¦å¥½ã€‚\nå¦‚æœ A < 0, è¯´æ˜åŠ¨ä½œ a æ¯”å¹³å‡æ°´å¹³è¦å·®ã€‚\n\n ä¼˜åŠ¿å‡½æ•°æ˜¯ PPO ç®—æ³•ä¸­çš„ä¸€ä¸ªæ ¸å¿ƒæ¦‚å¿µï¼Œå®ƒå‘Šè¯‰æˆ‘ä»¬ç­–ç•¥æ›´æ–°åº”è¯¥æœå“ªä¸ªæ–¹å‘è¿›è¡Œã€‚\n\n\nä» Q-Learning åˆ° Policy Gradientä¼ ç»Ÿçš„ Q-Learning æ˜¯ä¸€ç§åŸºäºä»·å€¼çš„æ–¹æ³•ã€‚å®ƒé€šè¿‡å­¦ä¹ ä¸€ä¸ªæœ€ä¼˜çš„åŠ¨ä½œä»·å€¼å‡½æ•° Q^*(s, a) æ¥é—´æ¥å¾—åˆ°æœ€ä¼˜ç­–ç•¥ã€‚å…¶ç­–ç•¥é€šå¸¸æ˜¯è´ªå©ªçš„ï¼šåœ¨çŠ¶æ€ s ä¸‹ï¼Œé€‰æ‹©ä½¿ Q(s, a) å€¼æœ€å¤§çš„åŠ¨ä½œ aã€‚è¿™ç§æ–¹æ³•åœ¨å¤„ç†è¿ç»­åŠ¨ä½œç©ºé—´æˆ–éœ€è¦éšæœºç­–ç•¥æ—¶ä¼šé‡åˆ°å›°éš¾ã€‚\nä¸ºäº†è§£å†³è¿™äº›é—®é¢˜ï¼Œç­–ç•¥æ¢¯åº¦ (Policy Gradient, PG) æ–¹æ³•åº”è¿è€Œç”Ÿã€‚PG ä¸å†å­¦ä¹ ä»·å€¼å‡½æ•°ï¼Œè€Œæ˜¯ç›´æ¥å¯¹ç­–ç•¥ \\pi_\\theta(a|s) è¿›è¡Œå‚æ•°åŒ–ï¼ˆ\\theta æ˜¯ç¥ç»ç½‘ç»œçš„å‚æ•°ï¼‰ï¼Œç„¶åé€šè¿‡æ¢¯åº¦ä¸Šå‡æ¥ä¼˜åŒ–ç­–ç•¥ï¼Œä»¥æœ€å¤§åŒ–æœŸæœ›æ€»å›æŠ¥ J(\\theta)ã€‚\nPG çš„æ ¸å¿ƒæ€æƒ³å¾ˆç®€å•ï¼šå¦‚æœä¸€ä¸ªåŠ¨ä½œå¸¦æ¥äº†å¥½çš„ç»“æœï¼ˆå³é«˜çš„ä¼˜åŠ¿å€¼ï¼‰ï¼Œæˆ‘ä»¬å°±å¢åŠ è¿™ä¸ªåŠ¨ä½œè¢«é€‰æ‹©çš„æ¦‚ç‡ï¼›åä¹‹ï¼Œåˆ™å‡å°‘ã€‚\nç„¶è€Œï¼Œæœ´ç´ çš„ PG ç®—æ³•å­˜åœ¨ä¸€äº›é—®é¢˜ï¼š\n\né«˜æ–¹å·®ï¼šæ¢¯åº¦çš„ä¼°è®¡å¯èƒ½éå¸¸ä¸ç¨³å®šï¼Œå¯¼è‡´è®­ç»ƒè¿‡ç¨‹éœ‡è¡ã€‚\næ›´æ–°æ­¥é•¿éš¾ä»¥ç¡®å®šï¼šå¦‚æœæ›´æ–°æ­¥é•¿ï¼ˆå­¦ä¹ ç‡ï¼‰å¤ªå¤§ï¼Œå¯èƒ½ä¼šå¯¼è‡´ç­–ç•¥â€œå´©æºƒâ€ï¼Œå³æ›´æ–°åçš„ç­–ç•¥è¡¨ç°æ€¥å‰§ä¸‹é™ï¼Œä¸”éš¾ä»¥æ¢å¤ã€‚å¦‚æœæ­¥é•¿å¤ªå°ï¼Œåˆ™è®­ç»ƒé€Ÿåº¦è¿‡æ…¢ã€‚\n\nPPO æ˜¯ä»€ä¹ˆï¼Ÿè¿‘ç«¯ç­–ç•¥ä¼˜åŒ– (Proximal Policy Optimization, PPO) æ˜¯ä¸€ç§æ—¨åœ¨è§£å†³ç­–ç•¥æ¢¯åº¦æ–¹æ³•ä¸­æ›´æ–°æ­¥é•¿é—®é¢˜çš„ç®—æ³•ã€‚å®ƒæ˜¯å¯¹ ä¿¡èµ–åŸŸç­–ç•¥ä¼˜åŒ– (Trust Region Policy Optimization, TRPO) çš„ä¸€ç§ç®€åŒ–ï¼Œåœ¨å®ç°ä¸Šæ›´ç®€å•ï¼Œä½†æ•ˆæœåŒæ ·å‡ºè‰²ã€‚\nPPO æµç¨‹ç¤ºæ„å›¾ä¸‹é¢æ˜¯ä¸€ä¸ªç®€åŒ–çš„ PPO å·¥ä½œæµç¨‹å›¾ï¼š\ngraph TD    A[Actor: Ï€_Î¸_old] -- &quot;ä¸ç¯å¢ƒäº¤äº’&quot; --&gt; B(æ”¶é›†è½¨è¿¹ Ï„);    B -- &quot;è®¡ç®—æ¯ä¸ªæ—¶é—´æ­¥çš„ä¼˜åŠ¿ A_t&quot; --&gt; C;    C[Critic: V_Ï†] -- &quot;è®¡ç®—V(s_t)è¾…åŠ©è®¡ç®—A_t&quot; --&gt; B;    B -- &quot;å°†(s_t, a_t, A_t)å­˜å…¥ç¼“å†²åŒº&quot; --&gt; D(ç»éªŒç¼“å†²åŒº);    D -- &quot;é‡å¤Kä¸ªEpoch&quot; --&gt; E&#123;ä¼˜åŒ–å¾ªç¯&#125;;    E -- &quot;é‡‡æ ·ä¸€ä¸ªMinibatch&quot; --&gt; F(è®¡ç®—PPOç›®æ ‡å‡½æ•° L_CLIP);    F -- &quot;è®¡ç®—æ¢¯åº¦ âˆ‡_Î¸ L_CLIP&quot; --&gt; G(æ›´æ–°Actorç½‘ç»œå‚æ•° Î¸);    E -- &quot;é‡‡æ ·ä¸€ä¸ªMinibatch&quot; --&gt; H(è®¡ç®—ä»·å€¼æŸå¤± L_VF);    H -- &quot;è®¡ç®—æ¢¯åº¦ âˆ‡_Ï† L_VF&quot; --&gt; I(æ›´æ–°Criticç½‘ç»œå‚æ•° Ï†);    G &amp; I -- &quot;Kä¸ªEpochç»“æŸå&quot; --&gt; J[æ–°ç­–ç•¥ Ï€_Î¸];    J -- &quot;Ï€_Î¸_old â† Ï€_Î¸&quot; --&gt; A;\nPPO çš„æ ¸å¿ƒæ€æƒ³PPO çš„æ ¸å¿ƒæ€æƒ³æ˜¯ï¼šåœ¨å°è¯•æœ€å¤§åŒ–ç›®æ ‡å‡½æ•°çš„åŒæ—¶ï¼Œä½¿ç”¨ä¸€ä¸ªâ€œæƒ©ç½šâ€é¡¹æ¥é™åˆ¶æ–°æ—§ç­–ç•¥ä¹‹é—´çš„å·®å¼‚ï¼Œç¡®ä¿æ¯æ¬¡æ›´æ–°ä¸ä¼šè®©ç­–ç•¥å˜å¾—å¤ªç¦»è°±ã€‚\næƒ³è±¡ä¸€ä¸‹ä½ åœ¨ä¸€ä¸ªå±±å¡ä¸Šè¯•å›¾èµ°åˆ°å±±é¡¶ï¼ˆæœ€å¤§åŒ–å¥–åŠ±ï¼‰ã€‚æœ´ç´ çš„ PG æ–¹æ³•å°±åƒæ˜¯ä½ è’™ç€çœ¼ç›æœä½ è®¤ä¸ºæœ€é™¡å³­çš„æ–¹å‘è¿ˆå‡ºä¸€å¤§æ­¥ï¼Œä½†ä½ å¯èƒ½ä¼šä¸å°å¿ƒæ»šä¸‹æ‚¬å´–ï¼ˆç­–ç•¥å´©æºƒï¼‰ã€‚PPO åˆ™æ˜¯åœ¨ä½ è„šä¸Šç»‘äº†ä¸€æ ¹ç»³å­ï¼Œç»³å­çš„å¦ä¸€ç«¯å›ºå®šåœ¨ä½ ä¹‹å‰çš„ä½ç½®ã€‚ä½ å¯ä»¥è‡ªç”±åœ°å‘ä»»ä½•æ–¹å‘è¿ˆæ­¥ï¼Œä½†å¦‚æœæ­¥å­è¿ˆå¾—å¤ªå¤§ï¼Œç»³å­å°±ä¼šæŠŠä½ æ‹‰å›æ¥ï¼Œé˜²æ­¢ä½ æ‘”å¾—å¤ªè¿œã€‚\nè¿™ä¸ªâ€œç»³å­â€å°±æ˜¯ PPO ä¸­çš„ Clipping (è£å‰ª) æœºåˆ¶ã€‚\nPPO çš„ç›®æ ‡å‡½æ•° (Objective Function)PPO çš„ç›®æ ‡å‡½æ•°æ˜¯å…¶ç²¾é«“æ‰€åœ¨ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹æœ€å¸¸ç”¨çš„ PPO-Clip çš„ç›®æ ‡å‡½æ•°ï¼š\nL^{CLIP}(\\theta) = \\hat{\\mathbb{E}}_t \\left[ \\min\\left( r_t(\\theta) \\hat{A}_t, \\text{clip}(r_t(\\theta), 1 - \\epsilon, 1 + \\epsilon) \\hat{A}_t \\right) \\right]r_t(\\theta) = \\frac{\\pi_\\theta(a_t | s_t)}{\\pi_{\\theta_{\\text{old}}}(a_t | s_t)}è®©æˆ‘ä»¬æ¥æ‹†è§£è¿™ä¸ªå¤æ‚çš„å…¬å¼ï¼š\n\n\\hat{\\mathbb{E}}_t[...]: è¡¨ç¤ºå¯¹ä¸€ä¸ªæ‰¹æ¬¡ï¼ˆbatchï¼‰ä¸­æ‰€æœ‰æ—¶é—´æ­¥ t çš„æ ·æœ¬å–å¹³å‡ã€‚\nr_t(\\theta): è¿™æ˜¯æ–°æ—§ç­–ç•¥ä¹‹é—´çš„æ¦‚ç‡æ¯”ç‡ (probability ratio)ã€‚\n\\pi_\\theta(a_t | s_t): å½“å‰æ­£åœ¨ä¼˜åŒ–çš„æ–°ç­–ç•¥ã€‚\n\\pi_{\\theta_{\\text{old}}}(a_t | s_t): ç”¨äºæ”¶é›†æ•°æ®çš„æ—§ç­–ç•¥ã€‚\nå¦‚æœ r_t(\\theta) > 1, è¯´æ˜æ–°ç­–ç•¥æ›´å€¾å‘äºé‡‡å–åŠ¨ä½œ a_tã€‚\nå¦‚æœ r_t(\\theta) < 1, è¯´æ˜æ–°ç­–ç•¥ä¸å¤ªå€¾å‘äºé‡‡å–åŠ¨ä½œ a_tã€‚\n\n\n\\hat{A}_t: è¿™æ˜¯åœ¨æ—¶é—´æ­¥ t çš„ä¼˜åŠ¿å‡½æ•° Advantage çš„ä¼°è®¡å€¼ã€‚\n\\text{clip}(r_t(\\theta), 1 - \\epsilon, 1 + \\epsilon) : è¿™ä¸ªå‡½æ•°å°†æ¦‚ç‡æ¯”ç‡ r_t(\\theta) è£å‰ªåˆ°ä¸€ä¸ªèŒƒå›´ [1 - \\epsilon, 1 + \\epsilon] å†…ã€‚\\epsilon æ˜¯ä¸€ä¸ªè¶…å‚æ•°ï¼Œé€šå¸¸å– 0.1 æˆ– 0.2ã€‚\n\\min(...): PPO çš„å…³é”®éƒ¨åˆ†ã€‚å®ƒåœ¨ä¸¤ä¸ªé¡¹ä¹‹é—´å–æœ€å°å€¼ã€‚\n\nPPO ç®—æ³•è¯¦è§£Clipped Surrogate Objective Functionæˆ‘ä»¬æ¥è¯¦ç»†åˆ†æ \\min å‡½æ•°ä¸­çš„ä¸¤é¡¹ï¼š\n\nr_t(\\theta) \\hat{A}_t: è¿™æ˜¯æ ‡å‡†çš„ç­–ç•¥æ¢¯åº¦ç›®æ ‡å‡½æ•°ã€‚å¦‚æœä¼˜åŠ¿ \\hat{A}_t æ˜¯æ­£çš„ï¼Œæˆ‘ä»¬ä¼šæƒ³è¦å¢å¤§ r_t(\\theta)ï¼ˆå³å¢åŠ  \\pi_\\theta(a_t|s_t)ï¼‰ï¼Œä»è€Œæœ€å¤§åŒ–è¿™ä¸€é¡¹ã€‚å¦‚æœ \\hat{A}_t æ˜¯è´Ÿçš„ï¼Œæˆ‘ä»¬ä¼šæƒ³è¦å‡å° r_t(\\theta)ã€‚\n\n\\text{clip}(r_t(\\theta), 1 - \\epsilon, 1 + \\epsilon) \\hat{A}_t: è¿™æ˜¯è¢«è£å‰ªè¿‡çš„ç‰ˆæœ¬ï¼Œæ˜¯ PPO çš„åˆ›æ–°ä¹‹å¤„ã€‚\n\n\nä¸ºä»€ä¹ˆè¦å– \\minï¼Ÿ\nè¿™æ˜¯ä¸€ç§æ‚²è§‚ä¸»ä¹‰çš„æˆ–è€…è¯´ä¿å®ˆçš„æ›´æ–°æ–¹å¼ã€‚\n\nå½“ \\hat{A}_t > 0 (å¥½åŠ¨ä½œ) æ—¶:\nL^{CLIP} = \\hat{\\mathbb{E}}_t \\left[ \\min(r_t(\\theta), 1 + \\epsilon) \\hat{A}_t \\right]è¿™æ„å‘³ç€ï¼Œæˆ‘ä»¬å¸Œæœ›å¢åŠ å¥½åŠ¨ä½œçš„æ¦‚ç‡ (r_t(\\theta) å˜å¤§)ï¼Œä½†æ˜¯è¿™ä¸ªå¢åŠ æ˜¯æœ‰é™åº¦çš„ã€‚r_t(\\theta) æœ€å¤šåªèƒ½å¢é•¿åˆ° 1+\\epsilonã€‚è¿™é˜²æ­¢äº†ç­–ç•¥å› ä¸ºä¸€ä¸ªç‰¹åˆ«å¥½çš„åŠ¨ä½œè€Œè¿‡åº¦æ›´æ–°ï¼Œå¯¼è‡´åœ¨å…¶ä»–çŠ¶æ€ä¸‹è¡¨ç°å˜å·®ã€‚\n\nå½“ \\hat{A}_t < 0 (ååŠ¨ä½œ) æ—¶:\nL^{CLIP} = \\hat{\\mathbb{E}}_t \\left[ \\max(r_t(\\theta), 1 - \\epsilon) \\hat{A}_t \\right](æ³¨æ„ï¼Œå› ä¸º \\hat{A}_t æ˜¯è´Ÿæ•°ï¼Œ\\min å®é™…ä¸Šå˜æˆäº† \\maxï¼‰ã€‚è¿™æ„å‘³ç€ï¼Œæˆ‘ä»¬å¸Œæœ›å‡å°ååŠ¨ä½œçš„æ¦‚ç‡ (r_t(\\theta) å˜å°)ï¼Œä½†è¿™ä¸ªå‡å°ä¹Ÿæ˜¯æœ‰é™åº¦çš„ã€‚r_t(\\theta) æœ€å°‘åªèƒ½å‡å°åˆ° 1-\\epsilonã€‚è¿™é˜²æ­¢äº†ç­–ç•¥å› ä¸ºä¸€ä¸ªååŠ¨ä½œè€Œè¿‡åº¦æƒ©ç½šï¼Œå¯¼è‡´ç­–ç•¥å®Œå…¨æ”¾å¼ƒæ¢ç´¢æŸäº›å¯èƒ½åœ¨æœªæ¥æœ‰ä»·å€¼çš„åŠ¨ä½œã€‚\n\n\né€šè¿‡è¿™ç§æ–¹å¼ï¼ŒPPO å°†ç­–ç•¥æ›´æ–°é™åˆ¶åœ¨äº†ä¸€ä¸ªâ€œä¿¡èµ–åŸŸâ€å†…ï¼Œä½¿å¾—è®­ç»ƒè¿‡ç¨‹æ›´åŠ ç¨³å®šã€‚\nå¤šè½®æ¬¡æ›´æ–° (Multiple Epochs of Minibatch Updates)PPO çš„å¦ä¸€ä¸ªé‡è¦ç‰¹ç‚¹æ˜¯å®ƒå¯ä»¥åœ¨åŒä¸€æ‰¹æ•°æ®ä¸Šè¿›è¡Œå¤šæ¬¡ï¼ˆKä¸ªEpochï¼‰çš„æ¢¯åº¦æ›´æ–°ã€‚è¿™å¤§å¤§æé«˜äº†æ ·æœ¬çš„åˆ©ç”¨æ•ˆç‡ã€‚ä¼ ç»Ÿçš„ A2C (Advantage Actor-Critic) ç®—æ³•æ¯æ”¶é›†ä¸€æ‰¹æ•°æ®åªèƒ½æ›´æ–°ä¸€æ¬¡ç½‘ç»œï¼Œè€Œ PPO å¯ä»¥ç”¨è¿™æ‰¹æ•°æ®è®­ç»ƒå¥½å‡ ä¸ª Epochï¼Œåªè¦ç­–ç•¥æ›´æ–°ä¸åç¦»æ—§ç­–ç•¥å¤ªè¿œï¼ˆç”± Clip æœºåˆ¶ä¿è¯ï¼‰ã€‚\nPPO ç®—æ³•æµç¨‹ä¸‹é¢æ˜¯ PPO ç®—æ³•æ›´å…·ä½“çš„ä¼ªä»£ç ï¼š\n\nåˆå§‹åŒ–: åˆå§‹åŒ– Actor ç½‘ç»œ \\pi_\\theta å’Œ Critic ç½‘ç»œ V_\\phi çš„å‚æ•° \\theta, \\phiã€‚\nå¾ªç¯ (for iteration = 1, 2, â€¦):a.  æ•°æ®æ”¶é›†: ä½¿ç”¨å½“å‰ç­–ç•¥ \\pi_{\\theta_{\\text{old}}} \\leftarrow \\pi_\\thetaï¼Œä¸ç¯å¢ƒäº¤äº’ N ä¸ªæ—¶é—´æ­¥ï¼Œæ”¶é›†ä¸€æ‰¹è½¨è¿¹ \\mathcal{D} = \\{\\tau_i\\}ã€‚b.  ä¼˜åŠ¿è®¡ç®—: å¯¹æ”¶é›†åˆ°çš„æ¯ä¸ªæ—¶é—´æ­¥ tï¼Œè®¡ç®—ä¼˜åŠ¿å‡½æ•° \\hat{A}_tã€‚é€šå¸¸ä½¿ç”¨ GAE (Generalized Advantage Estimation) æ–¹æ³•æ¥å¹³è¡¡åå·®å’Œæ–¹å·®ã€‚\n\\hat{A}_t = \\delta_t + (\\gamma\\lambda)\\delta_{t+1} + ... + (\\gamma\\lambda)^{T-t+1}\\delta_{T-1}å…¶ä¸­ \\delta_t = r_t + \\gamma V(s_{t+1}) - V(s_t)c.  ä¼˜åŒ–å¾ªç¯ (for epoch = 1, 2, â€¦, K):\n\nä» \\mathcal{D} ä¸­éšæœºé‡‡æ ·ä¸€ä¸ªå°æ‰¹é‡ï¼ˆMinibatchï¼‰æ•°æ®ã€‚\nè®¡ç®— Actor çš„æŸå¤± L^{CLIP}(\\theta)ã€‚\nè®¡ç®— Critic çš„æŸå¤± L^{VF}(\\phi) = ||(V_\\phi(s_t) - V_t^{\\text{target}}||^2_2 (å‡æ–¹è¯¯å·®)ã€‚V_t^{\\text{target}} é€šå¸¸æ˜¯ \\hat{A}_t + V_\\phi(s_t)ã€‚\nï¼ˆå¯é€‰ï¼‰è®¡ç®—ç†µæŸå¤± S[\\pi_\\theta](s_t)ï¼Œé¼“åŠ±æ¢ç´¢ã€‚\næ›´æ–° Actor å’Œ Critic çš„ç½‘ç»œå‚æ•°ï¼š\n\n\\theta \\leftarrow \\theta - \\alpha_\\theta \\nabla_\\theta (L^{CLIP} - c_1 L^{VF} + c_2 S)\\phi \\leftarrow \\phi - \\alpha_\\phi \\nabla_\\phi L^{VF}\nç»“æŸ\n\nå®ä¾‹ï¼šç”¨ PPO ç©çŸ³å¤´å‰ªåˆ€å¸ƒè®©æˆ‘ä»¬çœ‹ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼šè®­ç»ƒä¸€ä¸ª AI æ¥ç©çŸ³å¤´å‰ªåˆ€å¸ƒã€‚\nç¯å¢ƒè®¾å®š\nå¯¹æ‰‹: ä¸æ˜¯å®Œå…¨éšæœºçš„ï¼Œè€Œæ˜¯ä¸€ä¸ªæœ‰ç‰¹å®šåå¥½çš„å¯¹æ‰‹ã€‚æ¯”å¦‚ï¼Œä»–å‡ºâ€œçŸ³å¤´â€çš„æ¦‚ç‡æ˜¯ 50%ï¼Œå‡ºâ€œå‰ªåˆ€â€å’Œâ€œå¸ƒâ€çš„æ¦‚ç‡å„æ˜¯ 25%ã€‚\nçŠ¶æ€ (State): ä¸ºäº†ç®€å•èµ·è§ï¼Œæˆ‘ä»¬å¯ä»¥å°†çŠ¶æ€è®¾ä¸ºå¯¹æ‰‹ä¸Šä¸€æ¬¡å‡ºçš„æ‰‹åŠ¿ã€‚å¦‚æœæ¸¸æˆæ˜¯ç‹¬ç«‹çš„ï¼ŒçŠ¶æ€ä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªå¸¸æ•°ã€‚\nåŠ¨ä½œ (Action): æˆ‘ä»¬çš„ AI å¯ä»¥é€‰æ‹©å‡ºâ€œçŸ³å¤´â€(0)ã€â€œå‰ªåˆ€â€(1) æˆ–â€œå¸ƒâ€(2)ã€‚\nå¥–åŠ± (Reward):\nèµ¢: +1\nå¹³: 0\nè¾“: -1\n\n\n\næ¨¡å‹è®¾è®¡\nActor: ä¸€ä¸ªç®€å•çš„ç¥ç»ç½‘ç»œã€‚è¾“å…¥æ˜¯çŠ¶æ€ï¼ˆå¯¹æ‰‹ä¸Šä¸€æ¬¡çš„æ‰‹åŠ¿ï¼Œç‹¬çƒ­ç¼–ç ï¼‰ï¼Œè¾“å‡ºæ˜¯ä¸‰ä¸ªåŠ¨ä½œï¼ˆçŸ³å¤´ã€å‰ªåˆ€ã€å¸ƒï¼‰çš„æ¦‚ç‡åˆ†å¸ƒï¼ˆé€šè¿‡ Softmax å±‚ï¼‰ã€‚\nCritic: å¦ä¸€ä¸ªç®€å•çš„ç¥ç»ç½‘ç»œã€‚è¾“å…¥æ˜¯çŠ¶æ€ï¼Œè¾“å‡ºæ˜¯ä¸€ä¸ªæ ‡é‡ï¼Œä»£è¡¨å½“å‰çŠ¶æ€çš„ä»·å€¼ V(s)ã€‚\n\nè®­ç»ƒè¿‡ç¨‹\nåˆå§‹åŒ–: éšæœºåˆå§‹åŒ– Actor å’Œ Critic ç½‘ç»œçš„æƒé‡ã€‚æˆ‘ä»¬çš„ AI ä¸€å¼€å§‹æ˜¯èƒ¡ä¹±å‡ºæ‹³çš„ã€‚\næ”¶é›†æ•°æ®: è®©æˆ‘ä»¬çš„ AI (Actor) å’Œæœ‰åå¥½çš„å¯¹æ‰‹ç©ï¼Œæ¯”å¦‚ç© 100 å±€ã€‚è®°å½•ä¸‹æ¯ä¸€å±€çš„çŠ¶æ€ã€æˆ‘ä»¬å‡ºçš„åŠ¨ä½œã€ä»¥åŠè·å¾—çš„å›æŠ¥ã€‚ä¾‹å¦‚ï¼Œè®°å½• (s_t= å¯¹æ‰‹å‡ºçŸ³å¤´ , a_t= æˆ‘å‡ºå‰ªåˆ€, r_t= -1)ã€‚\nè®¡ç®—ä¼˜åŠ¿:\nç”¨ Critic ç½‘ç»œé¢„æµ‹æ¯ä¸€å±€å¼€å§‹æ—¶çš„çŠ¶æ€ä»·å€¼ V(s_t)ã€‚\nå› ä¸ºçŸ³å¤´å‰ªåˆ€å¸ƒæ˜¯å•æ­¥æ¸¸æˆï¼Œä¼˜åŠ¿å‡½æ•°å¯ä»¥ç®€åŒ–ä¸º A_t = r_t - V(s_t)ã€‚\nä¾‹å¦‚ï¼Œåœ¨ s_tï¼ˆå¯¹æ‰‹ä¸ŠæŠŠå‡ºçŸ³å¤´ï¼‰æ—¶ï¼Œæˆ‘ä»¬å‡ºäº†â€œå¸ƒâ€èµ¢äº† (r_t=1)ã€‚å‡è®¾ Critic é¢„æµ‹ V(s_t)=0.1ã€‚é‚£ä¹ˆä¼˜åŠ¿ A_t = 1 - 0.1 = 0.9ã€‚è¿™æ˜¯ä¸€ä¸ªå¾ˆå¤§çš„æ­£ä¼˜åŠ¿ã€‚\n\n\nPPO æ›´æ–°:\næˆ‘ä»¬ä½¿ç”¨æ”¶é›†åˆ°çš„ 100 å±€æ•°æ®ï¼Œè¿›è¡Œå¤šè½®ï¼ˆæ¯”å¦‚ K=4ï¼‰ä¼˜åŒ–ã€‚\nåœ¨æ¯ä¸€è½®ä¸­ï¼Œæˆ‘ä»¬è®¡ç®— PPO çš„ L_CLIP æŸå¤±ã€‚\nå¯¹äºåˆšæ‰é‚£ä¸ªä¾‹å­ï¼Œå› ä¸º A_t=0.9 æ˜¯æ­£çš„ï¼Œç®—æ³•ä¼šå°è¯•æé«˜åœ¨ s_t çŠ¶æ€ä¸‹å‡ºâ€œå¸ƒâ€çš„æ¦‚ç‡ã€‚\nclip æœºåˆ¶ä¼šç¡®ä¿è¿™ä¸ªæ¦‚ç‡çš„æå‡ä¸ä¼šå¤ªå¤§ï¼Œæ¯”å¦‚ r_t ä¸ä¼šè¶…è¿‡ 1.2ã€‚\nåŒæ—¶ï¼Œæˆ‘ä»¬ä¹Ÿæ›´æ–° Critic ç½‘ç»œï¼Œè®©å®ƒçš„é¢„æµ‹ V(s_t) æ›´æ¥è¿‘å®é™…è·å¾—çš„å›æŠ¥ r_tã€‚\n\n\né‡å¤: ä¸æ–­åœ°é‡å¤æ­¥éª¤ 2-4ã€‚\n\nç»“æœç»è¿‡å¤šè½®è®­ç»ƒåï¼š\n\nActor ä¼šå­¦åˆ°ï¼Œå½“å¯¹æ‰‹æœ‰ 50% çš„æ¦‚ç‡å‡ºâ€œçŸ³å¤´â€æ—¶ï¼Œæˆ‘åº”è¯¥æé«˜å‡ºâ€œå¸ƒâ€çš„æ¦‚ç‡ï¼Œè¿™æ ·èƒœç‡æœ€é«˜ã€‚å®ƒçš„ç­–ç•¥ä¼šé€æ¸æ”¶æ•›åˆ°ä¸€ä¸ªæœ€ä¼˜è§£ï¼ˆé«˜æ¦‚ç‡å‡ºå¸ƒï¼‰ã€‚\nCritic ä¼šå­¦åˆ°ï¼Œåœ¨é¢å¯¹è¿™ä¸ªå¯¹æ‰‹æ—¶ï¼Œæ¸¸æˆçš„åˆå§‹çŠ¶æ€ä»·å€¼æ˜¯æ­£çš„ï¼Œå› ä¸ºæˆ‘ä»¬æœ‰ä¼˜åŠ¿ã€‚\n\nè¿™ä¸ªä¾‹å­å±•ç¤ºäº† PPO å¦‚ä½•é€šè¿‡ä¸ç¯å¢ƒäº¤äº’ï¼Œç¨³å®šåœ°å­¦ä¹ åˆ°ä¸€ä¸ªèƒ½åˆ©ç”¨ç¯å¢ƒç‰¹æ€§ï¼ˆå¯¹æ‰‹åå¥½ï¼‰çš„ç­–ç•¥ã€‚\n\né™„å½•ï¼šæ•°å­¦æ¨å¯¼è¿™é‡Œæä¾›äº†ä¸€äº›æ ¸å¿ƒæ¦‚å¿µçš„æ•°å­¦æ¨å¯¼ï¼Œä»¥ä¾›æ·±å…¥ç†è§£ã€‚\n[ç­–ç•¥æ¢¯åº¦å®šç†æ¨å¯¼]ç­–ç•¥æ¢¯åº¦å®šç†æ˜¯ç­–ç•¥æ¢¯åº¦æ–¹æ³•çš„åŸºç¡€ï¼Œå®ƒè¡¨æ˜äº†ç›®æ ‡å‡½æ•° J(\\theta) çš„æ¢¯åº¦å¯ä»¥è¢«å†™æˆä¸€ä¸ªæœŸæœ›çš„å½¢å¼ï¼Œä»è€Œå¯ä»¥ç”¨è’™ç‰¹å¡æ´›é‡‡æ ·æ¥ä¼°è®¡ã€‚æˆ‘ä»¬çš„ç›®æ ‡æ˜¯æ‰¾åˆ°èƒ½æœ€å¤§åŒ–æœŸæœ›æ€»å›æŠ¥ J(\\theta) çš„ç­–ç•¥å‚æ•° \\thetaã€‚\n1. ç›®æ ‡å‡½æ•°å®šä¹‰\né¦–å…ˆï¼Œæˆ‘ä»¬å®šä¹‰ç›®æ ‡å‡½æ•° J(\\theta) ä¸ºéµå¾ªç­–ç•¥ \\pi_\\theta æ—¶ï¼Œæ‰€æœ‰å¯èƒ½è½¨è¿¹ \\tau çš„æœŸæœ›æ€»å›æŠ¥ã€‚\nJ(\\theta) = \\mathbb{E}_{\\tau \\sim \\pi_\\theta} [R(\\tau)] = \\sum_{\\tau} P(\\tau|\\theta) R(\\tau)å…¶ä¸­ï¼ŒR(\\tau) = \\sum_{t=0}^{T} r(s_t, a_t) æ˜¯è½¨è¿¹ \\tau çš„æ€»å›æŠ¥ï¼ŒP(\\tau|\\theta) æ˜¯åœ¨å‚æ•°ä¸º \\theta çš„ç­–ç•¥ä¸‹ï¼Œè½¨è¿¹ \\tau å‘ç”Ÿçš„æ¦‚ç‡ã€‚\n2. æ±‚ç›®æ ‡å‡½æ•°çš„æ¢¯åº¦\næˆ‘ä»¬å¯¹ç›®æ ‡å‡½æ•°æ±‚å…³äº \\theta çš„æ¢¯åº¦ï¼š\n\\nabla_\\theta J(\\theta) = \\nabla_\\theta \\sum_{\\tau} P(\\tau|\\theta) R(\\tau) = \\sum_{\\tau} \\nabla_\\theta P(\\tau|\\theta) R(\\tau)3. åº”ç”¨å¯¹æ•°å¯¼æ•°æŠ€å·§ (Log-Derivative Trick)\nç›´æ¥è®¡ç®— \\nabla_\\theta P(\\tau|\\theta) å¾ˆå›°éš¾ã€‚è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªå…³é”®æŠ€å·§ï¼š\\nabla_x f(x) = f(x) \\nabla_x \\log f(x)ã€‚å°†å…¶åº”ç”¨åˆ° P(\\tau|\\theta) ä¸Šï¼š\n\\nabla_\\theta P(\\tau|\\theta) = P(\\tau|\\theta) \\nabla_\\theta \\log P(\\tau|\\theta)å°†è¿™ä¸ªæŠ€å·§ä»£å…¥æ¢¯åº¦å…¬å¼ä¸­ï¼š\n\\nabla_\\theta J(\\theta) = \\sum_{\\tau} P(\\tau|\\theta) \\nabla_\\theta \\log P(\\tau|\\theta) R(\\tau)è¿™ä¸ªå½¢å¼æ­£å¥½æ˜¯æŸä¸ªæœŸæœ›å€¼çš„å®šä¹‰ï¼Œæ‰€ä»¥å¯ä»¥å†™æˆï¼š\n\\nabla_\\theta J(\\theta) = \\mathbb{E}_{\\tau \\sim \\pi_\\theta} [\\nabla_\\theta \\log P(\\tau|\\theta) R(\\tau)]4. å±•å¼€è½¨è¿¹æ¦‚ç‡\nç°åœ¨æˆ‘ä»¬æ¥å¤„ç† \\log P(\\tau|\\theta)ã€‚ä¸€æ¡è½¨è¿¹çš„æ¦‚ç‡æ˜¯åˆå§‹çŠ¶æ€æ¦‚ç‡å’Œä¸€ç³»åˆ—åŠ¨ä½œæ¦‚ç‡ä¸çŠ¶æ€è½¬ç§»æ¦‚ç‡çš„ä¹˜ç§¯ï¼š\nP(\\tau|\\theta) = p(s_0) \\prod_{t=0}^{T} \\pi_\\theta(a_t|s_t) p(s_{t+1}|s_t, a_t)å¯¹å…¶å–å¯¹æ•°ï¼š\n\\log P(\\tau|\\theta) = \\log p(s_0) + \\sum_{t=0}^{T} \\left( \\log \\pi_\\theta(a_t|s_t) + \\log p(s_{t+1}|s_t, a_t) \\right)å†å¯¹å…¶æ±‚å…³äº \\theta çš„æ¢¯åº¦ã€‚æ³¨æ„åˆ°ï¼Œç¯å¢ƒçš„çŠ¶æ€è½¬ç§»æ¦‚ç‡ p(s_{t+1}|s_t, a_t) å’Œåˆå§‹çŠ¶æ€æ¦‚ç‡ p(s_0) éƒ½ä¸ç­–ç•¥å‚æ•° \\theta æ— å…³ï¼Œæ‰€ä»¥å®ƒä»¬çš„æ¢¯åº¦ä¸ºé›¶ã€‚å› æ­¤ï¼š\n\\nabla_\\theta \\log P(\\tau|\\theta) = \\sum_{t=0}^{T} \\nabla_\\theta \\log \\pi_\\theta(a_t|s_t)5. å¾—åˆ°ç­–ç•¥æ¢¯åº¦çš„åŸºæœ¬å½¢å¼\nå°†ä¸Šå¼ä»£å…¥ç¬¬3æ­¥çš„æœŸæœ›å…¬å¼ä¸­ï¼Œæˆ‘ä»¬å¾—åˆ°ï¼š\n\\nabla_\\theta J(\\theta) = \\mathbb{E}_{\\tau \\sim \\pi_\\theta} \\left[ \\left( \\sum_{t=0}^{T} \\nabla_\\theta \\log \\pi_\\theta(a_t|s_t) \\right) \\left( \\sum_{t=0}^{T} r(s_t, a_t) \\right) \\right]è¿™ä¸ªå…¬å¼è™½ç„¶æ­£ç¡®ï¼Œä½†æ–¹å·®å¾ˆå¤§ï¼Œå› ä¸ºæ‹¬å·é‡Œçš„å›æŠ¥é¡¹ R(\\tau) ä¼šåŒæ—¶ä¹˜ä»¥è¿‡å»å’Œæœªæ¥çš„æ‰€æœ‰åŠ¨ä½œçš„æ¢¯åº¦ã€‚\n6. åˆ©ç”¨å› æœå…³ç³»å¹¶å¼•å…¥åŸºçº¿ä»¥å‡å°æ–¹å·®\nä¸€ä¸ªé‡è¦çš„è§‚å¯Ÿæ˜¯ï¼šåœ¨æ—¶é—´æ­¥ t çš„å†³ç­– \\pi_\\theta(a_t|s_t) åªä¼šå½±å“ä» t æ—¶åˆ»å¼€å§‹çš„æœªæ¥å›æŠ¥ï¼Œè€Œä¸ä¼šå½±å“è¿‡å»å·²ç»è·å¾—çš„å›æŠ¥ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥å°†å›æŠ¥é¡¹æ›¿æ¢ä¸ºä»å½“å‰æ—¶åˆ»å¼€å§‹çš„æœªæ¥å›æŠ¥æ€»å’Œ G_t = \\sum_{t'=t}^{T} r(s_{t'}, a_{t'})ï¼š\n\\nabla_\\theta J(\\theta) = \\mathbb{E}_{\\tau \\sim \\pi_\\theta} \\left[ \\sum_{t=0}^{T} \\nabla_\\theta \\log \\pi_\\theta(a_t|s_t) G_t \\right]ä¸ºäº†è¿›ä¸€æ­¥å‡å°æ–¹å·®ï¼Œæˆ‘ä»¬å¯ä»¥ä»å›æŠ¥ä¸­å‡å»ä¸€ä¸ªä¸ä¾èµ–äºåŠ¨ä½œ a_t çš„åŸºçº¿ï¼ˆbaselineï¼‰b(s_t)ã€‚æœ€å¸¸ç”¨çš„åŸºçº¿æ˜¯çŠ¶æ€ä»·å€¼å‡½æ•° V(s_t)ã€‚å‡å»åŸºçº¿ä¸ä¼šæ”¹å˜æ¢¯åº¦çš„æœŸæœ›å€¼ï¼ˆå› ä¸º \\mathbb{E}[\\nabla_\\theta \\log \\pi_\\theta(a_t|s_t) b(s_t)] = 0ï¼‰ï¼Œä½†å¯ä»¥æ˜¾è‘—å‡å°æ¢¯åº¦çš„æ–¹å·®ã€‚\n\\nabla_\\theta J(\\theta) = \\mathbb{E}_{\\tau \\sim \\pi_\\theta} \\left[ \\sum_{t=0}^{T} \\nabla_\\theta \\log \\pi_\\theta(a_t|s_t) (G_t - V(s_t)) \\right]7. æœ€ç»ˆå½¢å¼ï¼šä¼˜åŠ¿å‡½æ•°\næˆ‘ä»¬å‘ç°ï¼ŒG_t - V(s_t) æ­£æ˜¯ä¼˜åŠ¿å‡½æ•° A(s_t, a_t) çš„ä¸€ä¸ªä¼°è®¡ã€‚å› æ­¤ï¼Œç­–ç•¥æ¢¯åº¦å®šç†æœ€ç»ˆå¯ä»¥å†™æˆæˆ‘ä»¬ç†Ÿæ‚‰çš„å½¢å¼ï¼š\n\\nabla_\\theta J(\\theta) \\approx \\hat{\\mathbb{E}}_t \\left[ \\nabla_\\theta \\log \\pi_\\theta(a_t|s_t) \\hat{A}_t \\right]è¿™ä¸ªå½¢å¼ç›´è§‚åœ°å‘Šè¯‰æˆ‘ä»¬ï¼šå¦‚æœä¸€ä¸ªåŠ¨ä½œçš„ä¼˜åŠ¿ \\hat{A}_t æ˜¯æ­£çš„ï¼Œæˆ‘ä»¬å°±è°ƒæ•´å‚æ•° \\theta æ¥å¢åŠ è¿™ä¸ªåŠ¨ä½œçš„å¯¹æ•°æ¦‚ç‡ \\log \\pi_\\theta(a_t|s_t)ï¼›åä¹‹äº¦ç„¶ã€‚è¿™å°±æ˜¯ç­–ç•¥æ¢¯åº¦æ–¹æ³•çš„æ ¸å¿ƒã€‚\n[ä¿¡èµ–åŸŸæ–¹æ³•æ¨å¯¼]TRPO (PPO çš„å‰èº«) çš„ç›®æ ‡å‡½æ•°å¯ä»¥å†™æˆï¼š\n\\max_\\theta \\quad \\mathbb{E}_{\\substack{s \\sim \\rho^{\\pi_{\\theta_{old}}}ï¼Œ a \\sim \\pi_{\\theta_{old}}}} \\left[ \\frac{\\pi_\\theta(a|s)}{\\pi_{\\theta_{old}}(a|s)} A^{\\pi_{\\theta_{old}}}(s,a) \\right]\\text{s.t.} \\quad \\mathbb{E}_{s \\sim \\rho^{\\pi_{\\theta_{old}}}} \\left[ D_{KL}(\\pi_{\\theta_{old}}(\\cdot|s) || \\pi_\\theta(\\cdot|s)) \\right] \\leq \\deltaè¿™é‡Œçš„ D_{KL} æ˜¯ KL æ•£åº¦ï¼Œç”¨æ¥è¡¡é‡æ–°æ—§ç­–ç•¥çš„å·®å¼‚ã€‚è¿™ä¸ªçº¦æŸç¡®ä¿äº†ç­–ç•¥æ›´æ–°ä¸ä¼šåç¦»æ—§ç­–ç•¥å¤ªè¿œï¼Œä»è€Œä¿è¯äº†è®­ç»ƒçš„ç¨³å®šæ€§ã€‚ç„¶è€Œï¼Œæ±‚è§£è¿™ä¸ªå¸¦çº¦æŸçš„ä¼˜åŒ–é—®é¢˜éå¸¸å¤æ‚ï¼Œéœ€è¦è®¡ç®—äºŒé˜¶å¯¼æ•°ï¼ˆHessiançŸ©é˜µï¼‰ã€‚\nPPO é€šè¿‡ clip å‡½æ•°æ¥è¿‘ä¼¼è¿™ä¸ªå¸¦çº¦æŸçš„ä¼˜åŒ–é—®é¢˜ï¼Œå°†å…¶è½¬åŒ–ä¸ºä¸€ä¸ªæ— çº¦æŸçš„ã€æ›´å®¹æ˜“æ±‚è§£çš„ä¼˜åŒ–é—®é¢˜ã€‚PPO çš„ç›®æ ‡å‡½æ•°å¯ä»¥çœ‹ä½œæ˜¯ TRPO ç›®æ ‡å‡½æ•°çš„ä¸€é˜¶è¿‘ä¼¼çš„ã€åŠ äº†æƒ©ç½šé¡¹çš„ç‰ˆæœ¬ï¼Œä»è€Œå¤§å¤§ç®€åŒ–äº†è®¡ç®—ï¼ŒåŒæ—¶ä¿ç•™äº†ä¿¡èµ–åŸŸæ–¹æ³•çš„ç¨³å®šæ€§ã€‚\n","tags":["Reinforcement Learning"]},{"title":"uv install Quickstart","url":"/2025/07/03/fast_startup/uv-install-quickstart/","content":"\n\nInstalling [uv] and Managing Your Python Projectsuv is a seriously fast and efficient tool for Python package management, written in Rust. Itâ€™s a great alternative to pip and virtualenv, speeding up your workflow significantly. Letâ€™s get you set up and show you how to use it.\n\nInstalling [uv]: Three WaysYouâ€™ve got a few simple options for getting uv onto your system:\n\nRecommended (with pipx): This is the best way as it installs uv in its own isolated environment, preventing conflicts with other packages.pip install pipx # If you don&#x27;t have pipx alreadypipx ensurepath    # Make sure pipx&#x27;s executables are on your PATHpipx install uv\nDirectly with pip: A straightforward way if you prefer not to use pipx.pip install uv\nUsing brew (macOS/Linux): If youâ€™re on macOS or Linux and use Homebrew, itâ€™s just one command.brew install uv\n\n\n\nSetting Up and Activating a Virtual Environmentuv makes managing virtual environments a breeze, keeping your project dependencies neatly separated.\nCreating the EnvironmentTo create a new virtual environment in your current directory (itâ€™ll be named .venv by default):\nuv venv\nor you can assign specific version of Python\nuv venv -p 3.10\nActivating the EnvironmentBefore you do anything else in your project, you need to activate this environment:\n\nmacOS/Linux:source .venv/bin/activate\nWindows (Command Prompt):.venv\\Scripts\\activate.bat\nWindows (PowerShell):.venv\\Scripts\\Activate.ps1\n\n\nYouâ€™ll know itâ€™s active because your terminal prompt will usually show (.venv) at the beginning.\nExit can use following:deactivate\nDelete the .venv directory:rm -rf .venv\n\nInstalling Packages with [uv pip install]Once your virtual environment is active, installing packages is very similar to pip, but with uv pip:\n\nInstalling from requirements.txt:uv pip install -r requirements.txt\nInstalling individual packages:uv pip install requests beautifulsoup4\n\n\nImportant Note on Quoting with [uv pip]When installing packages that include extras (optional features) or direct URLs, you must use double quotes to ensure the shell passes the entire string correctly to uv. This is a common point of confusion for pip users moving to uv.\n\nWith extras:uv pip install &quot;celery[redis]&quot;\nFrom a Git repository:uv pip install &quot;git+https://github.com/example/my-lib.git#egg=my-lib&quot;\nLocal editable installs:uv pip install &quot;-e .&quot;\n\n\n\nRunning Your Project with [uv]â€™s PythonAfter your environment is active and dependencies are installed, you simply use the python command, which now refers to the Python interpreter within your activated .venv.\nIf you have a script named app.py:\npython app.py\nKey point: You donâ€™t use uv python (that command doesnâ€™t exist). Once the environment is activated, your shell automatically uses the python from your .venv.\n\nWhat Makes [uv] Special?uv isnâ€™t just another package manager; it brings some powerful features to the table:\n\nBlazing Speed: This is uvâ€˜s headline feature. Written in Rust, itâ€™s significantly faster than pip for dependency resolution and installation, especially in large, complex projects.\n\nRobust Dependency Resolution: uv is designed to handle complex dependency graphs and potential conflicts much more effectively than pip, leading to more reliable builds.\n\nNo Global Lock (for venvs): Unlike some other tools, uv doesnâ€™t enforce a global lock file across all your virtual environments. Each uv venv operates independently, which simplifies development when youâ€™re juggling multiple projects with different dependency versions. You can manage project-specific lock files (e.g., uv lock) if desired, but itâ€™s not imposed globally.\n\nIntegrated Installer and Resolver: uv combines the roles of pip (installer) and pip-tools or Poetry (resolver) into a single, cohesive tool.\n\n\n\n[uv] beats naive [pip] &amp; [conda] =w=/","tags":["ENV"]},{"title":"GNNç³»åˆ—1-GCN(Graph Convolutional Networks)","url":"/2025/01/23/insight/Graphs/Backbones/GCN/","content":"å†™åœ¨å‰é¢ä½œä¸ºåšå®¢å¼€ç¯‡ï¼ŒGraphç³»åˆ—çš„ç¬¬ä¸€ç« ï¼Œä¸€åˆ‡éƒ½åªæ˜¯æˆ‘æµ…è–„çš„è§‚å¯Ÿå’Œå¯¹äºé˜…è¯»çš„éƒ¨åˆ†è®ºæ–‡å¾—å‡ºçš„è§è§£ï¼Œä¸èƒ½è¯´æ˜¯insightï¼Œåªèƒ½å¤Ÿå°½å¯èƒ½ä»æˆ‘è‡ªå·±çš„æ­¦æ–­è®¤ä¸ºå…¶å¯èƒ½å­˜åœ¨çš„é“ç†æ¥è¿›è¡Œå‰–æï¼Œä»¥åŠï¼Œæˆ‘ç‰¹åˆ«å–œæ¬¢çš„ï¼Œä»å‘å±•ä¸­å‘åæ¨è¿›ã€ä»¥é¢„åˆ¤å…¶æ½œåœ¨çš„æ”¹è¿›ç©ºé—´ã€‚\nç”±äºæ˜¯ç¬¬ä¸€ç« èŠ‚ï¼Œæ‰€ä»¥ä¼šç‰µæ‰¯åˆ°å¾ˆå¤šæœ€æœ€åŸºç¡€çš„å®šä¹‰ï¼Œçƒ¦è¯·è€å¿ƒé˜…è¯»ã€‚\nå¦å¤–ï¼Œå°±æˆ‘å¯¹äºå·¥ä¸šç•Œçš„å®ä¹ æ¥çœ‹ï¼Œè‡³å°‘åœ¨2025å¹´ï¼Œå½“ä¸‹çš„å›¾ç»“æ„æ•°æ®çš„å¼€å‘ä¾ç„¶å­˜åœ¨æå…¶å¤§çš„ç©ºé—´ã€‚åœ¨å®é™…åº”ç”¨ä¸­å‘æŒ¥å›¾ç»“æ„çš„ä¼˜åŠ¿ï¼Œæœ€æœ€é‡è¦çš„æ˜¯å»ºæ¨¡ï¼Œå› ä¸ºå›¾ä¸å†æ˜¯ç®€å•çš„ç¦»æ•£ç‚¹é˜µï¼Œæ›´æœ‰å›¾çš„ç»“æ„â€”â€”è¿™ä¹Ÿç‰µæ‰¯åˆ°ä»€ä¹ˆæ˜¯å›¾ä»€ä¹ˆæ˜¯å¼‚æ„å›¾ã€‚å³ï¼Œå¹¶éå†æ˜¯åƒæœ´ç´ æ•°æ®æŒ–æ˜é‚£æ ·æ¢è®¨å¦‚ä½•å¤„ç†å›¾ç»“æ„çš„æ•°æ®æ¥é€‚åº”ä¸€ä¸ªè‡ªå›å½’ä»»åŠ¡ï¼Œè€Œæ˜¯åœ¨äºåº”å½“å¦‚ä½•å»æ„å»ºå›¾ç»“æ„çš„æ•°æ®ï¼Œå»å®šä¹‰ä»€ä¹ˆæ˜¯è¾¹ï¼Œä»€ä¹ˆæ˜¯èŠ‚ç‚¹ï¼Œç”šè‡³éšå¼åœ°å®šä¹‰å›¾ã€‚ä¸€ä¸ªéå¸¸ç®€å•çš„ä¾‹å­ï¼Œå¦‚ä½•æ•™ä¼šæœºå™¨äººé€šè¿‡æœ‰é™æ—‹è½¬å…³èŠ‚çš„æœºæ¢°è‡‚ï¼Œæ¥å è¡£æœï¼Œå¦‚æœè¯´è¿™ä¸ªæ–¹æ³•å¯ä»¥é€šè¿‡å°†ç©ºé—´å’Œè¡£æœæœ¬èº«å»ºæ¨¡ç”¨ç‚¹æ¥è¿›è¡Œå»ºæ¨¡çš„è¯ã€‚ä¹Ÿè®¸å¾ˆå¤šäººä¼šæœ‰å’Œæˆ‘ä¸€æ ·çš„ç–‘æƒ‘ï¼šæ˜¯å¦å›¾ç»“æ„çš„æ•°æ®åœ¨å¾ˆå¤šçš„ç®—æ³•ä¸­å…¶å®éƒ½æœ‰æ‰€å´­éœ²ï¼Œè€Œåªæ˜¯è¢«å…¶ä»–è§’åº¦çš„è§£è¯»æ‰€æ©ç›–äº†ã€‚\nGNNä½œä¸ºä¸€ä¸ªå—åˆ°MLPå’ŒCVä¸­çš„å·ç§¯ç¥ç»ç½‘ç»œçš„å¯å‘ï¼Œè€Œä»æ·±åº¦å­¦ä¹ çš„è§’åº¦æ¥å»ºæ¨¡å›¾ç»“æ„æ•°æ®çš„å°†å…¶ä½œä¸ºä¸€ä¸ªä»å›¾æ•°æ®åˆ°ç›®æ ‡åŸŸçš„æ˜ å°„ï¼Œè¿™èˆ¬çš„ç±»æ¨æ˜¯ååˆ†æœ´å®çš„ï¼Œä½†æ˜¯ä¸å¯é¿å…çš„éœ€è¦â€œå…·ä½“é—®é¢˜å…·ä½“åˆ†æâ€â€”â€”ä¸æ˜¯ä¸€ä¸ªé€šç”¨çš„ç½‘ç»œå°±èƒ½å¤Ÿåœ¨æ‰€æœ‰çš„å›¾ç›¸å…³ä»»åŠ¡ä¸­éƒ½è¾¾åˆ°æœ€å¥½çš„æ•ˆæœï¼Œå°±åƒæ˜¯å¤§è¯­è¨€æ¨¡å‹éœ€è¦åœ¨ç›®æ ‡åŸŸè¿›è¡Œå¾®è°ƒä¸€æ ·ã€‚\nå¥½ï¼Œé‚£ä¹ˆä¸‹é¢å¼€å§‹ã€‚\nå‚è€ƒåŸæ–‡ï¼š(GCN-3 KipfNet)Semi-Supervised Classification with Graph Convolutional Networks ICLR2017 | Paper | Citeä»£ç : torch_geometric.nn.models.GCN\nI. å›¾ç»“æ„æ•°æ®å®šä¹‰å¸¸è§çš„å®šä¹‰æœ‰äºŒ\n\nå®šä¹‰ä¸€ï¼šåŸºäºå‡ ä½•ç»“æ„æ•°å­¦è¡¨ç¤º\n\n\\mathcal{G} = (\\mathcal{V},\\mathcal{E})ä¸€ä¸ªå›¾ (\\mathcal{G}) ç”±ä»¥ä¸‹ç»„æˆï¼š \n\nèŠ‚ç‚¹é›†åˆ (\\mathcal{V}): è¡¨ç¤ºå›¾ä¸­çš„æ‰€æœ‰èŠ‚ç‚¹ï¼Œé€šå¸¸ç”¨ (|\\mathcal{V}| = N) è¡¨ç¤ºèŠ‚ç‚¹çš„æ•°é‡ã€‚\nè¾¹é›†åˆ (\\mathcal{E}): è¡¨ç¤ºèŠ‚ç‚¹ä¹‹é—´çš„è¿æ¥å…³ç³»ï¼Œæ¯æ¡è¾¹ç”±ä¸€å¯¹èŠ‚ç‚¹ ((u, v) \\in \\mathcal{V} \\times \\mathcal{V}) è¡¨ç¤ºã€‚ \nèŠ‚ç‚¹ç‰¹å¾çŸ©é˜µ (\\mathrm{X}):\\mathrm{X} \\in \\mathbb{R}^{N \\times F}ï¼Œå…¶ä¸­Fè¡¨ç¤ºæ¯ä¸ªèŠ‚ç‚¹çš„ç‰¹å¾ç»´åº¦ã€‚ \nå‡ ä½•ç»“æ„(å¯é€‰): è¾¹çš„å‡ ä½•ä¿¡æ¯ï¼Œå¦‚åœ¨äºŒç»´æˆ–ä¸‰ç»´ç©ºé—´ä¸­çš„è¾¹çš„é•¿åº¦ã€æ–¹å‘ç­‰ã€‚\n\nå½¢å¼åŒ–è¡¨ç¤ºï¼š \n\n \\mathcal{G} = (\\mathcal{V}, \\mathcal{E}, \\mathrm{X}, \\text{å‡ ä½•ä¿¡æ¯})ç¤ºä¾‹ï¼š \n\n\\mathcal{V} = \\{v_1, v_2, v_3\\}ï¼›\n\\mathcal{E} = \\{(v_1, v_2), (v_2, v_3)\\}ï¼›\n\\mathrm{X}=\\begin{bmatrix} 1 & 0 \\\\ 0 & 1 \\\\ 1 & 1 \\end{bmatrix}ï¼›\nè¾¹çš„å‡ ä½•é•¿åº¦ï¼šd_{12} = 1.5, d_{23} = 2.0ã€‚\n\n\nå®šä¹‰äºŒï¼šåŸºäºé‚»æ¥çŸ©é˜µæ•°å­¦è¡¨ç¤ºï¼š\n\n\\mathcal{G} = (\\mathrm{A}, \\mathrm{X}, \\mathrm{E})ä¸€ä¸ªå›¾\\mathcal{G}å¯ä»¥ç”¨ä»¥ä¸‹æ–¹å¼å®šä¹‰ï¼š\n\né‚»æ¥çŸ©é˜µ \\mathrm{A}: è¡¨ç¤ºå›¾çš„æ‹“æ‰‘ç»“æ„ï¼Œæ˜¯ä¸€ä¸ª\\mathrm{A} \\in \\mathbb{R}^{N \\times N}çš„ç¨€ç–çŸ©é˜µï¼ˆä¸€èˆ¬æ¥è¯´ï¼‰ï¼Œå…¶ä¸­ï¼š\n\\mathrm{A}_{ij} = 1è¡¨ç¤ºèŠ‚ç‚¹iå’Œjä¹‹é—´å­˜åœ¨è¾¹ï¼›\n\\mathrm{A}_{ij} = 0è¡¨ç¤ºèŠ‚ç‚¹iå’Œjä¹‹é—´ä¸å­˜åœ¨è¾¹ã€‚\n\n\nèŠ‚ç‚¹ç‰¹å¾çŸ©é˜µ \\mathrm{X}: è¡¨ç¤ºæ¯ä¸ªèŠ‚ç‚¹çš„ç‰¹å¾ï¼Œæ˜¯ä¸€ä¸ª\\mathrm{X} \\in \\mathbb{R}^{N \\times F}ï¼Œå…¶ä¸­Fè¡¨ç¤ºæ¯ä¸ªèŠ‚ç‚¹çš„ç‰¹å¾ç»´åº¦ã€‚\nè¾¹ç‰¹å¾çŸ©é˜µ \\mathrm{E}ï¼ˆå¯é€‰ï¼‰: è¡¨ç¤ºè¾¹çš„ç‰¹å¾ï¼Œæ˜¯ä¸€ä¸ª\\mathrm{E} \\in \\mathbb{R}^{|\\mathcal{E}| \\times F_e}ï¼Œå…¶ä¸­F_eè¡¨ç¤ºæ¯æ¡è¾¹çš„ç‰¹å¾ç»´åº¦ã€‚\n\nå½¢å¼åŒ–è¡¨ç¤ºï¼š\n\n\\mathcal{G} = (\\mathrm{A}, \\mathrm{X}, \\mathrm{E})ç¤ºä¾‹\n\\mathrm{A} = \\begin{bmatrix} 0 & 1 & 0 \\\\ 1 & 0 & 1 \\\\ 0 & 1 & 0 \\end{bmatrix}ï¼›\n\n\\mathrm{X} = \\begin{bmatrix} 1 & 2 \\\\ 0 & 3 \\\\ 1 & 0 \\end{bmatrix}ï¼›\n\n\\mathrm{E} = \\begin{bmatrix} 0.5 \\\\ 0.8 \\\\ 1.2 \\end{bmatrix}ï¼ˆå¦‚è¾¹çš„æƒé‡æˆ–è·ç¦»ä¿¡æ¯ ï¼‰ã€‚\n\n\n\nå®šä¹‰ä¸€å…³æ³¨å‡ ä½•ç»“æ„ï¼Œå¸¸ç”¨äºéœ€è¦æ˜ç¡®ç©ºé—´ä¿¡æ¯çš„é—®é¢˜ï¼Œå¦‚ä¸‰ç»´ç‰©ä½“é‡å»ºã€åˆ†å­å»ºæ¨¡å’Œæœºå™¨äººè·¯å¾„è§„åˆ’ï¼Œè§£å†³å‡ ä½•å½¢çŠ¶åˆ†æã€åˆ†å­æ€§èƒ½é¢„æµ‹å’Œç©ºé—´å¯¼èˆªç­‰é—®é¢˜ï¼›å®šä¹‰äºŒæ›´åŠ å…³æ³¨èŠ‚ç‚¹ä¿¡æ¯å’ŒèŠ‚ç‚¹é—´çš„ä¿¡æ¯å…³ç³»ï¼Œå¹¿æ³›åº”ç”¨äºç¤¾äº¤ç½‘ç»œã€æ¨èç³»ç»Ÿå’ŒçŸ¥è¯†å›¾è°±ï¼Œä¸»è¦è§£å†³å…³ç³»å»ºæ¨¡ã€ä¸ªæ€§åŒ–æ¨èä»¥åŠå¤æ‚ç½‘ç»œä¸­ä¿¡æ¯ä¼ æ’­ä¸é¢„æµ‹çš„é—®é¢˜ã€‚\nå½“ç„¶äº†åœ¨ç°åœ¨çš„å¾ˆå¤šå·¥ä¸šåº”ç”¨å½“ä¸­æŠ›å¼ƒæ˜¾å¼çš„å›¾ç»“æ„ï¼Œç”¨ç®€å•çš„ç¥ç»ç½‘ç»œå’Œåºåˆ—å»ºæ¨¡Transformerç±»ä¼¼çš„äº¤å‰æ³¨æ„åŠ›ç»“æ„ä¹Ÿä¾ç„¶èƒ½å¤Ÿå¾—åˆ°ä¸€ä¸ªéå¸¸å¥½çš„æ•ˆæœï¼Œå› ä¸ºå¤§éƒ¨åˆ†å·¥ä¸šåº”ç”¨ä¸­æ›´åŠ é‡è§†é€Ÿåº¦â€”â€”å°½ç®¡è¿™ä¸ªé€Ÿåº¦å¯ä»¥æ˜¯é€šè¿‡å­¦æœ¯ç•Œæ–°åˆ›æ–°æ–¹æ³•ä¹‹åä¸æ–­åœ°ä¼˜åŒ–å¾—åˆ°çš„ã€‚\nII. GCNåŸç†å›¾å·ç§¯ç½‘ç»œå¯ä»¥åˆ†è§£ä¸ºå±‚çš„å †å ï¼Œå…¶æ€è·¯éå¸¸ç®€å•å¯ä»¥æ¦‚æ‹¬ä¸ºï¼š\nåŠ æƒå¹³å‡èšåˆ \\rightarrow ç»´åº¦å˜æ¢ \\rightarrow éçº¿æ€§æ¿€æ´»æ•°å­¦å½¢å¼å¦‚ä¸‹ï¼š\n\n\\mathrm{H}^{(l+1)} = \\sigma\\left( \\tilde{D}^{-\\frac{1}{2}} \\tilde{\\mathrm{A}} \\tilde{D}^{-\\frac{1}{2}} \\mathrm{H}^{(l)} W^{(l)} \\right) \\tag{2.1}\n\\tilde{\\mathrm{A}} = \\mathrm{A} + Iï¼šå¸¦è‡ªç¯çš„é‚»æ¥çŸ©é˜µ\n\\tilde{D}ï¼š\\tilde{A}çš„åº¦çŸ©é˜µï¼Œ\\tilde{D} ^{-\\frac{1}{2}}æ„å‘³ç€å¯¹äºå…¶ä¸­æ‰€æœ‰çš„éé›¶å…ƒç´ éƒ½å–æ­£å¹³æ–¹æ ¹çš„å€’æ•°ï¼›\nå…¥åº¦çŸ©é˜µï¼ˆæœ‰å‘å›¾ï¼ŒæŒ‡å‘è¯¥èŠ‚ç‚¹çš„è¾¹ï¼‰ï¼šD^{\\text{in}}_{ii} = \\sum_j A_{ji}ï¼Œ\nå‡ºåº¦çŸ©é˜µï¼ˆæœ‰å‘å›¾ï¼Œä»è¯¥èŠ‚ç‚¹æŒ‡å‡ºçš„è¾¹ï¼‰ï¼šD^{\\text{out}}_{ii} = \\sum_j A_{ij}ï¼Œ\n\n\nH^{(l)}ï¼šç¬¬lå±‚çš„èŠ‚ç‚¹ç‰¹å¾ï¼Œ H^{(0)} = \\mathrm{X}ï¼›\nW^{(l)}ï¼šå¯è®­ç»ƒæƒé‡çŸ©é˜µï¼›\n\\sigmaï¼šæ¿€æ´»å‡½æ•°ï¼ˆå¦‚ReLUï¼‰ã€‚\n\nIII. ä¸åŒè§’åº¦çš„Rationaleå¯ä»¥è¯´ï¼Œè¿™æ˜¯é€šè¿‡æ¨å¹¿å·ç§¯å’Œå…¶ä¸Šçš„æ‹‰æ™®æ‹‰æ–¯ç®—å­åˆ°å›¾ä¸Šï¼Œæ¥å°†å…¶å˜æ¢åˆ°é¢‘åŸŸæ¥è¿›è¡Œè®¡ç®—ï¼Œã€Xavier Bressonæ•™æˆå›¾ç¥ç»ç½‘ç»œç³»åˆ—è®²åº§_bilibiliï¼Œå›¾ç¥ç»ç½‘ç»œç†è®ºåŸºç¡€-äººå¤§-é­å“²å·_bilibiliã€‘è¿™æ˜¯åˆç†çš„ã€‚ä¹Ÿå¯ä»¥ä»æ·±åº¦å­¦ä¹ çš„è§’åº¦å‡ºå‘ï¼ˆå½“ç„¶è¿™ä¹Ÿæ˜¯æ·±åº¦å·ç§¯ç½‘ç»œï¼‰ï¼Œæ‰€è°“æµ…å±‚è¡¨ç¤ºlocalï¼Œæ·±å±‚è¡¨ç¤ºglobalä¿¡æ¯ï¼Œå³ä½é¢‘ç‡ç‰¹å¾å€¼å’Œé«˜é¢‘ç‰¹å¾å€¼ã€‚\n\nå…³æ³¨IIéƒ¨åˆ†ä¸­çš„å…¬å¼.(2.1)ä¸­çš„éƒ¨åˆ†ï¼š\n\\tilde{D}^{-\\frac{1}{2}} \\tilde{A} \\tilde{D}^{-\\frac{1}{2}} \\mathrm{H}^{(l)}æœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ªå¯¹äºé‚»å±…èŠ‚ç‚¹å’Œè‡ªèº«çš„åŠ æƒå¹³å‡ï¼Œå †å GNNçš„å±‚å¯ä»¥çœ‹ä½œæ˜¯ä¸€ä¸ªä¿¡æ¯èšåˆçš„è¿‡ç¨‹ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼ˆæœ‰é¢œè‰²çš„å³ä¸ºç»è¿‡è¿™æ¬¡èšåˆåèƒ½å¤Ÿå¾—åˆ°çš„ä¿¡æ¯ï¼‰ï¼š\n\nè¿™æ ·çš„é‚»å±…èšåˆåå…±äº«å‚æ•°å…¶å®è•´å«äº†ä¸‰ä¸ªå‡è®¾ï¼Œ\n\nç¬¬ä¸€ï¼Œé‚»å±…èŠ‚ç‚¹å’Œè¯¥èŠ‚ç‚¹çš„åˆ†ç±»ç»“æœæ˜¯ç›¸å…³çš„ï¼Œè¿™ä¸€å‡è®¾ä¸é©¬å°”ç§‘å¤«æ€§è´¨ï¼ˆMarkov Propertyï¼‰ç›¸å…³ï¼Œå³ä¸€ä¸ªèŠ‚ç‚¹çš„çŠ¶æ€åªä¾èµ–äºå…¶é‚»å±…èŠ‚ç‚¹çš„çŠ¶æ€ï¼Œä¹Ÿå°±ä¼šå¼•å‡ºä¸€äº›æœ‰å…³äºé©¬å°”ç§‘å¤«æ¯¯ï¼ˆMarkov blanketï¼‰çš„è®¨è®ºï¼ŒåŒæ—¶ä¹Ÿå¼•å¯¼äººä»¬çœ‹å‘è¯±å¯¼å­å›¾ï¼ˆInduced Graphï¼‰ã€‚\nç¬¬äºŒï¼Œå¦‚æœæ„å»ºçš„æ˜¯ä¸€ä¸ªæ·±åº¦GNNï¼ŒèŠ‚ç‚¹é—´çš„æœ€çŸ­è·ç¦»å’Œç›¸å…³æ€§å‘ˆåæ¯”ï¼Œå³å›¾ä¿¡å·å¤„ç†ä¸­çš„å¹³æ»‘æ€§å‡è®¾ï¼ˆSmoothness Assumptionï¼‰ï¼šå›¾ä¿¡å·åœ¨å±€éƒ¨åŒºåŸŸå†…å˜åŒ–è¾ƒå°ï¼Œä¹Ÿå°±æ˜¯å‡è®¾å›¾ä¿¡å·çš„ä¸»è¦ä¿¡æ¯é›†ä¸­åœ¨ä½é¢‘éƒ¨åˆ†ï¼Œå³å›¾ä¿¡å·åœ¨å±€éƒ¨åŒºåŸŸå†…å˜åŒ–è¾ƒå°ï¼›\nç¬¬ä¸‰ï¼Œå‡è®¾èŠ‚ç‚¹çš„ç‰¹å¾å’Œè¾¹çš„æƒé‡æ˜¯ç‹¬ç«‹çš„ï¼Œå³è¾¹çš„æƒé‡åªåæ˜ èŠ‚ç‚¹ä¹‹é—´çš„è¿æ¥å¼ºåº¦ï¼Œè€Œä¸ç›´æ¥ä¾èµ–äºèŠ‚ç‚¹ç‰¹å¾ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆGCNåŸæ–‡ç”¨çš„æ˜¯åœ¨ç¤¾äº¤å›¾ä¸Šçš„åŠç›‘ç£çš„èŠ‚ç‚¹åˆ†ç±»é—®é¢˜ã€‚å¯ä»¥è¯´è¿™ä¸‰ä¸ªå‡è®¾æ˜¯ä½¿å¾—GCNè¿™æ ·çš„æ¨¡å¼èƒ½å¤Ÿå‘æŒ¥ä½œç”¨çš„äº‹åè§£é‡Šï¼›ä¹Ÿå¯ä»¥è¯´æ˜¯åœ¨å‘ç°å…¶å­˜åœ¨çš„é—®é¢˜ä¹‹åçš„å›é¡¾ï¼Œå¯¹äºé—®é¢˜æš‚ä¸”å…ˆæŒ‰ä¸‹ä¸è¡¨ï¼Œå…ˆæ¥çœ‹ä¸ºä»€ä¹ˆä»–ä¼šæœ‰ç”¨ï¼Œä»¥åŠï¼Œæ˜¯å¦‚ä½•è®¾è®¡å¾—æ›´åŠ ç¬¦åˆç¥ç»ç½‘ç»œå·¥å­¦çš„ç›´è§‰çš„ã€‚\n\nè¿™å’Œå›¾åƒå·ç§¯ä¸­çš„æ¯æ¬¡ä¸€ä¸ªæ»‘çª—èšåˆå…¶ä¸­çš„k\\times kçš„çª—å£å†…çš„åƒç´ ç‚¹ï¼›æŠ‘æˆ–æ˜¯ä¿¡å·ä¸ç³»ç»Ÿä¸­çš„ç©ºåŸŸä¿¡å·ä½œå€’åºå·ç§¯ï¼Œéƒ½æœ‰å¼‚æ›²åŒå·¥ä¹‹å¦™ã€‚\né‡æ–°å®šä¹‰å›¾å·ç§¯ï¼ˆGraph Convolutionï¼‰å›é¡¾ä¸€ä¸‹å·ç§¯å®šä¹‰ï¼Œå…¶ä¸­tæ˜¯è¿ç»­æ—¶åŸŸå˜é‡ï¼Œ\\tauæ˜¯çª—å£å¤§å°ã€‚\n(f * g)(t):= \\int_{\\infty}f( \\tau )g(t- \\tau )d \\tauç¦»æ•£ç‰ˆæœ¬ï¼Œm æ˜¯çª—å£å¤§å°ï¼Œn æ˜¯ç‚¹åˆ—å˜é‡ï¼ˆç¦»æ•£æ—¶é—´ï¼‰ï¼Œn\\in \\mathbb{Z}ï¼š\n(f*g)[n]=  \\sum_{m=-\\infty }^ {\\infty}f[m]g[n-m]=  \\sum _ {m=-\\infty }^ {\\infty }  f[n-m]g[m]å·ç§¯åªæ˜¯ä¸€ç§é¢‘åŸŸçš„åˆ†ææ–¹æ³•ï¼Œç”¨æ»¤æ³¢å™¨gæ¥ç­›é€‰åŸæ¥ä¿¡å·å‡½æ•°fçš„æ€§è´¨ï¼Œé‚£ä¹ˆï¼Œå¦‚ä½•å®šä¹‰Graphä¸Šçš„å·ç§¯å‘¢ï¼Œæˆ‘ä»¬åªå…³æ³¨å…¶ä¸­çš„ä»»æ„ä¸€ç‚¹nï¼Œè§‚å¯Ÿå¯¹äºå®ƒå·ç§¯çš„æ—¶å€™å‘ç”Ÿäº†ä»€ä¹ˆï¼šå‡è®¾æˆ‘ä»¬æœ‰ä»¥ä¸‹è¾“å…¥ä¿¡å· f å’Œå·ç§¯æ ¸ gï¼š\n\nè¾“å…¥ä¿¡å· f_n=[1,2,3,4]ï¼Œç´¢å¼•èŒƒå›´ä¸º 0â‰¤mâ‰¤3ï¼›\nå·ç§¯æ ¸ g_n=[1,2,1]ï¼Œç´¢å¼•èŒƒå›´ä¸º 0â‰¤mâ‰¤2ã€‚é¦–å…ˆï¼Œå°†å·ç§¯æ ¸ g ç¿»è½¬ï¼šg_{-m}=[1,2,1]ï¼Œæˆ‘ä»¬å–å…¶ä¸­éé›¶çš„ç‚¹æ¥è®¡ç®—ï¼š\nå½“ n=3ï¼š\nå·ç§¯æ ¸è¦†ç›–çš„èŒƒå›´ï¼šnâˆ’m=3â‡’m=1,2,3ã€‚\næœ‰æ•ˆèŒƒå›´ï¼šm=1,2,3ã€‚\nè®¡ç®—å¾—åˆ°(fâˆ—g)[3]=f[1]â‹…g[2]+f[2]â‹…g[1]+f[3]â‹…g[0]=2â‹…1+3â‹…2+4â‹…1=12å³\\sum^{3}_{m=0} f[m] \\odot g_{-m}[m]ï¼Œå…¶ä¸­\\odotä¸ºå“ˆå¾·ç›ç§¯ï¼Œå³é€ä¸ªä½ç½®å…ƒç´ ç›¸ä¹˜ã€‚\n\n\n\n\nå…¶ä¸Šå¾—åˆ°çš„æ˜¯æœ€åæ•´ä¸ªå·ç§¯åå¾—åˆ°çš„å‡½æ•°çš„å…¶ä¸­ä¸€ä¸ªå•ä½ç‚¹ï¼Œé‚£ä¹ˆå¦‚æœæˆ‘ä»¬å¦‚æœéœ€è¦åœ¨å›¾ä¸Šå®šä¹‰ä»€ä¹ˆæ˜¯å·ç§¯ï¼Œå°±éœ€è¦å®šä¹‰ä»€ä¹ˆæ˜¯çª—å£ï¼Ÿä»¥åŠå¦‚ä½•è®¡ç®—æ•´ä¸ªçª—å£å†…çš„å„ä¸ªå…ƒç´ çš„ç›¸åŠ ï¼Ÿ\nå¯¹äºå•ä¸ªèŠ‚ç‚¹ï¼Œä»–çš„ç›¸é‚»çš„æ•°æ®ï¼Œæ˜¾ç„¶ï¼Œå°±æ˜¯å…¶ç›¸é‚»çš„èŠ‚ç‚¹ï¼Œä»–ä»¬é è¾¹æ¥è¿æ¥ï¼Œå› æ­¤å¾ˆè‡ªç„¶åœ°ï¼Œå›¾å·ç§¯çš„å®šä¹‰å°±æ˜¯\n\\tilde{A}\\mathrm{X}å°±è¿™ä¹ˆç®€å•ã€‚\n\nä¸¾æ —.e.g.å°†çŸ©é˜µå¯è§†åŒ–å°±æ˜¯ï¼ˆå‡è®¾æ˜¯ä¸€ä¸ªæ— å‘çš„å›¾ï¼‰ï¼š\n\n\n\n\n\\tilde{A}\nèŠ‚ç‚¹1\nèŠ‚ç‚¹2\nèŠ‚ç‚¹3\nèŠ‚ç‚¹4\nâ€¦\n\n\\mathrm{X}\nèŠ‚ç‚¹å±æ€§1\nå±æ€§2\nâ€¦\n\n\n\n\nèŠ‚ç‚¹1\n1\n0\n1\n0\n\n\nèŠ‚ç‚¹1\nblabla\nlbaba\nlabda\n\n\nèŠ‚ç‚¹2\n0\n1\n0\n0\n\n\\cdot\nèŠ‚ç‚¹2\nblala\nlbaba\nâ€¦\n\n\nèŠ‚ç‚¹3\n1\n0\n1\n1\n\n\nèŠ‚ç‚¹3\nblaa\nlba\n\n\n\nèŠ‚ç‚¹4\n0\n0\n1\n1\n\n\nèŠ‚ç‚¹4\nbabla\nlbdab\n\n\n\nâ€¦\n\n\n\n\nâ€¦\n\nâ€¦\n\n\nâ€¦\n\n\n\n\nå°†è¿™ä¸ª\\tilde{A} \\in \\mathbb{R}^{N \\times N}å’Œ\\mathrm{X} \\in \\mathbb{R}^{N \\times F}çŸ©é˜µç‚¹ç§¯åå¯ä»¥å¾—åˆ°æ›´æ–°åçš„\\mathrm{X}' \\in \\mathbb{R}^{N \\times F}\nå…¶ä¸­ï¼ˆæ¯”å¦‚ç¬¬ä¸€ä¸ªèŠ‚ç‚¹çš„æ›´æ–°åçš„ç¬¬ä¸€ä¸ªå±æ€§ï¼Œå…³æ³¨çº¢è‰²çš„è¡Œå’Œåˆ—å“ˆå¾·ç›ç§¯åç›¸åŠ ï¼‰ï¼Œ\n\\forall x'_i \\in \\mathrm{X}', x_j \\in N(j),x'_i = \\sum_{j} x_j.è¿™é‡ŒN(j)è¡¨ç¤ºå’ŒåŸå›¾ä¸­çš„èŠ‚ç‚¹x_jçš„1-hopé‚»å±…èŠ‚ç‚¹ã€‚\n\né‚£å…·ä½“çš„æ­¥éª¤è§£é‡Šäº†ï¼Œå¦‚ä½•å½¢å¼åˆ†æå’Œå®šä¹‰å‘¢ï¼ŸæŒ‡è·¯è¿™å®¶ï¼šå›¾ç¥ç»ç½‘ç»œ(GNN)å…¥é—¨ä¹‹æ—…(ä¸‰)-æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µä¸GCN - çŸ¥ä¹ (zhihu.com)ï¼›ï¼ˆçœ‹é‡Œé¢æ€ä¹ˆå®šä¹‰æ‹‰æ™®æ‹‰æ–¯çš„å°±å¤Ÿäº†å—·ï¼Œä¸è¦è´ªæ¯= ^ =ï¼‰ã€‚ç®€è¿°å°±æ˜¯å¸Œæœ›æ¨¡ä»¿äºŒç»´ç¦»æ•£çš„æ‹‰æ™®æ‹‰æ–¯ç®—å­ï¼ˆå¦‚ä¸‹ï¼‰ï¼Œæ¥æ¨å¹¿å›¾ä¸Šçš„å·ç§¯å’Œé¢‘è°±åˆ†æï¼š\n\\begin{pmatrix}  \n0 & 1  & 0  \\\\\n1 & -4  & 1 \\\\\n0 & 1  & 0 \\\\\n\\end{pmatrix}æœ€æœ€é‡è¦çš„æ˜¯ä»¥ä¸‹çš„è¿™å¥è¯ï¼š\nâ€œâ€å‡è®¾å…·æœ‰ N ä¸ªèŠ‚ç‚¹çš„å›¾ \\mathcal{G} ï¼Œæ­¤æ—¶å›¾ä¸­æ¯ä¸ªèŠ‚ç‚¹çš„è‡ªç”±åº¦è‡³å¤šä¸º N ï¼Œæ­¤æ—¶è¯¥å›¾ä¸ºå®Œå…¨å›¾ï¼Œå³ä»»æ„ä¸¤ä¸ªèŠ‚ç‚¹ä¹‹é—´éƒ½æœ‰ä¸€æ¡è¾¹è¿æ¥ï¼Œåˆ™å¯¹å…¶ä¸­ä¸€ä¸ªèŠ‚ç‚¹è¿›è¡Œå¾®æ‰°ï¼Œå®ƒå¯èƒ½å˜ä¸ºå›¾ä¸­ä»»æ„ä¸€ä¸ªèŠ‚ç‚¹ã€‚ \næ­¤æ—¶ä»¥ä¸Šå®šä¹‰çš„å‡½æ•° f ä¸å†æ˜¯äºŒç»´ï¼Œè€Œæ˜¯ N ç»´å‘é‡ï¼š f=(f_1,f_2,...,f_N) ï¼Œå…¶ä¸­ f_i ä¸ºå‡½æ•° f åœ¨å›¾ä¸­èŠ‚ç‚¹ x_i å¤„çš„å‡½æ•°å€¼ã€‚ç±»æ¯”äºäºŒç»´å‡½æ•° f(x,y) åœ¨èŠ‚ç‚¹ (x,y) å¤„çš„å€¼ã€‚ \nå¯¹ i èŠ‚ç‚¹è¿›è¡Œæ‰°åŠ¨ï¼Œå®ƒå¯èƒ½å˜ä¸ºä»»æ„ä¸€ä¸ªä¸å®ƒç›¸é‚»çš„èŠ‚ç‚¹ jâˆˆN(i) , N(i) è¡¨ç¤ºèŠ‚ç‚¹ i çš„ä¸€é˜¶é‚»åŸŸèŠ‚ç‚¹ã€‚ \næˆ‘ä»¬ä¸Šé¢å·²ç»çŸ¥é“æ‹‰æ™®æ‹‰æ–¯ç®—å­å¯ä»¥è®¡ç®—ä¸€ä¸ªç‚¹åˆ°å®ƒæ‰€æœ‰è‡ªç”±åº¦ä¸Šå¾®å°æ‰°åŠ¨çš„å¢ç›Šï¼Œåˆ™é€šè¿‡å›¾æ¥è¡¨ç¤ºå°±æ˜¯ä»»æ„ä¸€ä¸ªèŠ‚ç‚¹ j å˜åŒ–åˆ°èŠ‚ç‚¹ i æ‰€å¸¦æ¥çš„å¢ç›Šâ€¦â€¦â€œâ€\nä¹Ÿå°±æ˜¯ï¼šå›¾å·ç§¯æ˜¯å®šä¹‰åœ¨å›¾çš„è¾¹ç»“æ„ä¸Šçš„å·ç§¯ï¼Œè€Œ x_i \\sim p(X)ï¼Œæ‰€æœ‰çš„èŠ‚ç‚¹éƒ½æ˜¯æ¥è‡ªäºä¸€ä¸ªåˆ†å¸ƒçš„é‡‡æ ·ï¼›è¿™å…¶å®ä¹Ÿå’Œå…¶ä»–çš„ç¦»æ•£çš„ä¿¡å·å®šä¹‰ä¿æŒäº†ä¸€è‡´ï¼Œä½†æ˜¯å…¶å¥¥å¦™åœ¨äºä»–æ˜¯åŸºäºè¾¹çš„ç»“æ„çš„å·ç§¯ã€‚\n\nä½†æ˜¯æ˜¾ç„¶åœ°ï¼Œæˆ‘ä»¬ä¼šå‘ç°ä¸€ä¸ªé—®é¢˜ï¼Œåœ¨CVä¸­ï¼Œå‡è®¾ä»å‡½æ•°çš„è§’åº¦å‡ºå‘æ¥çœ‹å¼ é‡çš„å˜åŒ–ï¼ŒCNN(\\cdot) := f(x), x \\in \\mathbb{R}^{H \\times W \\times C} ï¼Œå…¶è¾“å…¥å’Œè¾“å‡ºçš„å¼ é‡å½¢çŠ¶æ˜¯ä¸ä¸€è‡´çš„ï¼Œå³x^{(k)}= f(x^{(k-1)}), kâ‰¥1 çš„æ—¶å€™ (H^k \\times W^k) \\propto \\frac{1}{k} ï¼Œä¹Ÿå°±æ˜¯å¦‚æœä¸paddingçš„è¯ï¼ŒCNNçš„å¼ é‡éšç€ç½‘ç»œæ·±åº¦çš„å¢åŠ æ˜¯è¶Šæ¥è¶Šå°çš„ã€‚ä½†æ˜¯GNNå¹¶éå¦‚æ­¤ï¼ŒGNN(\\cdot) := f(x), x \\in \\mathbb{R}^{N \\times F}, x^{(k)}= f(x^{(k-1)}), kâ‰¥1 çš„æ—¶å€™ï¼Œ N^k = N^{k-1},å§‹ç»ˆéƒ½æ˜¯èŠ‚ç‚¹çš„ä¸ªæ•°ï¼Œé‚£è‡ªç„¶ä¼šå‡ºç°é—®é¢˜ï¼šä¹Ÿå°±æ˜¯ï¼ˆå½“ç„¶å¹¶æ²¡æœ‰é‚£ä¹ˆæ˜¾ç„¶å“¦ï¼Œåªæ˜¯æˆ‘è¯´çš„ï¼‰GCNä¼šé‡åˆ°çš„ï¼Œè¿‡æ¸¡å¹³æ»‘ã€‚\nIV. å›¾ä¿¡å·è¿‡æ¸¡å¹³æ»‘æ‹‰æ™®æ‹‰æ–¯å¹³æ»‘åŸç†åœ¨å›¾ä¿¡å·å¤„ç†ä¸­ï¼Œè¿‡æ¸¡å¹³æ»‘å¯é€šè¿‡å›¾æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µé‡åŒ–ï¼ŒGCNä¼ æ’­ä¸€æ¬¡çš„æ•°å­¦è¡¨è¾¾å¼ä¸ºï¼š\n\n\\mathcal{S}(f) = \\frac{1}{2} \\sum_{i,j=1}^n A_{ij} \\| f_i - f_j \\|^2 = f^\\top L f\nf_i, f_jï¼Œå°±æ˜¯ä¸Šè¿°çš„Section.IIIçš„æœ€åçš„å¼•è¨€éƒ¨åˆ†çš„å®šä¹‰ï¼Œå¯¹äºæ¯ä¸ªèŠ‚ç‚¹çš„å˜æ¢åçš„å€¼ï¼›\nf \\in \\mathbb{R}^nï¼Œå›¾ä¿¡å·å‘é‡ï¼›\nL = D - Aï¼Œ ï¼ˆå§‘ä¸”è¿™æ ·å®šä¹‰ï¼Œä¹Ÿå¯ä»¥æ˜¯å½’ä¸€åŒ–åçš„ï¼‰ç»„åˆæ‹‰æ™®æ‹‰æ–¯çŸ©é˜µã€‚å› ä¸ºæ‹‰æ™®æ‹‰æ–¯çŸ©é˜µå°±æ˜¯æ¥åˆ»ç”»å±€éƒ¨çš„å¹³æ»‘åº¦ï¼Œè¯¦è§å›¾åƒä¸­è¿ç”¨äº†æ‹‰æ™®æ‹‰æ–¯æ ¸åçš„å›¾åƒã€‚\n\nå¹³æ»‘ä¼ æ’­è¿‡ç¨‹åœ¨å›¾å·ç§¯ç½‘ç»œä¸­ï¼Œå¤šå±‚ä¼ æ’­å¯¼è‡´çš„å¹³æ»‘æ•ˆåº”å¯è¡¨ç¤ºä¸ºï¼š\n\nH^{(k+1)} = P H^{(k)} \\quad \\text{å…¶ä¸­} \\quad P = \\tilde{D}^{-1/2}\\tilde{A}\\tilde{D}^{-1/2}å¯¹ä¼ æ’­çŸ©é˜µPï¼ˆå› ä¸ºå‡è®¾æ˜¯æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µï¼‰è¿›è¡Œç‰¹å¾åˆ†è§£ï¼š  \nP = U \\Lambda U^\\topç»è¿‡Kæ¬¡ä¼ æ’­åï¼š  \nH^{(K)} = P^K H^{(0)} = U \\Lambda^K U^\\top H^{(0)}å¹³æ»‘åŠ¨æ€ç‰¹æ€§é‚£ä¹ˆè‡ªç„¶åœ°ï¼Œä»å•ä¸ªç‰¹å¾å€¼çš„è§’åº¦æ¥çœ‹ï¼š\n\né«˜é¢‘åˆ†é‡è¡°å‡ï¼š\\lambda_i^K \\rightarrow 0 \\ (\\text{å½“}\\ |\\lambda_i| < 1)ï¼›\nä½é¢‘åˆ†é‡ä¿ç•™ï¼š\\lambda_i^K \\rightarrow 1 \\ (\\text{å½“}\\ \\lambda_i \\approx 1)ã€‚\n\nè¿‡åº¦å¹³æ»‘çš„æ•°å­¦æè¿°å½“ä¼ æ’­æ¬¡æ•°K \\rightarrow \\inftyæ—¶ï¼Œä¿¡å·æ”¶æ•›è‡³ï¼š  \n\\lim_{K \\to \\infty} P^K = \\frac{\\phi \\phi^\\top}{\\|\\phi\\|^2}å…¶ä¸­\\phiæ˜¯Pçš„ä¸»ç‰¹å¾å‘é‡ï¼Œå¯¼è‡´èŠ‚ç‚¹ç‰¹å¾è¶‹åŒï¼š  \nH^{(\\infty)} \\propto \\phi \\cdot \\text{const}æˆ–è€…è¿™æ ·è¡¨ç¤ºï¼š\n\nè®¾ h_i^{(k)} è¡¨ç¤ºèŠ‚ç‚¹ i åœ¨ç¬¬ k å±‚çš„ç‰¹å¾ï¼›\nå¦‚æœå¯¹äºä»»æ„ä¸¤ä¸ªèŠ‚ç‚¹ i å’Œ jï¼Œæœ‰ï¼š\\lim_{k \\to \\infty} \\|h_i^{(k)} - h_j^{(k)}\\| = 0æˆ–è€…é€šè¿‡æ–¹å·®æ¥åˆ»ç”»ï¼š \\text{Var}(H^{(k)}) \\to 0 \\quad \\text{å½“} \\quad k \\to \\infty\n\nV. å°ç»“Kipfçš„GCNå…¶å®ä¸æ˜¯GCNçš„æœ€åˆçš„é¢‘è°±åˆ†æçš„æµæ´¾çš„ç»§æ‰¿ï¼Œè€Œæ˜¯åšå‡ºäº†ç®€å•è€Œä¸”å¤§èƒ†çš„åˆ›æ–°ï¼Œè™½ç„¶ä¸€å¼€å§‹æ˜¯æ— å‘å›¾ï¼Œä½†æ˜¯å¯ä»¥æ¨å¹¿åˆ°æœ‰å‘å›¾ï¼›\nå…¶æ¬¡æ˜¯å®ƒçš„è®¡ç®—æœ¬è´¨ä¸Šæ˜¯å¯ä»¥å¾ˆå¿«çš„ï¼Œå› ä¸ºä¸€åˆ‡éƒ½å–å†³äºGPUä¸Šå¯¹äºçŸ©é˜µçš„ç‚¹ç§¯æ“ä½œçš„ä¼˜åŒ–ï¼Œä½†æ˜¯ï¼Œåœ¨å¤§è§„æ¨¡å›¾ä¸Šä»–çš„å†…å­˜å¤æ‚æ¶ˆè€—ä¼šåˆ° O(N^2) å› ä¸ºç›¸å½“äºç›´æ¥å­˜å…¥é‚»æ¥çŸ©é˜µï¼Œè€Œä¸”ç¨€ç–å›¾ä¸€èˆ¬éƒ½æ˜¯ç”¨é“¾è¡¨æˆ–è€…æ˜¯å­—å…¸ç»“æ„æ•°æ®æ¥å­˜å‚¨çš„ï¼Œå› æ­¤ä¸åŒå­˜å‚¨çš„è½¬åŒ–ä¹Ÿå­˜åœ¨åŠ é€Ÿçš„å¯èƒ½æ€§ï¼›\næ¨¡å‹ä¸å…·æœ‰éšæœºæ€§ï¼Œæ²¡æœ‰ç‹¬å±äºGraphçš„ç»“æ„çš„æ•°æ®å¢å¼ºå’Œé€‚åˆå›¾çš„éšæœºæ€§å¯¹äºæ–¹å·®çš„æ‰©å……ã€‚ä¹Ÿå°±æ˜¯ï¼Œæ¨¡å‹çš„æ³›åŒ–æ€§ä¸è¶³ â€”â€”â€”â€” åœ¨OODå’Œå­˜åœ¨åˆ†å¸ƒåç§»çš„æ•°æ®ä¸Šçš„æ³›åŒ–èƒ½åŠ›ä¸è¶³ã€å¯¹äºåŠ¨æ€å›¾çš„é€‚åº”èƒ½åŠ›è¾ƒå·®ã€‚å¯ä»¥è¯´è¿™æ˜¯ç”±äºä»–æ˜¯transductiveï¼ˆç›´æ¨ï¼‰çš„ï¼Œä½†æ˜¯æˆ‘ä¸å–œæ¬¢è¿™ç§è¯´è¾ï¼Œå› ä¸ºåç»­æ‰€è°“æå‡ºinductiveï¼ˆå½’çº³ï¼‰æ–¹å¼è§£å†³äº†è¿™ä¸ªé—®é¢˜çš„GraphSAGEï¼Œå®é™…ä¸Šåœ¨åŠ¨æ€å›¾æˆ–è€…æ˜¯åˆ†å¸ƒå·®å¼‚çš„æ•°æ®ä¸Šçš„è¡¨ç°ä¹Ÿä¸ä½³ã€‚\nè™½ç„¶è¿™ä¹Ÿæ˜¯å…¶ä»–æ‰€æœ‰çš„æƒ³è¦ä½œæ›´å¥½çš„representation learningçš„æ¨¡å‹çš„é€šç—…ï¼Œè¿™ä¹Ÿæœ‰å¾…åç»­çš„æ›´å¤šåšå®¢æ¥æ¢è®¨ã€‚åšå®¢æ–‡ç¬”è§ç–ï¼Œè¯¸å›è¯„è®ºå¤šåŠ æŒ‡æ­£ã€‚\n","tags":["Graph","GNN"]}]